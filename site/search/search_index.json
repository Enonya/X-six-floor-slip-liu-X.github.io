{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u4e3b\u9875","text":""},{"location":"#_1","title":"\u4e2a\u4eba\u4ecb\u7ecd","text":"<p>\u73b0\u5f79\u83dc\u9e21 OIer\uff0c\u559c\u6b22\u6253\u6e38\u620f\u3002</p> <ul> <li>\u660e\u65e5\u65b9\u821f \u516d\u697c\u6e9c\u5218#0816 \u9632\u6c89\u8ff7</li> <li>\u539f\u795e \u73b0\u5728\u4e0d\u73a9\u4e86</li> <li>\u72ec\u7acb\u6e38\u620f\u7231\u597d\u8005\uff0c\u73a9\u8fc7\u851a\u84dd\uff0c\u7a7a\u6d1e\u9a91\u58eb\uff0c\u836f\u5242\u5de5\u827a\uff0cbalabala...\uff0c\u4f46\u90fd\u73a9\u7684\u5f88\u83dc\u3002</li> <li>MHWI \u53cc\u5200\u5d3d\uff0c\u51c6\u5907\u5165\u5751\u866b\u68cd\uff0c\u592a\u5200\u662f\u4e0d\u53ef\u80fd\u592a\u5200\u7684\uff0c\u8fd9\u8f88\u5b50\u90fd\u4e0d\u53ef\u80fd\u592a\u5200\u7684\u3002</li> <li>\u7b97\u662f\u534a\u4e2a\u97f3\u6e38\u4eba\uff0c\u4ee5\u524d\u6253\u8fc7 Phi\u3001arc\u3001\u55b5\u65af\u3001cytus\uff0c\u4f46\u90fd\u4e0d\u662f\u5f88\u7cbe\u901a\u3002</li> </ul>"},{"location":"misc/new/","title":"\u65b0\u535a\u5ba2\u5efa\u7acb\u5566\uff01\uff01\uff01","text":"<p>\u5728\u4e0d\u505c\u7684\u8dc3\u8dc3\u6b32\u8bd5\u548c\u653e\u5f03\u7684\u5f73\u4e8d\u4e2d\uff0c\u524d\u524d\u540e\u540e\u82b1\u4e86\u4e09\u4e2a\u6708\uff0c\u6211\u7684\u535a\u5ba2\u7ec8\u4e8e\u5efa\u7acb\u5566\u3002</p> <p>\u611f\u8c22 @robinyqc\uff0c@FatOldEight \u548c @EarthMessenger \u7684\u5927\u529b\u5e2e\u52a9\uff01\uff01\uff01</p> <p>\u5982\u679c\u4f60\u60f3\u5efa\u7acb\u548c\u6211\u5dee\u4e0d\u591a\u7684\u535a\u5ba2\uff0c\u53ef\u4ee5\u53c2\u8003 robinyqc \u7684\u8fd9\u7bc7\u6587\u7ae0\u3002</p>"},{"location":"misc/try_md/","title":"\u5e38\u7528 MarkDown \u8bed\u6cd5","text":"<p>\u4f17\u6240\u5468\u77e5 MarkDown \u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684\u6807\u8bb0\u8bed\u8a00\uff0c\u8fd9\u91cc\u7b80\u5355\u5f52\u7eb3\u4e00\u4e0b\u5e38\u7528\u8bed\u6cd5\uff08\u5176\u5b9e\u662f\u60f3\u6d4b\u8bd5\u4e00\u4e0b\u8fd9\u4e2a\u535a\u5ba2\u7684\u6e32\u67d3\u529f\u80fd\u6709\u6ca1\u6709\u95ee\u9898\uff09\u3002</p>"},{"location":"misc/try_md/#_1","title":"\u4ee3\u7801\u5757","text":"<pre><code>#include&lt;iostream&gt;\nint main(){\nint a,b;cin&gt;&gt;a&gt;&gt;b;\ncout&lt;&lt;a+b;\nreturn 0;\n}\n</code></pre> <pre><code>```cpp\n#include&lt;iostream&gt;\nint main(){\n    int a,b;cin&gt;&gt;a&gt;&gt;b;\n    cout&lt;&lt;a+b;\n    return 0;\n}\n```\n</code></pre> <p>\u5982\u4f55\u5728\u4ee3\u7801\u5757\u5185\u5957\u4ee3\u7801\u5757\uff1a</p> <p><pre><code>````\n```cpp\n#include&lt;iostream&gt;\nint main(){\n    int a,b;cin&gt;&gt;a&gt;&gt;b;\n    cout&lt;&lt;a+b;\n    return 0;\n}\n```\n````\n</code></pre> \u518d\u5f80\u5916\u4e00\u5c42\u4e5f\u540c\u7406\u3002</p>"},{"location":"misc/try_md/#_2","title":"\u884c\u5185\u4ee3\u7801\u5757","text":"<p>\u8fd9\u9053\u9898\u9700\u8981\u5f00 <code>long long</code>\u3002</p> <pre><code>\u8fd9\u9053\u9898\u9700\u8981\u5f00 `long long`\u3002\n</code></pre>"},{"location":"misc/try_md/#_3","title":"\u6807\u9898","text":"<pre><code># \u4e00\u7ea7\u6807\u9898\n## \u4e8c\u7ea7\u6807\u9898\n### \u4e09\u7ea7\u6807\u9898\n#### \u56db\u7ea7\u6807\u9898\n##### \u4e94\u7ea7\u6807\u9898\n###### \u516d\u7ea7\u6807\u9898\n</code></pre>"},{"location":"misc/try_md/#_4","title":"\u5217\u8868","text":""},{"location":"misc/try_md/#_5","title":"\u6709\u5e8f\u5217\u8868","text":"<ol> <li>\u7b2c\u4e00\u4e2a\u95ee\u9898</li> <li>\u7b2c\u4e8c\u4e2a\u95ee\u9898</li> <li>\u7b2c\u4e09\u4e2a\u95ee\u9898</li> </ol> <pre><code>1. \u7b2c\u4e00\u4e2a\u95ee\u9898\n1. \u7b2c\u4e8c\u4e2a\u95ee\u9898\n1. \u7b2c\u4e09\u4e2a\u95ee\u9898\n</code></pre>"},{"location":"misc/try_md/#_6","title":"\u65e0\u5e8f\u5217\u8868","text":"<ul> <li>\u95ee\u9898 A</li> <li>\u95ee\u9898 B</li> <li>\u95ee\u9898 C</li> </ul> <pre><code>- \u95ee\u9898 A\n- \u95ee\u9898 B\n- \u95ee\u9898 C\n</code></pre>"},{"location":"misc/try_md/#_7","title":"\u7279\u6b8a\u5b57\u4f53","text":"<p>\u9ed1\u4f53 \u9ed1\u4f53</p> <p>\u5220\u9664\u7ebf</p> <p>\u659c\u4f53 \u659c\u4f53</p> <pre><code>**\u9ed1\u4f53** __\u9ed1\u4f53__\n\n~~\u5220\u9664\u7ebf~~\n\n*\u659c\u4f53* _\u659c\u4f53_\n</code></pre>"},{"location":"misc/try_md/#_8","title":"\u516c\u5f0f","text":"<p>$\\sum_{i=1}^{n}i=\\frac{n(n+1)}{2}$</p> <p><pre><code>$\\sum_{i=1}^{n}i=\\frac{n(n+1)}{2}$\n</code></pre> \u652f\u6301\u6362\u884c\uff0c\u4f46\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8981\u6253\u56db\u4e2a\u659c\u6760\u3002</p> <p>$$ \\begin{aligned}   &amp;ac+ad+bc+bd\\\\ = &amp;a(c+d)+b(c+d)\\\\ = &amp;(a+b)(c+d) \\end{aligned} $$</p> <pre><code>$$\n\\begin{aligned}\n  &amp;ac+ad+bc+bd\\\\\\\\\n= &amp;a(c+d)+b(c+d)\\\\\\\\\n= &amp;(a+b)(c+d)\n\\end{aligned}\n$$\n</code></pre>"},{"location":"misc/try_md/#mkdocs-markdown","title":"Mkdocs \u62d3\u5c55 MarkDown \u8bed\u6cd5","text":""},{"location":"misc/try_md/#_9","title":"\u63d0\u793a\u6846","text":"<p>\u8fd9\u662f note \u7c7b\u578b\u7684\u63d0\u793a\u6846</p> <p>\u63d0\u793a</p> \u8fd9\u662f note \u7c7b\u578b\u7684\u6298\u53e0\u7684\u63d0\u793a\u6846 <p>\u63d0\u793a</p> <p>\u8fd9\u662f success \u7c7b\u578b\u7684\u63d0\u793a\u6846</p> <p>\u6210\u529f\uff01</p> <p>\u8fd9\u662f failure \u7c7b\u578b\u7684\u63d0\u793a\u6846</p> <p>\u5931\u8d25\uff01</p> <p>\u8fd9\u662f bug \u7c7b\u578b\u7684\u63d0\u793a\u6846</p> <p>\u53d1\u73b0\u4e00\u4e2a bug\uff0c\u8bf7\u5c3d\u5feb\u4fee\u590d\uff01</p> <pre><code>!!! note \"\u8fd9\u662f note \u7c7b\u578b\u7684\u63d0\u793a\u6846\"\n    \u63d0\u793a\n\n??? note \"\u8fd9\u662f note \u7c7b\u578b\u7684\u6298\u53e0\u7684\u63d0\u793a\u6846\"\n    \u63d0\u793a\n\n!!! success \"\u8fd9\u662f success \u7c7b\u578b\u7684\u63d0\u793a\u6846\"\n    \u6210\u529f\uff01\n\n!!! failure \"\u8fd9\u662f failure \u7c7b\u578b\u7684\u63d0\u793a\u6846\"\n    \u5931\u8d25\uff01\n\n!!! bug \"\u8fd9\u662f bug \u7c7b\u578b\u7684\u63d0\u793a\u6846\"\n    \u53d1\u73b0\u4e00\u4e2a bug\uff0c\u8bf7\u5c3d\u5feb\u4fee\u590d\uff01\n</code></pre>"},{"location":"misc/try_md/#_10","title":"\u4ee3\u7801\u5757\u62d3\u5c55","text":"A+B<pre><code>#include&lt;iostream&gt;\nint main(){\nint a,b;cin&gt;&gt;a&gt;&gt;b;// (1)\ncout&lt;&lt;a+b;// (2)!\nreturn 0;\n}\n</code></pre> <ol> <li>\u7528 <code>cin</code> \u8bfb\u5165\u3002</li> <li>\u7528 <code>cout</code> \u8f93\u51fa\u3002</li> </ol> <pre><code>```cpp title='A+B' linenums=\"1\" hl_lines=\"3 4\"\n#include&lt;iostream&gt;\nint main(){\n    int a,b;cin&gt;&gt;a&gt;&gt;b;// (1)\n    cout&lt;&lt;a+b;// (2)!\n    return 0;\n}\n```\n\n1.  \u7528 `cin` \u8bfb\u5165\u3002\n2.  \u7528 `cout` \u8f93\u51fa\u3002\n</code></pre> <p>\u8fd9\u91cc\u6709\u4ee3\u7801\u5757\u6807\u9898\uff0c\u663e\u793a\u884c\u53f7\uff0c\u4ee3\u7801\u9ad8\u4eae\uff0c\u81ea\u5b9a\u4e49\u6ce8\u91ca\uff08\u6ce8\u610f\u81ea\u5b9a\u4e49\u6ce8\u91ca\u4e0e\u4ee3\u7801\u5757\u672c\u4f53\u4e4b\u95f4\u7a7a\u4e00\u884c\uff09\u3002\u5176\u4e2d\u81ea\u5b9a\u4e49\u6ce8\u91ca\u540e\u9762\u52a0\u4e2a <code>!</code> \u5c31\u53ef\u4ee5\u9690\u85cf\u539f\u672c\u7684\u659c\u7ebf\u4e86\u3002</p>"},{"location":"solution/20230113D_D/","title":"20230113D \u67d3\u8272","text":""},{"location":"solution/20230113D_D/#_1","title":"\u67d3\u8272 \u9898\u89e3","text":"<p>\u4f20\u9001\u95e8</p>"},{"location":"solution/20230113D_D/#_2","title":"\u9898\u89e3","text":""},{"location":"solution/20230113D_D/#hfy","title":"\u611f\u8c22hfy\u63d0\u4f9b\u7684\u5927\u4f53\u601d\u8def","text":"<p>\u89c2\u5bdf\u5230\u6570\u636e\u8303\u56f4\u662f $10^5$ ,\u4e5f\u5c31\u662f\u8bf4\u9700\u8981\u81f3\u591a $O(n \\log n+q \\log n)$ \u7684\u7b97\u6cd5\uff0c\u6211\u4eec\u8003\u8651\u4e8c\u5206\u3002</p> <p>\u9898\u76ee\u7ed9\u7684\u67d3\u8272\u6761\u4ef6\u6709\u70b9\u96be\u5224\u65ad\uff0c(\u4e3a\u65b9\u4fbf\u53d9\u8ff0,\u6211\u4eec\u5b9a\u4e49\u4e00\u6761\u8fb9\u6240\u5728\u76f4\u7ebf\u591a\u8fb9\u5f62\u4e00\u4fa7\u4e3a\u201c\u91cc\u201d\uff0c\u53e6\u4e00\u4fa7\u4e3a\u201c\u5916\u201d\uff09\uff0c\u5bb9\u6613\u53d1\u73b0\uff0c\u5f53\u4e14\u4ec5\u5f53\u4e00\u4e2a\u70b9\u5728\u81f3\u591a $\\dfrac{n}{2}-1$ \u6761\u8fb9\u5916\u65f6\uff0c\u6b64\u70b9\u88ab\u67d3\u8272\u3002</p> <p>\u5373\u82e5\u4e00\u4e2a\u70b9 $i$ \u5728 $k_i$ \u8fb9\u5916\uff0c $\\forall k_i \\le \\dfrac{n}{2}-1,i$\u88ab\u67d3\u8272</p> <p>\u5bb9\u6613\u53d1\u73b0\uff0c\u82e5\u5b9a\u4e49\u4efb\u610f\u4e00\u5bf9\u5bf9\u8fb9\u4e3a\u57fa\u51c6\u8fb9\uff0c\u5219\u5bf9\u4e8e\u70b9 $i$ \u540c\u65f6\u5728\u4e24\u8fb9\u5185\uff0c\u5fc5\u88ab\u67d3\u8272\uff1b\u540c\u65f6\u5728\u4e24\u8fb9\u5916\uff0c\u5fc5\u4e0d\u88ab\u67d3\u8272\uff1b\u82e5\u4f4d\u4e8e\u4e00\u8fb9\u4ee5\u5185\u53e6\u4e00\u8fb9\u4ee5\u5916\uff0c\u624d\u9700\u8981\u8fd0\u7528\u4ee5\u4e0a\u6027\u8d28\u3002</p> <p>\u7531\u4e8e\u6211\u4eec\u9700\u8981\u4e8c\u5206\uff08\u4f0f\u7b14\u56de\u6536\uff09\uff0c\u6211\u4eec\u8003\u8651\u5bfb\u627e\u5355\u8c03\u6027\u3002\u53d1\u73b0\u82e5\u5c06\u5e73\u9762\u6309\u57fa\u51c6\u8fb9\u7684\u4e2d\u7ebf\uff08\u5176\u5b9e\u4e0d\u5fc5\u8981\u662f\u4e2d\u7ebf\uff09\uff0c\u4e24\u4fa7\u7684 $k_{i_1}$ \u548c $k_{i_2}$ \u5206\u522b\u5173\u4e8e\u8fb9\u7684\u7f16\u53f7\u5355\u8c03\u3002\uff08\u6de6\u6211\u5728\u5199\u4ec0\u4e48\u4f46\u53cd\u6b63\u90fd\u662f\u6211\u81ea\u5df1\u770b\uff09\uff08\u4f46\u662f\u60f3\u60f3\u4e0d\u653e\u4e2a\u56fe\u89e3\u4f30\u8ba1\u660e\u5929\u5c31\u770b\u4e0d\u61c2\u4e86\uff0c\u800c\u4e14\u4e07\u4e00\u6709\u522b\u4eba\u8981\u770b\u5462\uff09</p> <p></p> <p>\uff08\u4ec5\u8003\u8651\u53f3\u534a\u90e8\u5206\uff09\u4e00\u4e2a\u70b9\u5728\u4e0a\u56fe\u4e2d\u68d5\u8272\u90e8\u5206\u65f6\uff0c\u5728\u4e14\u4ec5\u5728\u4e0a\u57fa\u51c6\u8fb9\u5185\u3002\u5728\u9ec4\u8272\u90e8\u5206\u4f1a\u591a\u4e00\u6761\u8fb9\uff0c\u7eff\u8272\u90e8\u5206\u4f1a\u518d\u591a\u4e00\u6761\u8fb9\uff0c\u7d2b\u8272\u90e8\u5206\uff08\u597d\u5c0f\uff09\u53c8\u4f1a\u591a\u4e00\u6761\u8fb9\u3002\u8fd9\u5c31\u5177\u6709\u4e86\u4e8c\u5206\u7684\u8d44\u672c\u3002</p> <p>\u7efc\u4e0a\uff0c\u6211\u4eec\u68b3\u7406\u4e0b\u505a\u6cd5\u3002</p> <ol> <li>\u8bfb\u5165\u65f6\u786e\u5b9a\u4e00\u7ec4\u57fa\u51c6\u8fb9\uff0c\u5e76\u5c06\u6bcf\u4e00\u6761\u8fb9\u7528\u4e00\u6b21\u51fd\u6570\u6309\u8fdc\u79bb\u5176\u4e2d\u4e00\u6761\u57fa\u51c6\u8fb9\u7684\u987a\u5e8f\u5b58\u5165\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u5148\u786e\u5b9a\u662f\u5426\u540c\u65f6\u5728\u4e24\u6761\u57fa\u51c6\u8fb9\u5185/\u5916\uff0c\u82e5\u662f\uff0c\u76f4\u63a5\u8f93\u51fa\u7b54\u6848\u3002</li> <li>\u82e5\u4e0d\u662f\uff0c\u5206\u522b\u5bf9\u4e24\u4fa7\u7684\u8fb9\u8fdb\u884c\u4e8c\u5206\uff0c\u7b97\u51fa $k_i$ ,\u5f97\u51fa\u7b54\u6848\u3002</li> </ol>"},{"location":"solution/20230113D_D/#code","title":"Code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define int long long\nusing namespace std;\nconst int N=1e5+5;\nint n,x[N],y[N];\nint q,a,b;\ndouble sx,sy;\nstruct Node{\nbool s,fl;//s true-&gt;\u7ad6\u5411\u8fb9; fl true-&gt;\u5de6\u4fa7/\u4e0b\u65b9\ndouble k,b;// s true-&gt;b\u4ee3\u8868\u6a2a\u5750\u6807\n};\nNode lt[N],rt[N],upl,dwl;\nint k1,k2=1;\nNode ist(int a1,int b1){\nNode l;\nif(x[a1]==x[b1]){\nl.s=true;\nl.b=y[a1];\nif(sx&lt;x[a1]){\nl.fl=true;\n}else{\nl.fl=false;\n}\n}else{\nl.s=false;\nl.k=double(y[b1]-y[a1])/(x[b1]-x[a1]);//\u4e00\u6b21\u51fd\u6570\nl.b=y[a1]-x[a1]*l.k;\nif(sy&lt;=sx*l.k+l.b){\nl.fl=true;\n}else{\nl.fl=false;\n}\n}\nreturn l;\n}\nbool pd(Node l,int a1,int b1){\nif(l.fl){\nif(l.s){\nreturn a1&lt;=l.b;\n}else{\nreturn b1&lt;=a1*l.k+l.b;\n}       }else{\nif(l.s){\nreturn a1&gt;=l.b;\n}else{\nreturn b1&gt;=a1*l.k+l.b;\n}       }\n}\nbool chk(int x1,int y1){\nif(pd(upl,x1,y1)&amp;&amp;pd(dwl,x1,y1)) return true;\nif(!pd(upl,x1,y1)&amp;&amp;!pd(dwl,x1,y1)) return false;\nint ll=1,rr=(n&gt;&gt;1)-1,mm,res=1;\nif(pd(upl,x1,y1)){ //\u4e8c\u5206\nwhile(ll&lt;=rr){\nmm=(ll+rr)&gt;&gt;1;\nif(pd(lt[mm],x1,y1)) ll=mm+1;\nelse rr=mm-1;\n}\nres+=rr;\nll=1;rr=(n&gt;&gt;1)-1;\nwhile(ll&lt;=rr){\nmm=(ll+rr)&gt;&gt;1;\nif(pd(rt[mm],x1,y1)) ll=mm+1;\nelse rr=mm-1;\n}\nres+=rr;\nif(res&gt;(n&gt;&gt;1)) return true;\nreturn false;       }else{\nwhile(ll&lt;=rr){\nmm=(ll+rr)&gt;&gt;1;\nif(!pd(lt[mm],x1,y1)) ll=mm+1;\nelse rr=mm-1;\n}\nres+=(n&gt;&gt;1)-ll;\nll=1;rr=(n&gt;&gt;1)-1;\nwhile(ll&lt;=rr){\nmm=(ll+rr)&gt;&gt;1;\nif(!pd(rt[mm],x1,y1)) ll=mm+1;\nelse rr=mm-1;\n}\nres+=(n&gt;&gt;1)-ll;\nif(res&gt;(n&gt;&gt;1)) return true;\nreturn false;   }\n}\nsigned main(){\nscanf(\"%lld\",&amp;n);\nfor(int i=1;i&lt;=n;i++){\nscanf(\"%lld%lld\",&amp;x[i],&amp;y[i]);\n}\nsx=(x[1]+x[(n&gt;&gt;1)+1])/2.0;sy=(y[1]+y[(n&gt;&gt;1)+1])/2.0;\nupl=ist(1,2);dwl=ist((n&gt;&gt;1)+1,(n&gt;&gt;1)+2);\nfor(int i=2;i&lt;=(n&gt;&gt;1);i++){\nlt[++k1]=ist(i,i+1);\n}\nrt[1]=ist(n,1);\nfor(int i=n-1;i&gt;=(n&gt;&gt;1)+2;i--){\nrt[++k2]=ist(i,i+1);\n}\nscanf(\"%lld\",&amp;q);\nint cnt=0;\nwhile(q--){\nscanf(\"%lld%lld\",&amp;a,&amp;b);\na^=(cnt*cnt*cnt);b^=(cnt*cnt*cnt);\nif(chk(a,b)){\nputs(\"Yes\");\ncnt++;\n}else{\nputs(\"No\");\n}\n}\n}\n</code></pre>"},{"location":"solution/20230407C_C/","title":"\u8fdb\u5316\uff08D.cpp 1S 512M\uff09","text":"<p>\u4f20\u9001\u95e8</p>"},{"location":"solution/20230407C_C/#_1","title":"\u9898\u89e3","text":"<p>\u9996\u5148\uff0c$b[i]=(a[i+1]+a[i-1])\\bmod 2$ \u7b49\u4ef7\u4e8e $b[i]=a[i+1] \\oplus a[i-1]$\u3002</p> <p>\u6211\u4eec\u8003\u8651\u4e00\u79cd\u66b4\u529b\u505a\u6cd5\u3002</p> <p>\u5047\u8bbe\u8fdb\u5316 $m$ \u6b21\u540e\u7684\u6570\u7ec4\u4e3a $a_m$\uff0c\u90a3\u4e48\u6ce8\u610f\u5230 $a_m[i]$ \u53ef\u4ee5\u8f6c\u79fb\u5230 $a_{m+1}[i+1]$ \u548c $a_{m+1}[i-1]$\u3002</p> <p>\u62bd\u8c61\u4e00\u4e0b\uff0c\u4f1a\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e2a $i$\uff0c$a_1[i]$ \u6709 $2^T$ \u79cd\u8def\u5f84\u8f6c\u79fb\u5230 $a_T$\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e00\u6761\u8def\u5f84\u7528\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570\uff08<code>bitset</code>\uff1f\uff09\u6982\u62ec\u4e00\u4e0b\uff08$0$ \u8868\u793a\u5411\u5de6\uff0c$1$ \u8868\u793a\u5411\u53f3\uff09\uff0c\u679a\u4e3e\u8def\u5f84\u5224\u65ad\u6bcf\u4e2a $a_1[i]$ \u5bf9 $a_T$ \u7684\u5f71\u54cd\u3002</p> <p>\u590d\u6742\u5ea6 $O(n 2^T)$\uff0c\u8fde\u6700\u5c0f\u7684\u90e8\u5206\u5206\u90fd\u8fc7\u4e0d\u4e86\u3002</p> <p>\u4f46\u662f\u8fd9\u4e2a\u505a\u6cd5\u6709\u5de8\u5927\u7684\u4f18\u5316\u7a7a\u95f4\uff0c\u9996\u5148\u5bb9\u6613\u53d1\u73b0\uff0c\u5e76\u4e0d\u9700\u8981\u679a\u4e3e\u6bcf\u6761\u8def\u5f84\uff0c\u56e0\u4e3a\u6bcf\u6761\u8def\u5f84\u7684\u7ec8\u70b9\u4e0e\u4e14\u4ec5\u4e0e\u8def\u5f84\u4e2d $0$/$1$ \u7684\u4e2a\u6570\u6709\u5173\uff0c\u6211\u4eec\u5229\u7528\u7ec4\u5408\u6570\u53ef\u4ee5\u628a\u590d\u6742\u5ea6\u538b\u81f3 $O(n^2)$\uff08\u5047\u5982\u6709\u67d0\u79cd\u65b9\u6cd5\u53ef\u4ee5\u9884\u5904\u7406\u6781\u5176\u5de8\u5927\u7684\u7ec4\u5408\u6570\uff09\u3002</p> <p>\u4f46\u8fd9\u8fd8\u8fdc\u4e0d\u662f\u8fd9\u6761\u601d\u8def\u7684\u6781\u9650\uff0c\u5047\u8bbe\u6bcf\u4e2a $i$ \u5230 $j$ \u7684\u8def\u5f84\u4e2d\u6709 $r$ \u4e2a $1$\uff0c\u663e\u7136\u6709 $T-r$ \u4e2a $0$\u3002</p> <p>\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230 $j-i=r-(T-r)=2r-T$\u3002</p> <p>\u6ce8\u610f\u5230\uff0c$i$ \u5bf9 $j$ \u7684\u5f71\u54cd\u53ea\u4e0e $a_1[i]$ \u548c $\\dbinom{T}{r}$ \u7684\u5947\u5076\u6027\u6709\u5173\uff0c\u6982\u62ec\u6210\u6570\u5b66\u8bed\u8a00 $i$ \u5bf9 $j$ \u7684\u5f71\u54cd\u5c31\u662f $\\dbinom{T}{r}\\bmod 2 \\cdot a_1[i]$\uff08\u8fd9\u4e2a $r$ \u662f\u53ef\u4ee5\u6c42\u51fa\u6765\u7684\u4f46\u6211\u4eec\u6682\u4e14\u653e\u4e00\u653e\uff09\u3002</p> <p>\u770b\u5230\u7ec4\u5408\u6570\u6a21\u4e00\u4e2a\u5c0f\u8d28\u6570\u7684\u5f62\u5f0f\u60f3\u5230 lucas \u5b9a\u7406\uff0c\u5373\uff1a</p> <p>$$\\dbinom{T}{r}\\bmod 2=\\dbinom{\\left\\lfloor T/2 \\right\\rfloor}{\\left\\lfloor r/2 \\right\\rfloor}\\cdot \\dbinom{T \\bmod 2}{r\\bmod 2}\\bmod 2$$</p> <p>\u5de6\u8fb9\u8fd8\u53ef\u4ee5\u518d\u62c6\u4f46\u662f\u6211\u4e0d\u60f3\u5199\u4e86\uff0c\u6211\u4eec\u6362\u4e00\u79cd\u5199\u6cd5\uff0c\u5c06 $T$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u7684\u7b2c $c$ \u4f4d\u8bb0\u4f5c $(T)_{c}$\uff08\u5176\u5b9e\u5e76\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u8bb0\u6cd5\u53ea\u662f\u6211\u4e3a\u4e86\u65b9\u4fbf\u53d9\u8ff0\u4e71\u641e\u7684\uff09\uff0c$r$ \u540c\u7406\u3002</p> <p>$$\\dbinom{T}{r}\\bmod 2 = \\dbinom{(T){1}}{(r){1}}\\cdot\\dbinom{(T){2}}{(r){2}}\\cdots \\dbinom{(T){\\log_T}}{(r){\\log T}}$$</p> <p>\u6ce8\u610f\u5230 $\\dbinom{(T){c}}{(r){c}}$ \u5176\u5b9e\u53ea\u6709 $\\dbinom{0}{0}=1,\\dbinom{1}{1}=1,\\dbinom{0}{1}=0,\\dbinom{1}{0}=1$ \u56db\u79cd\u53ef\u80fd\u3002\u53d1\u73b0\u5f53 $(T)_c=0$ \u65f6\u7ed3\u679c\u4e0e\u4e14\u4ec5\u4e0e $(r)_c$ \u6709\u5173\uff0c\u60f3\u5230\u5c06\u539f\u5148 $T$ \u7684\u6bcf\u4e00\u4f4d\u62c6\u51fa\u6765\u5206\u522b\u8ba1\u7b97\uff0c\u4e0b\u6b21\u8ba1\u7b97\u65f6\u5c31\u7531\u8fd9\u6b21\u7684\u7ed3\u679c\u4e3a\u57fa\u7840\uff0c\u4ee5\u6784\u9020\u6210 $10\\dots00$ \u7684\u5f62\u5f0f\uff08\u901a\u8fc7\u90e8\u5206\u5206\u4e5f\u53ef\u4ee5\u60f3\u5230\u8fd9\u4e00\u70b9\uff09\uff0c\u8bbe\u6bcf\u6b21\u62c6\u51fa\u6765\u7684\u6570\u4e3a $t$\u3002</p> <p>\u6240\u4ee5 $\\dbinom{t}{r}\\bmod 2 = 1$ \u5f53\u4e14\u4ec5\u5f53 $\\forall (t)_c=0,(r)_c=0$\u3002</p> <p>\u6362\u53e5\u8bdd\u8bf4\uff0c\u53ea\u6709\u5f53 $r$ \u7684\u4e8c\u8fdb\u5236\u4e3a $10\\dots00$ \u6216\u8005 $00\\dots00$ \u65f6\uff0c$\\dbinom{t}{r}\\bmod 2=1$\u3002</p> <p>\u8fdb\u4e00\u6b65\uff0c$\\dbinom{t}{r}\\bmod 2=1$ \u5f53\u4e14\u4ec5\u5f53 $r=0$ \u6216 $r=t$\u3002</p> <p>\u7531\u4e8e $j-i=2r-t$\uff0c\u6545 $a_t[j]$ \u53ea\u4f1a\u88ab $a_1[j-t]$ \u548c $a_1[j+t]$ \u5f71\u54cd\u3002\u6982\u62ec\u6210\u6570\u5b66\u8bed\u8a00\u5c31\u662f $a_t[j]=a_1[j-t]\\oplus a_1[j+t]$\u3002</p> <p>\u4f46\u662f\u8fd9\u91cc\u6709\u4e2a\u95ee\u9898\uff0c\u6570\u7ec4\u4f1a\u8d8a\u754c\u3002</p> <p>\u5bb9\u6613\u60f3\u5230\u628a\u5b83\u8f6c\u5316\u6210\u4e00\u4e2a\u7b49\u4ef7\u7684\u73af\u5f62\u95ee\u9898\uff08\u5176\u5b9e\u5e76\u4e0d\u5bb9\u6613\uff09\u3002</p> <p>\u8003\u8651\u6784\u9020\u4e00\u4e2a\u73af $c$\uff0c\u5b83\u957f\u8fd9\u6837\uff1a</p> <p></p> <p>\u5728\u73af $c$ \u4e2d\u8fdb\u884c\u9898\u76ee\u63cf\u8ff0\u4e2d\u7684\u201c\u8fdb\u5316\u201d\u64cd\u4f5c\u548c $a$ \u662f\u7b49\u4ef7\u7684\u3002</p> <p>\u9996\u5148\uff0c\u6bcf\u4e2a $a[2]$ \u5230 $a[n-1]$ \u4e2d\u663e\u7136\u662f\u7b49\u4ef7\u7684\u3002</p> <p>$a[1]$ \u548c $a[n]$ \u7684\u53e6\u4e00\u8fb9\u4e3a $0$ \u663e\u7136\u4e5f\u662f\u7b49\u4ef7\u7684\u3002</p> <p>\u5bf9\u4e8e\u4e24\u7aef\u7684 $0$\uff0c\u5b83\u7684\u4e24\u4fa7\u6c38\u8fdc\u90fd\u662f\u76f8\u7b49\u7684\uff0c\u65e0\u8bba\u4f55\u65f6\u90fd\u662f $0$\u3002</p> <p>\uff08\u6211\u4e5f\u4e0d\u77e5\u9053\u662f\u600e\u4e48\u60f3\u51fa\u6765\u7684\uff0c\u53cd\u6b63\u4e5f\u4e0d\u662f\u6211\u60f3\u51fa\u6765\u7684\u3002\uff09</p> <p>\u7528\u6570\u7ec4\u5b58\u7684\u65f6\u5019\u5de6\u8fb9\u90a3\u4e2a $0$ \u4e0b\u6807\u8bbe\u4e3a $0$ \u7136\u540e\u987a\u65f6\u9488\u8f6c\u5c31\u884c\u4e86\u3002</p> <p>\u7efc\u4e0a\uff0c\u6700\u7ec8\u505a\u6cd5\u5982\u4e0b\uff1a</p> <ol> <li>\u53d6\u51fa $T$ \u4e8c\u8fdb\u5236\u6700\u4f4e\u4f4d\uff08\u8bb0\u4e3a $t$\uff09\uff0c\u5c06 $T$ \u51cf\u53bb $t$\u3002</li> <li>\u901a\u8fc7\u73b0\u6709\u6570\u7ec4 $a$ \u6784\u9020\u51fa\u73af $c$\u3002</li> <li>\u5bf9\u4e8e\u6240\u6709 $1\\le i \\le n$\uff0c\u8ba1\u7b97\u51fa $b[i]=c[(i+t)\\bmod (n\\times 2+2) ] \\oplus c[(i-t)\\bmod (n\\times 2+2) ] $\uff08\u6ce8\u610f\u53d6\u6a21\u8003\u8651\u8d1f\u6570\uff09\u3002</li> <li>\u5c06\u6574\u4e2a $b$ \u8d4b\u7ed9 $a$\u3002</li> <li>\u91cd\u590d\u4ee5\u4e0a\u64cd\u4f5c\u76f4\u81f3 $T$ \u5f52\u96f6\u3002</li> </ol> <p>\u6700\u7ec8\u7684\u6570\u7ec4 $a$ \u5373\u4e3a\u7b54\u6848\u3002</p> <p>\u6bcf\u4e00\u5c42\u590d\u6742\u5ea6 $O(n)$\uff0c\u6700\u591a\u6709 $\\log T$ \u5c42\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log T)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002</p>"},{"location":"solution/20230407C_C/#code","title":"code","text":"<pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;string.h&gt;\n#define ll long long\n#define mem(a,b) memset(a,b,sizeof(a))\n#include&lt;vector&gt;\n#define pbk(a) emplace_back(a)\n#define forup(i,s,e) for(register ll i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register ll i=(s);i&gt;=(e);i--)\n#define abs(x) (((x)^((x)&gt;&gt;63))-((x)&gt;&gt;63))\nusing namespace std;\n#define gc getchar()\ninline ll read(){\nll x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst ll N=2e5+5,inf=0x3f3f3f3f;\nll t,n;\nchar b[N];\nbool a[N],c[N*2];\nll mymod(ll a,ll b){\nif(a&lt;0) a+=((-a+b-1)/b)*b;\nreturn a%b;\n}\nsigned main(){\nt=read();n=read();\nscanf(\" %s\",b+1);\nforup(i,1,n){\na[i]=b[i]-'0';\n}\nwhile(t){\nll kk=t&amp;-t;\nt-=kk;\nforup(i,1,n){\nc[i]=c[n*2+2-i]=a[i];\n}\nforup(i,1,n){\na[i]=c[mymod(i+kk,n*2+2)]^c[mymod(i-kk,n*2+2)];\n}\n}\nforup(i,1,n){\nprintf(\"%d\",a[i]);\n}\n} </code></pre>"},{"location":"solution/20230411C_C/","title":"T3","text":"<p>\u4f20\u9001\u95e8</p>"},{"location":"solution/20230411C_C/#_1","title":"\u9898\u89e3","text":""},{"location":"solution/20230411C_C/#10pts","title":"10pts","text":"<p>\u66b4\u529b dfs\u3002</p>"},{"location":"solution/20230411C_C/#20pts","title":"20pts","text":"<p>\u72b6\u538b dp\u3002\u72b6\u6001\u4e3a\u5f53\u524d\u9009\u4e86\u7684\u6570\uff0c\u4fdd\u5b58\u8fd9\u6837\u7684\u65b9\u6848\u6570\u548c\u9006\u5e8f\u5bf9\u603b\u6570\u679a\u4e3e\u4e0b\u4e00\u4e2a\u6570\u63a8\u5230\u4e0b\u4e00\u4e2a\u72b6\u6001\uff0c\u8f6c\u79fb\u65b9\u7a0b\u4e0d\u96be\u63a8\uff0c\u53cd\u6b63\u662f\u90e8\u5206\u5206\u4e0d\u5c55\u5f00\u8bb2\uff0c\u53ef\u80fd\u9700\u8981\u6253\u8868\u9632\u6b62 $T$ \u8fc7\u5927\u3002</p>"},{"location":"solution/20230411C_C/#4080pts","title":"40~80pts","text":"<p>~\u8fd9\u51e0\u4e2a\u70b9\u610f\u4e49\u4e0d\u660e~\u6211\u4e0d\u77e5\u9053\u6709\u4ec0\u4e48\u65b9\u6cd5\u5361\u8fc7\u8fd9\u51e0\u4e2a\u70b9\u3002</p>"},{"location":"solution/20230411C_C/#100pts","title":"100pts","text":"<p>\u9996\u5148\u6211\u4eec\u9700\u8981\u5b66\u4f1a\u6c42\u957f\u5ea6\u4e3a $n$ \u7684\u9519\u6392\u7684\u4e2a\u6570\u3002</p> <p>\u8bbe $f_i$ \u8868\u793a\u957f\u5ea6\u4e3a $i$ \u7684\u9519\u6392\u4e2a\u6570\u3002</p> <p>\u9996\u5148\uff0c\u5f88\u663e\u7136 $f_1=0,f_2=1$\u3002</p> <p>\u53e6\u5916\u7279\u522b\u6ce8\u610f\u4e00\u4e0b $f_0=1$\u3002</p> <p>\u5bf9\u4e8e $f_n$\uff0c\u6211\u4eec\u8003\u8651\u5c06 $n$ \u653e\u5728\u4f4d\u7f6e $p_x$ \u4e0a\u3002</p> <p>\u5047\u5982\u5c06 $x$ \u653e\u5728 $p_n$ \u4e0a\uff0c\u5bb9\u6613\u53d1\u73b0\u8fd9\u6837\u7684\u65b9\u6848\u6709 $f_{n-2}$ \u79cd\uff0c\u56e0\u4e3a\u6211\u4eec\u5e76\u4e0d\u5173\u5fc3\u6bcf\u4e2a\u6570\u7684\u5177\u4f53\u5927\u5c0f\uff0c\u53ea\u5173\u5fc3\u5b83\u5728\u4e0d\u5728\u81ea\u5df1\u7684\u4f4d\u7f6e\u4e0a\uff0c\u65e2\u7136\u5df2\u7ecf\u786e\u5b9a\u4e86\u4e24\u4e2a\u6570\u4e0d\u52a8\uff0c\u90a3\u5176\u4ed6\u6570\u4fbf\u6709 $f_{n-2}$ \u79cd\u653e\u6cd5\u3002</p> <p>\u5047\u5982 $x$ \u4e0d\u5728 $p_n$ \u4e0a\uff0c\u6cbf\u7528\u521a\u624d\u7684\u601d\u8def\uff0c\u6211\u4eec\u53ea\u5173\u5fc3\u6bcf\u4e2a\u6570\u5728\u4e0d\u5728\u81ea\u5df1\u7684\u4f4d\u7f6e\u4e0a\uff0c\u7531\u4e8e\u6211\u4eec\u89c4\u5b9a $x$ \u4e0d\u5728 $p_n$ \u4e0a\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u628a $x$ \u89c6\u4f5c $n$\uff0c\u6545\u6b64\u65f6 $f_n=f_{n-1}$\u3002</p> <p>\u7531\u4e8e\u9664\u4e86\u5f53\u524d\u6570\u5916\u6bcf\u4e2a\u6570\u90fd\u53ef\u80fd\u6210\u4e3a $x$\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a $f_i=f_{i-1}\\cdot(i-1)+f_{i-2}\\cdot(i-1)$\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u8fdb\u884c\u9006\u5e8f\u5bf9\u7684\u8ba1\u7b97\u3002</p> <p>\u8003\u8651\u5728\u957f\u5ea6\u4e3a $n$ \u7684\u9519\u6392\u4e2d\u6bcf\u4e00\u4e2a\u6570\u5bf9 $(i,j)(i&lt;j,1 \\le i,j \\le n)$ \u603b\u5171\u4f1a\u9020\u6210\u7684\u8d21\u732e\u4e3a\u591a\u5c11\uff0c\u7531\u4e8e\u6240\u6709\u6570\u5bf9\u662f\u7b49\u4ef7\u7684\uff08\u8fd8\u662f\u6cbf\u7528\u90a3\u53e5\u8bdd\uff0c\u6211\u4eec\u5e76\u4e0d\u5173\u5fc3\u54ea\u4e2a\u6570\u5927\u54ea\u4e2a\u6570\u5c0f\uff0c\u53ea\u5173\u5fc3\u5b83\u4eec\u5728\u4e0d\u5728\u81ea\u5df1\u7684\u4f4d\u7f6e\u4e0a\uff09\u3002</p> <p>\u6211\u4eec\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\uff1a 1. $p_j\\ne i,p_i \\ne j$ \u7684\u60c5\u51b5\u3002\u5bb9\u6613\u53d1\u73b0\u8fd9\u79cd\u60c5\u51b5\u53ef\u4ee5\u4e24\u4e24\u914d\u5bf9\u5f62\u6210\u53cc\u5c04\uff08\u53ea\u8981\u4ea4\u6362 $i,j$ \u5c31\u53ef\u4ee5\u4e86\uff09\uff0c\u5e76\u4e14\u914d\u5bf9\u7684\u5176\u4e2d\u4e00\u4e2a\u5fc5\u5b9a\u9020\u6210\u4e00\u70b9\u8d21\u732e\uff0c\u53e6\u4e00\u4e2a\u5fc5\u5b9a\u4e0d\u4f1a\uff08\u663e\u7136 $j$ \u5728 $i$ \u5de6\u8fb9\u4f1a\u9020\u6210\u8d21\u732e\uff0c\u53cd\u8fc7\u6765\u5c31\u4e0d\u4f1a\uff09\u3002\u53e6\u5916\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u6b64\u65f6\u6211\u4eec\u7edf\u8ba1\u7684\u662f $i,j$ \u4e24\u4e2a\u503c\u4ea7\u751f\u7684\u8d21\u732e\uff0c\u56e0\u4e3a $p_i,p_j$ \u4e24\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u8d21\u732e\u4f1a\u5728\u8ba1\u7b97\u5176\u4ed6\u6570\u5bf9\u7684\u65f6\u5019\u88ab\u7edf\u8ba1\u3002\u4e3a\u65b9\u4fbf\u53d9\u8ff0\uff0c\u6211\u4eec\u79f0\u6ee1\u8db3\u8fd9\u79cd\u60c5\u51b5\u7684\u9519\u6392\u6784\u6210\u7684\u96c6\u5408\u4e3a $A$\u3002</p> <ol> <li>$p_j \\ne i,p_i = j$ \u6216 $p_i \\ne j,p_j = i$ \u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u6211\u4eec\u4ee4\u4e0d\u7b49\u7684\u90a3\u4e2a\u4e3a1 $k$\uff0c\u6b64\u65f6\u7edf\u8ba1\u7684\u662f $p_i,p_j$ \u4e24\u4e2a\u4f4d\u7f6e\u4e0a\u4ea7\u751f\u7684\u8d21\u732e\u3002<ul> <li>\u82e5 $kj$\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7c7b\u4f3c\u5730\u6784\u6210\u53cc\u5c04\uff0c$p_i=k,p_j=i$ \u548c $p_i=j,p_j=k$ \u5176\u4e2d\u4e00\u79cd\u60c5\u51b5\u4f1a\u8d21\u732e\uff0c\u53e6\u4e00\u4e2a\u5219\u4e0d\u4f1a\uff08\u53e6\u5916\u6211\u4eec\u5e76\u4e0d\u5728\u610f\u53e6\u4e00\u4e2a\u6570\u7684\u5177\u4f53\u4f4d\u7f6e\uff0c\u5b83\u4f1a\u5728 $i'=k,j'=i$\uff08\u6216\u8005\u5176\u4ed6\u7c7b\u4f3c\u7684\uff0c\u8fd9\u91cc\u6211\u8bf4\u7684\u6bd4\u8f83\u4e0d\u4e25\u8c28\uff0c\u4f46\u662f\u4f60\u80fd\u61c2\u8fd9\u4e2a\u610f\u601d\uff09\u65f6\u88ab\u7edf\u8ba1\u5230\uff09\uff0c\u4e3a\u65b9\u4fbf\u53d9\u8ff0\uff0c\u6211\u4eec\u79f0\u6ee1\u8db3\u8fd9\u79cd\u60c5\u51b5\u7684\u9519\u6392\u6784\u6210\u7684\u96c6\u5408\u4e3a $B$\u3002 <li>\u82e5 $i &lt; k &lt; j$\uff0c\u6211\u4eec\u4ecd\u53ef\u4ee5\u50cf\u4e0a\u9762\u4e00\u6837\u6784\u6210\u53cc\u5c04\uff0c\u4f46\u9700\u8981\u6ce8\u610f\uff0c\u6b64\u65f6\u4e24\u8fb9\u90fd\u4f1a\u6709\u8d21\u732e\uff0c\u8fd9\u4e2a\u6211\u4eec\u540e\u9762\u518d\u8bb2\uff0c\u6211\u4eec\u79f0\u8fd9\u79cd\u60c5\u51b5\u7684\u96c6\u5408\u4e3a $B'$\u3002</li> <li>$p_i=j,p_j=i$ \u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u60c5\u51b5\u5e76\u4e0d\u80fd\u6784\u6210\u53cc\u5c04\uff0c\u4f46\u662f\u8fd9\u6837\u663e\u7136\u4f1a\u6784\u6210\u9006\u5e8f\u5bf9\uff0c\u5e76\u4e14\u5b83\u5341\u5206\u597d\u7edf\u8ba1\uff0c\u6211\u4eec\u53c2\u8003\u4e4b\u524d\u7b97\u9519\u6392\u4e2a\u6570\u7684\u601d\u60f3\uff0c\u5bb9\u6613\u63a8\u51fa\u8fd9\u79cd\u60c5\u51b5\u7684\u4e2a\u6570\u4e3a $f_{n-2}$\uff0c\u6211\u4eec\u79f0\u8fd9\u79cd\u60c5\u51b5\u7684\u6784\u6210\u7684\u96c6\u5408\u4e3a $C$\u3002</li> <p>\u5bb9\u6613\u53d1\u73b0\uff0c$A \\cup B \\cup B' \\cup C$ \u6070\u597d\u5c31\u7b49\u4e8e\u6240\u6709\u9519\u6392\u6784\u6210\u7684\u96c6\u5408\uff0c\u6211\u4eec\u53ef\u4ee5~\u5f88\u5feb\u5730~ $O(1)$ \u5730\u7b97\u51fa $\\frac{\\left| A \\right|+\\left| B \\right|+\\left| B' \\right|+2\\left| C \\right|}{2}=\\frac{f_n+f_{n-2}}{2}$\u3002\u5bf9\u4e8e\u6240\u6709\u6570\u5bf9\uff0c\u6211\u4eec\u518d\u4e58\u4ee5 $\\frac{n\\cdot(n-1)}{2}$ \u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u3002</p> <p>\u4f46\u662f\u8fd9\u5e76\u4e0d\u6b63\u786e\uff0c\u6211\u4eec\u4e4b\u524d\u63d0\u5230\u4e86 $B'$ \u4e2d\u6240\u6709\u5143\u7d20\u90fd\u4f1a\u4ea7\u751f\u8d21\u732e\uff0c\u800c\u6211\u4eec\u53ea\u8ba1\u7b97\u4e86 $\\frac{\\left| B' \\right|}{2}$ \u4e2a\u60c5\u51b5\uff0c\u672c\u7740\u591a\u9000\u5c11\u8865\u7684\u539f\u5219\uff0c\u6211\u4eec\u9700\u8981\u52a0\u4e0a\u8fd9\u4e00\u90e8\u5206\u3002</p> <p>\u8003\u8651\u6709\u591a\u5c11\u79cd\u6570\u5bf9\u4f1a\u7ec4\u6210 $B'$\uff0c\u5bb9\u6613\u60f3\u5230\uff0c\u6bcf\u4e00\u4e2a\u4e09\u5143\u7ec4 $(i,j,k)(i &lt; k &lt; j ,1 \\le i,j,k \\le n)$ \u90fd\u4f1a\u6784\u6210\u4e00\u7ec4 $B'$\uff08\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff0c$B'$ \u9700\u8981\u5de6\u53f3\u5939\u7740\u4e2d\u95f4\u4e00\u4e2a\uff09\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651 $\\left| B' \\right|$ \u7684\u5927\u5c0f\uff0c\u7531\u4e8e\u6240\u6709\u6570\u662f\u7b49\u4ef7\u7684\u6240\u4ee5\u5bf9\u4e8e\u56fa\u5b9a\u7684 $n$\uff0c\u6240\u6709\u7684 $\\left| B' \\right|$ \u5e94\u8be5\u4e5f\u662f\u76f8\u7b49\u7684\u3002</p> <p>\u5148\u8003\u8651 $p_i=j,p_j=k$ \u7684\u60c5\u51b5\uff0c\u53e6\u4e00\u79cd\u76f4\u63a5\u4e58\u4ee5\u4e8c\u5373\u53ef\uff0c\u7c7b\u4f3c\u4e8e\u7b97\u9519\u6392\u4e2a\u6570\u7684\u601d\u8def\uff0c\u6211\u4eec\u5206 $p_k=i$ \u548c $p_k \\ne i$ \u7684\u60c5\u51b5\u8ba8\u8bba\uff0c\u8fd9\u91cc\u8bf7\u8bfb\u8005\u81ea\u884c\u601d\u8003\u4e0d\u5c55\u5f00\u8bb2\uff0c\u5f97\u5230\u7684\u5f0f\u5b50\u5c31\u662f $\\left| B' \\right| = 2 \\cdot(f_{n-2}+f_{n-3})$\u3002</p> <p>\u7efc\u4e0a\u6240\u8ff0\uff0c\u9884\u5904\u7406 $f$ \u540e\uff0c\u957f\u5ea6\u4e3a $n$ \u7684\u9519\u6392\u4e2d\u9006\u5e8f\u5bf9\u6570\u4e3a $\\frac{f_{n}+f_{n-2}}{2}\\times\\frac{n\\cdot(n-1)}{2}+\\frac{2\\cdot(f_{n-2}+f_{n-3})}{2}\\times\\frac{n\\cdot(n-1)\\cdot(n-2)}{6}$\uff08$\\frac{n\\cdot(n-1)\\cdot(n-2)}{6}$ \u4e3a\u4e09\u5143\u7ec4\u7684\u4e2a\u6570\uff09\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u5316\u7b80\uff0c\u5bb9\u6613\u53d1\u73b0 $f_{n-2}+f_{n-3}=\\frac{f_{n-1}}{n-2}$\uff0c\u6545\u6700\u7ec8\u5f0f\u5b50\u4e3a\uff1a</p> <p>$$\\frac{f_{n}+f_{n-2}}{2}\\times\\frac{n\\cdot(n-1)}{2}+\\frac{f_{n-1}\\cdot n\\cdot(n-1)}{6}$$</p>"},{"location":"solution/20230411C_C/#code","title":"code","text":"<pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;string.h&gt;\n#define ll long long\n#define mem(a,b) memset(a,b,sizeof(a))\n#include&lt;vector&gt;\n#define pbk(a) emplace_back(a)\n#define forup(i,s,e) for(register ll i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register ll i=(s);i&gt;=(e);i--)\n#define abs(x) (((x)^((x)&gt;&gt;63))-((x)&gt;&gt;63))\nusing namespace std;\n#define gc getchar()\ninline ll read(){\nll x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst ll N=1e7+5,inf=0x3f3f3f3f,mod=998244353;\nll t,n;\nll f[N];\nll inv2,inv6;\nll ksm(ll a,ll b){\nll c=1;\nwhile(b){\nif(b&amp;1) c=c*a%mod;\na=a*a%mod;\nb&gt;&gt;=1;\n}\nreturn c;\n}\nsigned main(){\ninv2=ksm(2,mod-2);inv6=ksm(6,mod-2);//\u9884\u5904\u7406 2 \u548c 6 \u7684\u9006\u5143\nf[2]=1;f[3]=2;f[0]=1;\nforup(i,4,1e7){\nf[i]=(f[i-2]*(i-1)%mod+f[i-1]*(i-1)%mod)%mod;\n}\nt=read();\nwhile(t--){\nn=read();\nif(n==1){puts(\"0\");continue;}\nll shuangshe=(f[n]+f[n-2])*inv2%mod*n%mod*(n-1)%mod*inv2%mod;\nll trible=n*(n-1)%mod*inv6%mod;\nll add=(trible*f[n-1]%mod)%mod;\nprintf(\"%lld\\n\",(shuangshe+add)%mod);\n}\n}\n</code></pre>"},{"location":"solution/20230418C_C/","title":"20230418C \u91d1\u6761\u4e89\u593a","text":"<p>\u4f20\u9001\u95e8</p>"},{"location":"solution/20230418C_C/#part-0","title":"Part 0 \u9898\u610f\u7406\u89e3","text":"<p>\u9996\u5148\u5bb9\u6613\u53d1\u73b0\u6700\u591a\u53ea\u4f1a\u53d1\u751f\u4e00\u6b21\u62a2\u593a\uff0c\u56e0\u4e3a\u5047\u5982 A \u62a2\u4e86\u4e4b\u540e\u53c8\u4f1a\u88ab B \u62a2\u56de\u53bb\uff0c\u90a3\u4e48 A \u80af\u5b9a\u4e0d\u4f1a\u53bb\u62a2\uff0c\u56e0\u4e3a\u6240\u6709\u4eba\u90fd\u5e0c\u671b\u4e0d\u8981\u9057\u61be\u79bb\u573a\uff0c\u800c\u6240\u6709\u4eba\u53c8\u8db3\u591f\u806a\u660e\u3002\u6240\u4ee5\u6211\u4eec\u5148\u89e3\u51b3\u4f1a\u4e0d\u4f1a\u53d1\u751f\u62a2\u593a\u7684\u95ee\u9898\u3002</p> <p>\u4ec0\u4e48\u65f6\u5019\u4f1a\u53d1\u751f\u62a2\u593a\u5462\uff1f\u663e\u7136\uff0c\u662f\u62a2\u4e86\u4e4b\u540e\u4e0d\u4f1a\u88ab\u62a2\u56de\u53bb\u65f6\u3002\u5047\u5982\u6211\u4eec\u628a\u6240\u6709\u80fd\u53d1\u751f\u62a2\u593a\uff08\u5373\u6ca1\u6709\u79c1\u4ea4\uff0c\u53c8\u4e0d\u5728\u540c\u4e00\u7ec4\uff09\u7684\u4eba\u4e4b\u95f4\u8fde\u4e00\u6761\u8fb9\uff0c\u5bb9\u6613\u53d1\u73b0\u8fd9\u5176\u5b9e\u662f\u4e2a\u4e8c\u5206\u56fe\u535a\u5f08\u6a21\u578b\uff08\u5176\u5b9e\u56e0\u4e3a\u6211\u6ca1\u5b66\u8fc7\u6240\u4ee5\u5e76\u4e0d\u5bb9\u6613 awa\uff09\uff0c\u91d1\u6761\u4ec5\u80fd\u6309\u8fb9\u79fb\u52a8\u3002</p> <p>\u5047\u5982\u6700\u540e\u91d1\u6761\u4e0d\u80fd\u79fb\u52a8\u65f6\u4e0d\u5728 $P$ \u7ec4\uff08\u5373\u6a21\u578b\u4e2d\u201c\u5148\u624b\u80dc\u201d\u7684\u60c5\u51b5\uff0c\u4e3a\u65b9\u4fbf\u53d9\u8ff0\u8bbe\u8fd9\u7ec4\u4e3a $Q$\uff09\uff0c\u90a3\u4e48\u53ef\u4ee5\u53d1\u751f\u62a2\u593a\uff0c\u56e0\u4e3a\u5047\u5982 $Q$ \u7ec4\u7684 $A$ \u62a2\u4e86\u540e\u88ab $P$ \u7ec4\u7684 $B$ \u62a2\u56de\u53bb\uff0c\u90a3 $Q$ \u7ec4\u5c31\u5fc5\u5b9a\u6709\u4e00\u4e2a $C$ \u80fd\u62a2\u56de\u53bb\uff0c$B$ \u5c31\u4e0d\u4f1a\u53bb\u62a2\u3002\u540c\u7406\uff0c\u5047\u5982\u6700\u540e\u91d1\u6761\u7559\u5728 $P$ \u7ec4\uff08\u5373\u201c\u540e\u624b\u80dc\u201d\uff09\uff0c\u90a3\u4e48\u5c31\u4e0d\u4f1a\u53d1\u751f\u62a2\u593a\u3002</p>"},{"location":"solution/20230418C_C/#part-1","title":"Part 1 \u4e8c\u5206\u56fe\u535a\u5f08","text":"<p>\u7531\u4e8e\u6211\u4e4b\u524d\u6ca1\u5b66\u8fc7\u4e8c\u5206\u56fe\u535a\u5f08\u6a21\u578b\u6240\u4ee5\u6211\u8fd9\u91cc\u8981\u8bb2\u4e00\u8bb2\uff08\u65b9\u4fbf\u7406\u89e3\uff09\u3002</p> <p>\u9996\u5148\uff0c\u8fd9\u4e2a\u6a21\u578b\u662f\u6709\u4e00\u4e2a\u4e8c\u5206\u56fe\uff0c\u5176\u4e2d\u8d77\u70b9 $H$ \u4e0a\u6709\u4e00\u4e2a\u68cb\u5b50\uff0c\u5148\u624b\u540e\u624b\u5206\u522b\u6cbf\u8fb9\u79fb\u52a8\u68cb\u5b50\uff0c\u4e0d\u80fd\u91cd\u590d\u7ecf\u8fc7\u67d0\u4e2a\u70b9\uff0c\u6700\u540e\u65e0\u8def\u53ef\u8d70\u7684\u5c31\u8f93\u4e86\u3002</p> <p>\u8fd9\u4e2a\u6a21\u578b\u7684\u7ed3\u8bba\u5982\u4e0b\uff1a</p> <p>\u5047\u5982\u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d\u4e00\u5b9a\u5305\u542b\u8d77\u70b9 $H$\uff0c\u5148\u624b\u5fc5\u80dc\uff1b\u53cd\u4e4b\uff0c\u5148\u624b\u5fc5\u8d25\u3002</p> <p>\u5047\u5982\u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d\u4e00\u5b9a\u5305\u542b $H$\uff0c\u90a3\u4e48\u5148\u624b\u53ea\u9700\u8981\u6309\u67d0\u6761\u5339\u914d\u8fb9\u79fb\u52a8\u68cb\u5b50\uff0c\u540e\u624b\u65e0\u8bba\u5982\u4f55\u5fc5\u5b9a\u4f1a\u6cbf\u4e00\u6761\u975e\u5339\u914d\u8fb9\u79fb\u5230\u53e6\u4e00\u4e2a\u5339\u914d\u70b9\u4e0a\uff08\u6216\u8005\u65e0\u8def\u53ef\u8d70\uff09\uff0c\u6240\u4ee5\u5148\u624b\u53ea\u9700\u8981\u6bcf\u6b21\u6cbf\u5339\u914d\u8fb9\u8d70\u5373\u53ef\u3002\u8bc1\u660e\u7684\u8bdd\uff0c\u8bbe\u8def\u5f84\u4e3a $H \\to P_1 \\to P_2\\to P_3\\dots$\uff0c\u5f53\u524d\u5728 $P_i$\uff0c\u4e0b\u4e00\u6b65\u540e\u624b\u4f1a\u6cbf\u8fb9 $P_i-P_{i+1}$ \u79fb\u52a8\u3002\u7531\u4e8e $P_{i-1}-P_i$ \u662f\u4e00\u6761\u5339\u914d\u8fb9\uff0c\u6240\u4ee5 $P_i-P_{i+1}$ \u5fc5\u5b9a\u662f\u4e00\u6761\u975e\u5339\u914d\u8fb9\u3002\u5047\u5982 $P_{i+1}$ \u4e0d\u662f\u5339\u914d\u70b9\uff0c\u90a3\u4e48\u5b58\u5728\u4e00\u4e2a\u5927\u5c0f\u548c\u539f\u5339\u914d ${H-P_1,P_2-P_3\\dots P_{i-1}-P_i}$ \u76f8\u7b49\u7684\u5339\u914d ${P_1-P_2,P_3-P_4\\dots P_i-P_{i+1}}$\uff0c\u4e0e\u6700\u5927\u5339\u914d\u4e00\u5b9a\u5305\u542b $H$ \u77db\u76fe\u3002</p> <p>\u5047\u5982\u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d\u4e0d\u4e00\u5b9a\u5305\u542b $H$\uff0c\u90a3\u4e48\u5fc5\u5b9a\u5b58\u5728\u4e00\u4e2a\u6700\u5927\u5339\u914d $M$ \u4e0d\u5305\u542b $H$\uff0c\u5148\u624b\u7b2c\u4e00\u6b65\u5fc5\u5b9a\u4f1a\u8d70\u5230 $M$ \u7684\u5339\u914d\u70b9\u4e0a\u3002\u5047\u5982\u7b2c\u4e00\u6b65\u4e0d\u79fb\u52a8\u5230\u5339\u914d\u70b9\u4e0a\uff0c\u90a3\u4e48 $H-P_1$ \u5c31\u53ef\u4ee5\u548c $M$ \u5339\u914d\uff0c\u4e0e $M$ \u662f\u6700\u5927\u5339\u914d\u77db\u76fe\u3002\u5f80\u540e\u6bcf\u4e00\u6b65\u5148\u624b\u90fd\u5fc5\u5b9a\u8d70\u5230\u53e6\u4e00\u4e2a\u5339\u914d\u70b9\u4e0a\uff0c\u540e\u624b\u53ea\u8981\u6cbf $M$ \u7684\u5339\u914d\u8fb9\u8d70\u5373\u53ef\uff0c\u540c\u6837\u8bbe\u8def\u5f84\u4e3a $H \\to P_1 \\to P_2\\to P_3\\dots$\uff0c\u90a3\u4e48 $M$ \u5373\u4e3a ${P_1-P_2,P_3-P_4\\dots,P_{i-1}-P_i}$\uff0c\u5047\u5982 $P_{i+1}$ \u4e0d\u662f\u5339\u914d\u70b9\uff0c\u90a3\u4e48\u5b58\u5728\u53e6\u4e00\u4e2a\u66f4\u5927\u7684\u5339\u914d ${H-P_1,P_2-P_3\\dots P_i-P_{i+1}}$\uff0c\u540c\u6837\u4e0e $M$ \u4e3a\u6700\u5927\u5339\u914d\u77db\u76fe\u3002</p> <p>\u56de\u5230\u8fd9\u9053\u9898\uff0c\u5047\u5982 $P=2$\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u4e24\u7ec4\u7684\u4fe1\u606f\u4ea4\u6362\u4e00\u4e0b\uff08\u7528\u6570\u5b66\u8bed\u8a00\u5c31\u662f\u201c\u4e0d\u59a8\u8bbe $P=1$\u201d\uff0c\u6700\u540e\u8f93\u51fa\u65f6\u6ce8\u610f\u4e00\u4e0b\u5373\u53ef\uff09\uff0c\u5c06\u7b2c\u4e00\u7ec4\u4eba\u8bbe\u4e3a $1\\sim n$\uff0c\u7b2c\u4e8c\u7ec4\u4e3a $n+1\\sim n+m$\uff0c\u5c06\u6240\u6709\u4e0d\u5728\u540c\u4e00\u7ec4\u4e5f\u6ca1\u6709\u79c1\u4ea4\u7684\u4eba\u4e24\u4e24\u8fde\u8fb9\u7ec4\u6210\u4e8c\u5206\u56fe\uff0c\u5148\u53bb\u6389\u70b9 $X$ \u8dd1\u4e00\u904d\u6700\u5927\u5339\u914d\uff0c\u518d\u52a0\u4e0a\u5b83\u8dd1\u4e00\u904d\u6700\u5927\u5339\u914d\uff0c\u5047\u5982\u52a0\u4e0a\u540e\u6700\u5927\u5339\u914d\u53d8\u5927\u4e86\u90a3\u4e48\u8bf4\u660e\u6240\u6709\u6700\u5927\u5339\u914d\u90fd\u5305\u542b\u70b9 $X$\uff0c\u5373\u5148\u624b\u80dc\uff0c\u53cd\u4e4b\u540e\u624b\u80dc\uff08\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa\u521d\u59cb\u60c5\u51b5\uff09\u3002\u8fd9\u4e00\u6b65\u7684\u590d\u6742\u5ea6\u4e3a $O((n+m)\\sqrt{nm-k})$\uff08\u597d\u602a\u7684\u590d\u6742\u5ea6\uff09\u3002</p>"},{"location":"solution/20230418C_C/#part-3","title":"Part 3 \u5224\u65ad\u53ef\u884c\u8fb9","text":"<p>\u5047\u5982\u5148\u624b\u80dc\uff0c\u90a3\u4e48\u6211\u4eec\u8fd8\u8981\u89e3\u51b3\u53e6\u4e00\u4e2a\u95ee\u9898\uff1a\u8c01\u4f1a\u62a2\u91d1\u6761\u3002</p> <p>\u5bb9\u6613\u53d1\u73b0\uff0c\u4f1a\u62a2\u91d1\u6761\u7684\u5176\u5b9e\u5c31\u662f\u6240\u6709\u4ece $X$ \u51fa\u53d1\u7684\u53ef\u884c\u8fb9\u4e2d\uff0c\u8fde\u5411\u7684\u7f16\u53f7\u6700\u5c0f\u7684\u4eba\uff0c\u6211\u4eec\u53ea\u8981\u80fd\u5224\u65ad\u67d0\u6761\u8fb9\u662f\u5426\u4e3a\u53ef\u884c\u8fb9\uff0c\u5c31\u80fd\u627e\u5230\u62a2\u593a\u8005\u3002</p> <p>\u5728\u5b8c\u5907\u5339\u914d\u4e2d\uff0c\u5047\u5982\u8fb9 $U-V$ \u4e3a\u53ef\u884c\u8fb9\uff0c\u53ea\u9700\u8981\u6ee1\u8db3\u4ee5\u4e0b\u4e24\u4e2a\u6761\u4ef6\u4e4b\u4e00\uff1a</p> <ul> <li>$U-V$ \u5f53\u524d\u662f\u5339\u914d\u8fb9\uff08\u5982\u679c\u4f60\u662f\u7528 Dinic \u6c42\u7684\u6700\u5927\u5339\u914d\u90a3\u4e48\u7b49\u4ef7\u4e8e $U \\to V$ \u7684\u6b8b\u91cf\u4e3a $0$\uff09\u3002</li> <li>$U-V$ \u662f\u975e\u5339\u914d\u8fb9\uff0c\u8bbe\u5f53\u524d $U$ \u4e0e $I$ \u5339\u914d\uff0c$V$ \u4e0e $J$ \u5339\u914d\uff0c\u8fde\u63a5 $U-V$ \u540e\uff0c$I$ \u548c $J$ \u5931\u53bb\u5339\u914d\uff0c\u90a3\u4e48\u5fc5\u987b\u80fd\u627e\u5230\u4e00\u6761\u4ece $J$ \u5230 $I$ \u7684\u589e\u5e7f\u8def\u624d\u80fd\u4fdd\u8bc1\u6700\u5927\u5339\u914d\u3002</li> </ul> <p>\u5bb9\u6613\u53d1\u73b0\uff0c\u5047\u5982\u6211\u4eec\u628a\u5339\u914d\u8fb9\u89c6\u4e3a\u4ece\u53f3\u81f3\u5de6\u7684\u6709\u5411\u8fb9\uff0c\u975e\u5339\u914d\u8fb9\u89c6\u4e3a\u4ece\u5de6\u81f3\u53f3\u7684\uff08\u5373\u8dd1\u5b8c Dinic \u540e\u7684\u6b8b\u91cf\u7f51\u7edc\u4e2d\u6b8b\u91cf\u4e3a $1$ \u7684\u5355\u5411\u8fb9\uff09\u3002\u90a3\u4e48\u663e\u7136\uff0c\u4ece $U$ \u5230 $V$ \u6709\u4e00\u6761\u5355\u5411\u8fb9\uff0c\u4ece $I$ \u5230 $U$\uff0c\u4ece $V$ \u5230 $J$ \u4e5f\u5404\u6709\u4e00\u6761\u5355\u5411\u8fb9\uff0c\u5047\u5982\u6211\u4eec\u80fd\u518d\u627e\u5230\u4e00\u6761\u4ece $V$ \u5230 $U$ \u7684\u8def\u5f84\uff0c\u90a3\u4e48\u5b83\u6ee1\u8db3\u5982\u4e0b\u6027\u8d28\uff1a</p> <ul> <li>\u8fd9\u6761\u8def\u5f84\u957f\u5ea6\u80af\u5b9a\u4e3a\u5947\u6570\uff0c\u56e0\u4e3a\u4e8c\u5206\u56fe\u4e2d\u6ca1\u6709\u5947\u73af\uff0c\u800c\u8fd9\u6761\u8def\u5f84\u52a0\u4e0a\u8fb9 $U-V$ \u5c31\u662f\u4e00\u4e2a\u73af\u3002</li> <li>\u8fd9\u6761\u8def\u5f84\u662f\u4ece $V$ \u5230 $U$ \u7684\u589e\u5e7f\u8def\uff0c\u6240\u4ee5\u53bb\u9664\u4e24\u7aef\u7684\u4e24\u6761\u8fb9\u540e\u5b83\u5c31\u662f\u4ece $J$ \u5230 $I$ \u7684\u589e\u5e7f\u8def\u3002</li> </ul> <p>\u5047\u5982\u539f\u5148\u4ece $V$ \u5230 $U$ \u7684\u589e\u5e7f\u8def\u4e2d\u5339\u914d\u4e86 $e$ \u6761\u8fb9\uff0c\u90a3\u4e48\u4ece $J$ \u5230 $I$ \u7684\u589e\u5e7f\u8def\u4e2d\u5c31\u5339\u914d\u4e86 $e-1$ \u6761\u8fb9\uff0c\u52a0\u4e0a\u65b0\u589e\u7684 $U-V$ \u8fd9\u6761\u8fb9\uff0c\u663e\u7136\u5339\u914d\u6570\u4e0d\u53d8\u3002</p> <p>\u5bb9\u6613\u53d1\u73b0 $U$ \u80fd\u5230\u8fbe $V$\uff0c$V$ \u53c8\u80fd\u5230\u8fbe $U$\uff0c\u5176\u5b9e\u5c31\u662f\u5728\u8bf4 $U,V$ \u5728\u540c\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\uff0c\u6211\u4eec\u5bf9\u6b8b\u91cf\u7f51\u7edc\uff08\u5982\u679c\u4f60\u7528\u7684\u4e0d\u662f Dinic \u5c31\u81ea\u5df1\u624b\u52a8\u7ed9\u8fb9\u5b9a\u5411\uff09\u8dd1\u4e00\u904d\u5f3a\u8fde\u901a\u5373\u53ef\u6c42\u89e3\u3002</p> <p>\u4f46\u662f\u8fd9\u9053\u9898\u4e0d\u4e00\u5b9a\u662f\u5b8c\u5907\u5339\u914d\uff0c\u4e0a\u9762\u7684\u7ed3\u8bba\u4f1a\u51fa\u73b0\u4e00\u4e9b\u95ee\u9898\u3002</p> <ul> <li>$U,V$ \u4e8c\u8005\u4e4b\u4e00\u53ef\u80fd\u672c\u6765\u5c31\u662f\u975e\u5339\u914d\u70b9\uff0c\u4e0d\u59a8\u8bbe $V$ \u662f\u975e\u5339\u914d\u70b9\uff0c\u6b64\u65f6\u76f4\u63a5\u65ad\u5f00 $U$ \u539f\u6765\u7684\u5339\u914d\u8fb9\uff0c\u8fde\u63a5 $U-V$ \u4ecd\u7136\u662f\u6700\u5927\u5339\u914d\u3002</li> <li>\u5373\u4f7f\u5f53\u524d $U$ \u4e0e $I$ \u5339\u914d\uff0c$V$ \u4e0e $J$ \u5339\u914d\uff0c\u8fde\u63a5 $U-V$ \u540e\uff0c$I,J$ \u5931\u53bb\u5339\u914d\uff0c\u6211\u4eec\u4e5f\u4e0d\u4e00\u5b9a\u975e\u8981\u627e\u5230\u4ece $J$ \u5230 $I$ \u7684\u589e\u5e7f\u8def\uff0c\u56e0\u4e3a\u4ece $I$ \u5230\u53e6\u4e00\u975e\u5339\u914d\u70b9\u7684\u589e\u5e7f\u8def\u540c\u6837\u53ef\u4ee5\u5f97\u5230\u4e00\u7ec4\u5305\u542b $U,V$ \u7684\u6700\u5927\u5339\u914d\u3002</li> </ul> <p>\u6240\u4ee5\u6211\u4eec\u4e0d\u80fd\u76f4\u63a5\u5f53\u6210\u5b8c\u5907\u5339\u914d\u6765\u505a\uff0c\u4f46\u6211\u4eec\u8bbe\u53f3\u90e8\u67d0\u70b9\u4e3a $W$\uff0c\u6c47\u70b9\u4e3a $T$\uff0c\u5047\u5982 $W$ \u4e3a\u975e\u5339\u914d\u70b9\uff0c$W \\to T$ \u7684\u6b8b\u91cf\u5fc5\u5b9a\u4e3a $1$\uff0c\u53cd\u4e4b\uff0c\u5047\u5982 $W'$ \u4e3a\u5339\u914d\u70b9\uff0c$W \\to T$ \u7684\u6b8b\u91cf\u5fc5\u5b9a\u4e3a $0$\uff0c\u5373 $T \\to W'$ \u7684\u6b8b\u91cf\u4e3a $1$\uff0c\u6362\u8a00\u4e4b\uff0c\u5b58\u5728\u4e00\u6761\u8def\u5f84 $W \\to T \\to W'$\u3002\u5047\u5982\u4e8c\u5206\u56fe\u4e2d\u6709\u4e00\u6761 $V$ \u5230 $U$ \u7684\u589e\u5e7f\u8def\uff0c\u90a3\u4e48\u5fc5\u5b9a\u80fd\u4ece $U$ \u7ecf\u8fc7\u6b8b\u91cf\u7f51\u7edc\u5230\u8fbe $W$\uff0c\u8fdb\u800c\u5230\u8fbe $V$\uff0c$U,V$ \u4ecd\u5728\u540c\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u3002</p> <p>\u5728\u8fd9\u4e00\u6b65\u4e2d\uff0c\u8dd1\u4e00\u904d\u5f3a\u8fde\u901a\u7684\u590d\u6742\u5ea6\u4e3a $O((n+m)+(nm-k))$\uff0c\u6700\u7ec8\u679a\u4e3e\u6c42\u89e3\u7684\u590d\u6742\u5ea6\u4e3a $O(m)$\uff0c\u6545\u6574\u4e2a\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u662f $O((n+m)\\sqrt{nm-k}+(n+m)+(nm-k)+m)$\uff0c\u5dee\u4e0d\u591a\u662f $O(n^2)$ \u7ea7\u522b\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002</p>"},{"location":"solution/20230418C_C/#code","title":"code","text":"<pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;string.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#include&lt;vector&gt;\n#include&lt;queue&gt;\n#include&lt;stack&gt;\n#define pbk(a) emplace_back(a)\n#define forup(i,s,e) for(int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(int i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst int N=2010,inf=0x3f3f3f3f;\nint n,m,p,x,K,ans[N];\nvoid print(){\nif(p==1){\nforup(i,1,n){\nprintf(\"%d \",ans[i]+1);\n}\nputs(\"\");\nforup(i,1,m){\nprintf(\"%d \",ans[i+n]+1);\n}\n}else{//\u8f93\u51fa\u65f6\u6ce8\u610f\u53cd\u5411\u8f93\u51fa\nforup(i,1,m){\nprintf(\"%d \",ans[i+n]+1);\n}\nputs(\"\");\nforup(i,1,n){\nprintf(\"%d \",ans[i]+1);\n}\n}\n}\nstruct Node{//\u94fe\u5f0f\u524d\u5411\u661f\nint v,val,nxt;\n}e[N*N],e2[N*N];\nint head[N],cnt=1;//\u6ce8\u610f cnt \u4ece 1 \u5f00\u59cb\u624d\u80fd\u7528\u6210\u5bf9\u5b58\u50a8\u7684\u6280\u5de7\nvoid adde(int u,int v,int val){\ne[++cnt]=Node{v,val,head[u]};head[u]=cnt;\n}\nvector&lt;int&gt; e1[N];\nint st,ed;\nvoid BuildGraph(){\nforup(i,1,n){\ne1[i].push_back(n);\ne1[i].push_back(n+m+1);\nsort(e1[i].begin(),e1[i].end());\nif(i!=x){\nint len=e1[i].size();\nforup(j,1,len-1){\nforup(k,e1[i][j-1]+1,e1[i][j]-1){\nadde(i,k,1);adde(k,i,0);\n}\n}\n}\n}\nst=n+m+1,ed=n+m+2;\nforup(i,1,n){\nif(i!=x){//\u5efa\u56fe\u65f6\u5148\u4e0d\u52a8\u5173\u4e8e x \u7684\u8fb9\nadde(st,i,1);adde(i,st,0);\n}\n}\nforup(i,n+1,n+m){\nadde(i,ed,1);adde(ed,i,0);\n}\n}\nint cur[N],lv[N];\nbool bfs(){\nmem(lv,-1);\nlv[st]=0;\nmemcpy(cur,head,sizeof(head));//\u5f53\u524d\u5f27\u4f18\u5316\nqueue&lt;int&gt; q;\nq.push(st);\nwhile(q.size()){\nint u=q.front();q.pop();\nfor(int i=head[u];i;i=e[i].nxt){\nint v=e[i].v,vol=e[i].val;\nif(vol&gt;0&amp;&amp;lv[v]==-1){\nlv[v]=lv[u]+1;q.push(v);\n}\n}\n}\nreturn lv[ed]!=-1;\n}\nint dfs(int u=st,int flow=inf){\nif(u==ed) return flow;\nint rem=flow;\nfor(int&amp; i=cur[u];i&amp;&amp;rem;i=e[i].nxt){\nint v=e[i].v,vol=e[i].val;\nif(vol&gt;0&amp;&amp;lv[v]==lv[u]+1){\nint c=dfs(v,min(vol,rem));\nrem-=c;\ne[i].val-=c;\ne[i^1].val+=c;//\u201c\u6210\u5bf9\u5b58\u50a8\u201d\u6280\u5de7\n}\n}\nreturn flow-rem;\n}\nint dinic(){//Dinic \u677f\u5b50\nint res=0;\nwhile(bfs()){\nres+=dfs();\n}\nreturn res;\n}\nint belong[N],ist[N],dfn[N],low[N],cntdfn,csc;\nstack&lt;int&gt; stk;\nvoid Tarjan(int x){//Tarjan \u5f3a\u8fde\u901a\uff0c\u6ca1\u5565\u597d\u8bf4\u7684\ndfn[x]=low[x]=++cntdfn;stk.push(x);ist[x]=1;\nfor(int i=head[x];i;i=e[i].nxt) if(e[i].val==1){\nint v=e[i].v;\nif(!dfn[v]){\nTarjan(v);\nlow[x]=min(low[x],low[v]);\n}else if(ist[v]){\nlow[x]=min(low[x],dfn[v]);\n}\n}\nif(dfn[x]==low[x]){\ncsc++;\nwhile(stk.top()!=x){\nbelong[stk.top()]=csc;\nist[stk.top()]=0;\nstk.pop();\n}\nbelong[stk.top()]=csc;\nist[stk.top()]=0;\nstk.pop();\n}\n}\nvoid solve(){\nmemcpy(e2,e,sizeof(e));//\u590d\u5236\u4e00\u4efd\u65b9\u4fbf\u8fd8\u539f\nint bef=dinic();\nmemcpy(e,e2,sizeof(e2));\nint len=e1[x].size();//\u52a0\u4e0a\u548c x \u6709\u5173\u7684\u8fb9\nforup(j,1,len-1){\nforup(k,e1[x][j-1]+1,e1[x][j]-1){\nadde(x,k,1);adde(k,x,0);\n}\n}\nadde(st,x,1);adde(x,st,0);\nint aft=dinic();\nif(aft==bef) return;//\u5047\u5982\u6ca1\u6709\u53d8\u5316\u8bf4\u660e\u5148\u624b\u5fc5\u8d25\nforup(i,1,m+n+2){//\u8dd1\u5f3a\u8fde\u901a\nif(!dfn[i]) Tarjan(i);\n}\nint mn=inf;\nfor(int i=head[x];i;i=e[i].nxt){//\u679a\u4e3e\u4ece x \u51fa\u53d1\u7684\u8fb9\uff0c\u7edf\u8ba1\u7b54\u6848\nif(e[i].v!=st&amp;&amp;e[i].v!=ed&amp;&amp;(e[i].val==0||belong[e[i].v]==belong[x])){\nmn=min(mn,e[i].v);\n}\n}\nans[mn]=1;\nans[x]=-1;\n}\nsigned main(){\nn=read();m=read();p=read();x=read();K=read();\nif(p==2) swap(n,m);//\u201c\u4e0d\u59a8\u8bbe P=1\u201d\nans[x]=1;\nforup(i,1,K){\nint u=read(),v=read();\nif(p==2) swap(u,v);\ne1[u].push_back(v+n);\n}\nBuildGraph();\nsolve();\nprint();\n}\n</code></pre>"},{"location":"solution/20230420C_ABC/","title":"20230420C","text":"<p>\u4f20\u9001\u95e8</p>"},{"location":"solution/20230420C_ABC/#t1","title":"T1 \u9898\u89e3","text":"<p>\u9996\u5148\u5bb9\u6613\u53d1\u73b0\u5177\u4f53\u586b\u54ea\u4e9b\u6570\u5e76\u4e0d\u5f71\u54cd\u671f\u671b\uff0c\u6211\u4eec\u5c31\u4e0d\u8003\u8651\u8fd9\u4e00\u90e8\u5206\u3002</p> <p>\u8003\u8651\u6743\u503c $2^{R+C}$ \u7684\u610f\u4e49\u3002</p> <p>\u53d1\u73b0\u7b49\u4ef7\u4e8e\u5f53\u524d\u60c5\u51b5\u5305\u542b\u54ea\u51e0\u79cd\u5176\u4f59\u60c5\u51b5\u3002</p> <p>\u6240\u4ee5\u6743\u503c\u548c\u7b49\u4ef7\u4e8e\u6240\u6709\u60c5\u51b5\u603b\u5171\u88ab\u591a\u5c11\u79cd\u60c5\u51b5\u5305\u542b\u3002</p> <p>\u679a\u4e3e $R,C,k$ \u5229\u7528\u7ec4\u5408\u6570\u6c42\u89e3\uff08$k$ \u4e3a\u77e9\u9635\u4e2d\u6d82\u9ed1\u591a\u5c11\u4e2a\u683c\u5b50\uff0c\u4e0a\u4e0b\u754c\u5f88\u5bb9\u6613\u7b97\uff09\u3002</p> <p>$$\\sum\\limits_{R=0}^n\\sum\\limits_{C=0}^n\\dbinom{n}{R}\\cdot\\dbinom{n}{C}\\cdot\\dbinom{n\\times n -(R+C)\\times n+R\\times C }{k-(R+C)\\times n+R\\times C}$$</p> <p>\u9884\u5904\u7406 $\\binom{n}{i}$ \u548c $\\binom{n\\times n-i}{k-i}$ \u5373\u53ef\uff0c\u590d\u6742\u5ea6 $O(n^2)$</p>"},{"location":"solution/20230420C_ABC/#code","title":"code","text":"<pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;string.h&gt;\n#include&lt;queue&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#include&lt;vector&gt;\n#define pbk(a) emplace_back(a)\n#define forup(i,s,e) for(register int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register int i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst int N=305; long double Cn[N],Cmk[N*N],ans;\nint n,m,k;\nsigned main()\n{\nn=read(),m=read(),k=read();\nCn[0]=1;\nforup(i,1,n){\nCn[i]=Cn[i-1]*(n-i+1)/i;        }\nCmk[0]=1;\nforup(i,1,k){\nCmk[i]=Cmk[i-1]*(k-i+1)/(m-i+1);        }\nforup(i,0,n){\nforup(j,0,n)\n{\nint zy=i*n+j*n-i*j;\nif(zy&gt;k) continue;\nans+=Cn[i]*Cn[j]*Cmk[zy];\n}       }\nif(ans&gt;=1e99) ans=1e99;\nprintf(\"%.15Lf\",ans);\n}\n</code></pre>"},{"location":"solution/20230420C_ABC/#t2","title":"T2 \u9898\u89e3","text":"<p>\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u79bb\u6563\u5316\uff0c\u5148\u628a\u5b89\u5168\u70b9\u6392\u5e8f\u3002\u5bf9\u4e8e\u6bcf\u79cd\u77ff\u7269\uff0c\u9884\u5904\u7406\u51fa\u53ef\u4ee5\u91c7\u5230\u5b83\u7684\u5b89\u5168\u70b9\u5de6\u53f3\u7aef\u70b9\uff0c\u8fd9\u4e00\u6b65\u53ef\u4ee5\u5229\u7528\u4e8c\u5206 $O(m\\log m+n \\log m)$ \u89e3\u51b3\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u5982\u4f55\u4e0d\u91cd\u4e0d\u6f0f\u5730\u8ba1\u7b97\u5217\u8868\u6570\uff0c\u5bb9\u6613\u60f3\u5230\uff0c\u53ef\u4ee5\u5229\u7528\u67d0\u79cd\u65b9\u6cd5\u5c06\u77ff\u7269\u6392\u5e8f\u540e\uff0c\u5bf9\u4e8e\u6bcf\u79cd\u77ff\u7269\uff0c\u8ba1\u7b97\u51fa\u4e00\u5b9a\u5305\u542b\u5b83\uff0c\u4e14\u4ec5\u5305\u542b\u7f16\u53f7\u5c0f\u4e8e\u7b49\u4e8e\u5b83\u7684\u77ff\u7269\u7684\u5217\u8868\u6570\u91cf\u3002\u5047\u8bbe\u5f53\u524d\u77ff\u7269\u4e0e\u7f16\u53f7\u5c0f\u4e8e\u5b83\u7684 $k$ \u79cd\u77ff\u7269\u76f8\u4ea4\uff0c\u90a3\u4e48\u5b83\u4ea7\u751f\u7684\u8d21\u732e\u5c31\u662f $2^{k}$ \u3002</p> <p>\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u8ba1\u7b97 $k$\uff0c\u8fd9\u662f\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u4e8c\u7ef4\u504f\u5e8f\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u628a\u77ff\u7269\u6309 $l$ \u5347\u5e8f\u6392\u5217\uff0c\u5229\u7528\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u6bcf\u4e2a\u77ff\u7269\u5f71\u54cd\u7684\u5b89\u5168\u70b9\u3002\u6bcf\u6b21\u67e5\u8be2\u65f6\uff0c\u53ea\u9700\u8981\u67e5\u8be2\u70b9 $l_i$ \u548c\u51e0\u4e2a\u533a\u95f4\u91cd\u5408\uff0c\u56e0\u4e3a\u6309 $l$ \u5347\u5e8f\u540e\u5c31\u4e0d\u4f1a\u51fa\u73b0\u524d\u9762\u7684\u533a\u95f4\u4e0e\u5f53\u524d\u77ff\u7269\u6709\u4ea4\uff0c\u4f46\u4e0d\u8986\u76d6\u70b9 $l$ \u7684\u60c5\u51b5\u4e86\u3002</p> <p>\u590d\u6742\u5ea6 $O(n\\log n)$</p>"},{"location":"solution/20230420C_ABC/#code_1","title":"code","text":"<pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;string.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#include&lt;vector&gt;\n#include&lt;set&gt;\n#define pbk(a) emplace_back(a)\n#define forup(i,s,e) for(register int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register int i=(s);i&gt;=(e);i--)\n#define abs(x) (((x)^((x)&gt;&gt;63))-((x)&gt;&gt;63))\nusing namespace std;\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst int N=1e5+5,inf=0x3f3f3f3f,mod=998244353;\nint n,m,a[N],ans;\nint ksm(int a,int b){\nint c=1;\nwhile(b){\nif(b&amp;1) c=(1ll*a*c)%mod;\na=(1ll*a*a)%mod;\nb&gt;&gt;=1;\n}\nreturn c;\n}\nstruct Node{\nint l,r;\n}s[N];\nbool cmp(Node a,Node b){\nif(a.l!=b.l) return a.l&lt;b.l;\nreturn a.r&lt;b.r;\n}\nstruct Tree{\nint c[N];\nvoid upd(int x,int k){for(;x&lt;=m;x+=x&amp;-x)c[x]=(c[x]+k)%mod;}\nint sum(int x){int res=0;for(;x&gt;0;x-=x&amp;-x)res=(res+c[x])%mod;return res;}\n}mt;\nsigned main(){\nn=read();m=read();\nforup(i,1,n){\ns[i].l=read();s[i].r=read();\n}\nforup(i,1,m){\na[i]=read();\n}\nsort(a+1,a+m+1);\nm=unique(a+1,a+m+1)-a-1;\nforup(i,1,n){\ns[i].l=lower_bound(a+1,a+m+1,s[i].l)-a;\ns[i].r=upper_bound(a+1,a+m+1,s[i].r)-a-1;\n}\nsort(s+1,s+n+1,cmp);\nforup(i,1,n){\nif(s[i].l&gt;s[i].r) continue;\nans=(ans+ksm(2,mt.sum(s[i].l)))%mod;\nmt.upd(s[i].l,1);mt.upd(s[i].r+1,-1);\n}\nprintf(\"%d\",ans);\n}\n</code></pre>"},{"location":"solution/20230420C_ABC/#t3","title":"T3 \u9898\u89e3","text":""},{"location":"solution/20230420C_ABC/#20pts","title":"20pts","text":"<p>\u66b4\u641c\u3002</p>"},{"location":"solution/20230420C_ABC/#40pt","title":"40pt","text":"<p>\u533a\u95f4 DP\uff0c\u8bbe $dp_{i,j}$ \u8868\u793a\u533a\u95f4 $[i,j]$ \u80fd\u5426\u8f6c\u6362\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5f88\u597d\u63a8\uff0c\u4e0d\u7ec6\u8bb2\u3002</p>"},{"location":"solution/20230420C_ABC/#70pts","title":"70pts","text":"<p>\u8003\u8651\u6211\u4eec\u5982\u4f55\u5224\u65ad\u4e00\u6574\u4e2a\u5b57\u7b26\u4e32\u80fd\u5426\u8f6c\u6362\u3002</p> <p>\u5bb9\u6613\u60f3\u5230\uff0c\u7528\u4e00\u4e2a\u6808\u6765\u7ef4\u62a4\uff0c\u4ece\u524d\u5f80\u540e\u904d\u5386\u4e00\u904d\uff0c\u6bcf\u6b21\u8bfb\u5230\u5143\u7d20\u548c\u6808\u9876\u4e0d\u540c\u5c31\u5165\u6808\uff0c\u76f8\u540c\u5c31\u51fa\u6808\u3002\u5047\u5982\u8bfb\u5b8c\u4e00\u4e2a\u5b57\u7b26\u4e32\u6808\u7a7a\u4e86\u8bf4\u660e\u53ef\u4ee5\u8f6c\u5316\u3002</p> <p>\u63a8\u5e7f\u4e00\u4e0b\uff0c\u5047\u5982 $i$ \u5904\u7684\u6808\u548c $j$ \u5904\u7684\u76f8\u540c\uff08$j &lt; i$\uff09\u90a3\u4e48\u533a\u95f4 $[j+1,i]$ \u5c31\u662f\u4e00\u4e2a\u53ef\u8f6c\u5316\u7684\u533a\u95f4\u3002</p> <p>\u6211\u4eec\u7528\u54c8\u5e0c\u7ef4\u62a4\u4e00\u4e0b\u6ca1\u4e2a\u4f4d\u7f6e\u7684\u6808\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u4f4d\u7f6e\uff0c$O(n)$ \u5730\u626b\u4e00\u904d\u524d\u9762\u7684\u770b\u6709\u6ca1\u6709\u4e00\u6837\u7684\u6808\uff0c\u6bcf\u6709\u4e00\u4e2a\u7b54\u6848\u5c31\u52a0\u4e00\uff0c\u590d\u6742\u5ea6 $O(n^2)$\u3002</p>"},{"location":"solution/20230420C_ABC/#100pts","title":"100pts","text":"<p>\u7528\u4e00\u4e2a <code>map</code> \u6765\u7ef4\u62a4\u4e00\u4e0b\u6bcf\u4e2a\u54c8\u5e0c\u503c\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u7c7b\u4f3c\u4e8e $70$ \u5206\u505a\u6cd5\uff0c\u590d\u6742\u5ea6 $O(n\\log n)$\u3002</p> <p>\u9700\u8981\u6ce8\u610f\uff0c\u8fd9\u9053\u9898\u6570\u636e\u5927\u4e86\u4e4b\u540e\u5bb9\u6613\u51fa\u73b0\u54c8\u5e0c\u51b2\u7a81\uff0c\u53ef\u4ee5\u5229\u7528 <code>pair</code> \u7528\u53cc\u54c8\u5e0c\u89e3\u51b3\u3002</p>"},{"location":"solution/20230420C_ABC/#code_2","title":"code","text":"<pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;string.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#include&lt;vector&gt;\n#include&lt;stack&gt;\n#include&lt;map&gt;\n#define pbk(a) emplace_back(a)\n#define mkp(a,b) make_pair(a,b)\n#define forup(i,s,e) for(register int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register int i=(s);i&gt;=(e);i--)\n#define abs(x) (((x)^((x)&gt;&gt;63))-((x)&gt;&gt;63))\nusing namespace std;\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nusing ll=long long;\nconst int N=1e6+5,inf=0x3f3f3f3f,P=13331,mod1=1e9+7,mod2=1e9+9;\nint ksm(int a,int b,int p){\nint c=1;\nwhile(b){\nif(b&amp;1) c=1ll*c*a%p;\na=1ll*a*a%p;\nb&gt;&gt;=1;\n}\nreturn c;\n}\nint n;\nll ans;\nchar s[N];\nll hush1,hush2;\nstack&lt;char&gt; stk;\nmap&lt;pair&lt;ll,ll&gt;,int&gt; mp;\nsigned main(){\nscanf(\" %s\",s+1);\nn=strlen(s+1);\nint inv1=ksm(13331,mod1-2,mod1),inv2=ksm(13331,mod2-2,mod2);\nmp[mkp(0,0)]++;\nforup(i,1,n){\nif(stk.empty()||stk.top()!=s[i]){\nstk.push(s[i]);\nhush1=1ll*(hush1*P+s[i]-'a'+1)%mod1;\nhush2=1ll*(hush2*P+s[i]-'a'+1)%mod2;\n}else{\nstk.pop();\nhush1=1ll*(hush1+mod1-(s[i]-'a'+1))*inv1%mod1;\nhush2=1ll*(hush2+mod2-(s[i]-'a'+1))*inv2%mod2;\n}\nans+=mp[mkp(hush1,hush2)];\nmp[mkp(hush1,hush2)]++;\n}\nprintf(\"%lld\",ans);\n}\n</code></pre>"},{"location":"solution/20230426C_ABC/","title":"20230426C","text":"<p>\u4f20\u9001\u95e8</p>"},{"location":"solution/20230426C_ABC/#t1","title":"T1 \u9898\u89e3","text":"<p>\u90e8\u5206\u5206\u66b4\u529b $DFS$\uff0c\u540e\u9762\u4e24\u4e2a\u7279\u6b8a\u70b9\u53ef\u4ee5\u7528\u6700\u5927\u7684\u4e00\u534a\u548c\u6700\u5c0f\u7684\u4e00\u534a\u5339\u914d\uff0c\u4e0d\u5c55\u5f00\u8bb2\u3002</p> <p>\u9996\u5148\u9898\u610f\u7b49\u4ef7\u4e3a\u9009 $\\dfrac{n}{2}$ \u4e2a $i$ \u7684 $r$ \u52a0\u8d77\u6765\uff0c\u51cf\u53bb\u5176\u4ed6\u6570\u7684 $l$\uff0c\u6c42\u6700\u5927\u503c\u3002\u8003\u8651\u8d2a\u5fc3\u3002</p> <p>\u9996\u5148\u5168\u9009 $r$\uff0c\u628a\u7b2c $i$ \u4e2a\u6362\u6210\u9009 $l$ \u5c31\u4f1a\u4f7f\u603b\u548c\u51cf\u5c0f $-l_i-r_i$\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u628a\u7b2c $i$ \u4e2a\u9009\u6210 $l$ \u7684\u4ee3\u4ef7\u662f $l_i+r_i$\u3002</p> <p>\u8d2a\u5fc3\u9009\u6700\u5c0f\u7684 $\\dfrac{n}{2}$ \u4e2a\u4ee3\u4ef7\u5373\u53ef\u3002</p>"},{"location":"solution/20230426C_ABC/#code","title":"code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(register int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register int i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst int N=1e6+5,inf=0x3f3f3f3f;\nint n,l[N],r[N];\nlong long lrlr[N],ans;\nsigned main(){\nn=read();\nforup(i,1,n){\nl[i]=read();r[i]=read();\nans+=r[i];\nlrlr[i]=l[i]+r[i];\n}\nsort(lrlr+1,lrlr+n+1);\nforup(i,1,n/2){\nans-=lrlr[i];   }\nprintf(\"%lld\",ans);\n}\n</code></pre>"},{"location":"solution/20230426C_ABC/#t2","title":"T2 \u9898\u89e3","text":"<p>\u8fd9\u9053\u9898\u6211\u6ca1\u94bb\u7814\u8fc7\u5c31\u4e0d\u8bb2\u90e8\u5206\u5206\u4e86\u3002</p> <p>\u6811\u4e0a\u80cc\u5305\u5408\u5e76\u3002</p> <p>\u8003\u8651\u679a\u4e3e\u79cd\u65cf $i$ \u53ef\u80fd\u4f1a\u9020\u53cd\uff0c\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\u6bcf\u6709\u4e00\u4e2a\u79cd\u65cf $i$ \u5c31\u4ea7\u751f $1$ \u8d21\u732e\uff0c\u53cd\u4e4b\u4ea7\u751f $-1$ \u8d21\u732e\uff0c\u8f6c\u5316\u4e3a\u6c42\u8d21\u732e\u5927\u4e8e $0$ \u7684\u8fde\u901a\u5757\u4e2a\u6570\u3002</p> <p>\u8003\u8651 $dp_{i,j}$ \u8868\u793a $i$ \u7684\u5b50\u6811\u4e2d\u5305\u62ec $i$ \u7684\u8fde\u901a\u5757\u6709\u591a\u5c11\u4e2a\u503c\u4e3a $j$\uff08\u6ce8\u610f\u5904\u7406\u8d1f\u6570\u4e0b\u6807\uff09\uff0c\u4f9d\u6b21\u5c06\u5f53\u524d\u8282\u70b9\u4e0e\u6bcf\u4e2a\u5b50\u8282\u70b9\u5408\u5e76\u3002</p> <p>\u5173\u4e8e\u5982\u4f55\u5408\u5e76\uff0c\u679a\u4e3e\u5f53\u524d\u8fde\u901a\u5757 $u$ \u7684\u503c $j$ \u4e0e\u5b50\u8282\u70b9 $v$ \u7684\u503c $k$\uff0c\u4f7f\u5f97 $dp_{u,j+k}$ \u589e\u52a0 $dp_{u,j}\\cdot dp_{v,k}$\uff0c\u9700\u8981\u6ce8\u610f\u5f00\u4e00\u4e2a\u4e34\u65f6\u6570\u7ec4\u5b58\u4e0d\u7136\u53ef\u80fd\u51fa\u73b0\u9519\u8bef\u3002</p> <p>\u6bcf\u6b21\u679a\u4e3e\u53ea\u9700\u8981\u679a\u4e3e\u6709\u610f\u4e49\u7684\u90e8\u5206\uff0c\u5176\u4ed6\u8d1f\u65e0\u7a77\u7684\u503c\u7565\u8fc7\uff0c\u5373\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\u5b58\u4e00\u4e2a\u4e0a\u754c\u548c\u4e0b\u754c\u6765\u8f6c\u79fb\uff0c\u5e76\u4e14\u53ea\u9700\u8981\u4fdd\u7559 $-cnt$ \u81f3 $cnt$ \u7684\u90e8\u5206\uff08$cnt$ \u4e3a\u6574\u68f5\u6811\u4e2d\u5f53\u524d\u989c\u8272\u7684\u6570\u91cf\uff09\uff0c\u5c31\u80fd\u5361\u8fc7\u53bb\u4e86\u3002</p> <p>\u5173\u4e8e\u590d\u6742\u5ea6\uff0c\u6811\u4e0a\u80cc\u5305\u590d\u6742\u5ea6\u662f $O(nk)$ \u7684\uff0c\u8fd9\u91cc $k$ \u5373\u4e3a $cnt$\uff0c\u800c $\\sum cnt=n$\uff0c\u6545\u590d\u6742\u5ea6\u4e3a $O(n^2)$\uff0c\u7531\u4e8e\u8f6c\u79fb\u65f6\u662f $O(n)$ \u5e26\u5c0f\u5e38\u6570\uff0c\u6240\u4ee5\u603b\u7684\u590d\u6742\u5ea6\u662f $O(n^3)$ \u5e26\u5c0f\u5e38\u6570\u3002</p>"},{"location":"solution/20230426C_ABC/#code_1","title":"code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define ll long long\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(register ll i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register ll i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline ll read(){\nll x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst ll N=3005,inf=0x3f3f3f3f,add=3005,mod=998244353;\nll n,c[N],cnt[N],ans;\nvector&lt;ll&gt; e[N];\nll dp[N][N&lt;&lt;1],sv[N&lt;&lt;1],mn[N],mx[N];\nll nwco;\nvoid dfs(ll x,ll fa){\nforup(i,-cnt[nwco],cnt[nwco]){\ndp[x][i+add]=0;\n}\nif(c[x]==nwco){\ndp[x][1+add]=1;\nmx[x]=mn[x]=1;//\u5b58\u50a8\u4e0a\u4e0b\u754c\n}else{\ndp[x][-1+add]=1;\nmx[x]=mn[x]=-1;\n}\nfor(auto i:e[x]){\nif(i==fa) continue;\ndfs(i,x);\nforup(j,mn[x],mx[x]){\nsv[j+add]=dp[x][j+add];\n}\nforup(j,mn[x],mx[x]){\nforup(k,mn[i],mx[i]){\nif(dp[x][j+add]==0||dp[i][k+add]==0||j+k&gt;cnt[nwco]||j+k&lt;-cnt[nwco]) continue;\nsv[j+k+add]=(sv[j+k+add]+dp[x][j+add]*dp[i][k+add]%mod)%mod;\nmn[x]=min(mn[x],j+k);\nmx[x]=max(mx[x],j+k);\n}\n}\nforup(j,mn[x],mx[x]){\ndp[x][j+add]=sv[j+add];sv[j+add]=0;\n}\n}\nforup(i,1,mx[x]){\nans=(ans+dp[x][i+add])%mod;\n}\n} signed main(){\nn=read();\nforup(i,1,n){\nc[i]=read();\ncnt[c[i]]++;\n}\nforup(i,1,n-1){\nll u=read(),v=read();\ne[u].push_back(v);e[v].push_back(u);\n}\nforup(i,1,n){\nif(!cnt[i]) continue;\nnwco=i;\ndfs(1,0);\n}\nprintf(\"%lld\",ans);\n}\n</code></pre>"},{"location":"solution/20230426C_ABC/#t3","title":"T3 \u9898\u89e3","text":""},{"location":"solution/20230426C_ABC/#1-20pts","title":"\u5b50\u4efb\u52a1 #1 20pts","text":"<p>\u8bbe $dp_i$ \u8868\u793a\u4ece $i$ \u5230 $n$ \u7684\u6700\u5927\u5fc3\u60c5\u503c\uff0c\u6709\u4e00\u4e2a\u663e\u7136\u7684 dp \u5f0f\u5b50\u3002</p> <p>$$dp_i=\\max\\limits_{j=i+1}^{i+T_i}{dp_j+H_i-\\left\\lfloor \\frac{j-i}{K} \\right\\rfloor\\cdot D}$$</p> <p>\u8fb9\u754c\u6761\u4ef6\u662f $dp_n=H_n$\uff0c\u7279\u5224\u5373\u53ef\uff0c\u53ef\u4ee5 $O(n)$ \u8f6c\u79fb\uff0c\u590d\u6742\u5ea6 $O(n^2)$\u3002</p>"},{"location":"solution/20230426C_ABC/#3-4","title":"\u5b50\u4efb\u52a1 #3 \u5b50\u4efb\u52a1 #4","text":"<p>\u5b50\u4efb\u52a1 #3 \u4e2d\uff0c$K=1$\uff0c\u6b64\u65f6\u4e0b\u53d6\u6574\u4e0d\u4f1a\u5f71\u54cd\uff0c#4 \u4e2d\uff0c$K=n$\uff0c\u6b64\u65f6\u75b2\u52b3\u5ea6\u59cb\u7ec8\u4e3a $0$\uff0c\u8fd9\u4e24\u4e2a\u70b9\u53ef\u4ee5\u76f4\u63a5\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\uff0c\u590d\u6742\u5ea6 $O(n\\log n)$\u3002</p>"},{"location":"solution/20230426C_ABC/#90pts","title":"90pts","text":"<p>\u5176\u5b9e\u68fa\u65b9\u9898\u89e3\u8bf4\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5 AC\uff0c\u4f46\u662f\u6211\u4e0d\u592a\u4fe1 $O(n\\log^2n)$ \u53ef\u4ee5\u8fc7 $10^6$\u3002</p> <p>\u6211\u4eec\u53d1\u73b0\u4e0b\u53d6\u6574\u975e\u5e38\u9ebb\u70e6\uff0c\u56e0\u4e3a\u96be\u4ee5\u628a $i$ \u548c $j$ \u5206\u522b\u62c6\u51fa\u6765\uff0c\u4f46\u601d\u8003\u4e00\u4e0b\u53d1\u73b0\u5176\u5b9e\u53ef\u4ee5\u62c6\u51fa\u6765\u3002</p> <p>\u5148\u4e0d\u770b\u540e\u9762\u7684\u7cfb\u6570 $D$\uff0c\u90a3\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u8fd9\u6837\u8f6c\u5316\uff1a</p> <p>\u4ee4 $I=i \\bmod K,J=j\\bmod K$</p> <p>$$\\left\\lfloor \\frac{j-i}{K} \\right\\rfloor=\\left\\lfloor \\frac{\\left\\lfloor\\frac{j}{K}\\right\\rfloor\\cdot K+J -(\\left\\lfloor\\frac{j}{K}\\right\\rfloor\\cdot K +I)}{K}\\right\\rfloor=\\left\\lfloor\\left\\lfloor\\frac{j}{K}\\right\\rfloor-\\left\\lfloor\\frac{i}{K}\\right\\rfloor+\\frac{J-I}{K}\\right\\rfloor$$</p> <p>\u7531\u4e8e\u524d\u9762\u4e24\u9879\u90fd\u662f\u6574\u6570\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u63d0\u51fa\u6765\uff0c\u5219\u4e0a\u5f0f\u53ef\u5316\u4e3a\uff1a</p> <p>$$\\left\\lfloor\\frac{j}{K}\\right\\rfloor-\\left\\lfloor\\frac{i}{K}\\right\\rfloor+\\left\\lfloor\\frac{J-I}{K}\\right\\rfloor$$</p> <p>\u7531\u4e8e $J &lt; K,I&lt;K$\uff0c\u6240\u4ee5 $\\left\\lfloor\\frac{J-I}{K}\\right\\rfloor$ \u5fc5\u5b9a\u7b49\u4e8e $0$ \u6216 $-1$\uff0c\u5f53\u4e14\u4ec5\u5f53 $J &lt;I,\\left\\lfloor\\frac{J-I}{K}\\right\\rfloor=-1$\u3002</p> <p>\u6545 20pts \u7684 dp \u5f0f\u5b50\u53ef\u5316\u4e3a\uff1a</p> <p>$$dp_i=\\max\\limits_{j=i+1}^{i+T_i}{dp_j+H_i-\\left\\lfloor\\frac{j}{K}\\right\\rfloor\\cdot D+\\left\\lfloor\\frac{i}{K}\\right\\rfloor\\cdot D+[j \\bmod K &lt; i\\bmod K]\\cdot D}$$</p> <p>\u5176\u4e2d\u4e2d\u62ec\u53f7\u8868\u793a\u6ee1\u8db3\u8be5\u6761\u4ef6\u65f6\u8be5\u8868\u8fbe\u5f0f\u7684\u503c\u4e3a $1$\uff08\u6ce8\u610f $-1$ \u4e0e\u524d\u9762\u7684\u51cf\u53f7\u8d1f\u8d1f\u5f97\u6b63\u5c31\u53d8\u6210\u52a0\u53f7\u4e86\uff09\u3002</p> <p>\u7136\u540e\u6211\u4eec\u628a\u5e26 $i$ \u7684\u5f0f\u5b50\u62c6\u51fa\u6765\uff1a</p> <p>$$dp_i=\\max\\limits_{j=i+1}^{i+T_i}{dp_j-\\left\\lfloor\\frac{j}{K}\\right\\rfloor\\cdot D+[j \\bmod K &lt; i\\bmod K]\\cdot D}+H_i+\\left\\lfloor\\frac{i}{K}\\right\\rfloor\\cdot D$$</p> <p>\u4ee4 $f_j=dp_j-\\left\\lfloor\\frac{j}{K}\\right\\rfloor\\cdot D$\uff1a</p> <p>$$dp_i=\\max\\limits_{j=i+1}^{i+T_i}{f_j+[j \\bmod K &lt; i\\bmod K]\\cdot D}+H_i+\\left\\lfloor\\frac{i}{K}\\right\\rfloor\\cdot D$$</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u90a3\u4e2a\u8ba9\u4eba\u5934\u75bc\u7684\u4e2d\u62ec\u53f7\u4e86\u3002</p> <p>\u6ce8\u610f\u5230\uff0c\u5047\u5982\u6211\u4eec\u628a\u6240\u6709 $\\left\\lfloor\\frac{j}{K}\\right\\rfloor$ \u76f8\u7b49\u7684 $j$ \u5206\u4e3a\u4e00\u5757\uff0c\u6ee1\u8db3\u90a3\u4e2a\u5f0f\u5b50\u7684\u4e00\u5b9a\u5728\u4e00\u4e2a\u8fde\u7eed\u7684\u533a\u95f4\u5185\uff0c\u4e14\u4e00\u5b9a\u662f\u8fd9\u4e00\u5757\u7684\u524d\u7f00\u3002</p> <p>\u753b\u4e2a\u56fe\u7406\u89e3\u4e00\u4e0b\uff0c\u6211\u4eec\u628a\u6240\u6709 $\\left\\lfloor\\frac{j}{K}\\right\\rfloor$ \u76f8\u7b49\u7684 $j$ \u653e\u5728\u540c\u4e00\u5217\uff0c\u6a21\u6570\u76f8\u540c\u7684\u653e\u5728\u540c\u4e00\u884c\u3002</p> <p></p> <p>\u8fd9\u542f\u53d1\u6211\u4eec\u7528\u4e00\u4e2a\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\uff08\u6216\u8005\u7b3c\u7edf\u5730\u8bf4\uff0c\u6811\u72b6\u6570\u7ec4\u5957\u6811\u72b6\u6570\u7ec4\uff09\u3002</p> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u6a21\u6570\uff08\u5373\u4e0a\u56fe\u4e2d\u6bcf\u4e00\u884c\uff09\uff0c\u7ef4\u62a4\u4e00\u4e2a\u6c42\u524d\u7f00\u6700\u5927\u503c\u6811\u72b6\u6570\u7ec4\uff0c\u7136\u540e\u628a\u8fd9\u4e9b\u6811\u72b6\u6570\u7ec4\u538b\u5230\u4e00\u68f5\u7eb5\u5411\u7684\u6811\u72b6\u6570\u7ec4\u91cc\uff0c\u7528\u6765\u6c42\u4e8c\u7ef4\u533a\u95f4\u6700\u5927\u503c\u3002</p> <p></p> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u5728 $O(\\log^2n)$ \u7684\u65f6\u95f4\u5185\u67e5\u8be2\u67d0\u4e2a\u77e9\u5f62\u5185\u7684\u6700\u5927\u503c\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u8981\u67e5\u8be2\u54ea\u4e9b\u533a\u95f4\uff0c\u5e26\u54ea\u4e2a\u5f0f\u5b50\u3002</p> <p>\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\uff1a</p> <p></p> <p>\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c$i+T_i$ \u7684\u6a21\u6570\u5927\u4e8e $i$ \u7684\u6a21\u6570\uff0c\u6211\u4eec\u9700\u8981\u67e5\u8be2\u4ee5\u4e0b\u51e0\u4e2a\u533a\u95f4\u3002</p> <p></p> <p>\u4e0a\u56fe\u51e0\u4e2a\u5f69\u8272\u5706\u70b9\u5373\u6211\u4eec\u67e5\u8be2\u7684\u70b9\uff0c\u524d\u9762\u591a\u67e5\u7684\u90e8\u5206\u90fd\u8d4b\u4e3a $-\\infty$ \u6240\u4ee5\u4e0d\u7528\u7ba1\u3002</p> <p>\u6709\u4eba\u53ef\u80fd\u6709\u95ee\u9898\uff1a\u4e3a\u4ec0\u4e48\u7ea2\u8272\u90e8\u5206\u548c\u9ec4\u8272\u90e8\u5206\u5e26\u4e24\u4e2a\u4e0d\u540c\u7684\u5f0f\u5b50\uff0c\u4f46\u7ea2\u8272\u90e8\u5206\u5305\u542b\u4e86\u9ec4\u8272\u90e8\u5206\u3002</p> <p>\u6b38\u8fd9\u4f60\u5c31\u95ee\u5bf9\u4eba\u4e86\uff0c\u6211\u6628\u665a\u505a\u68a6\u90fd\u5728\u60f3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u9ec4\u8272\u90e8\u5206\u5e26\u7684\u5f0f\u5b50\u7b49\u4e8e\u7ea2\u8272\u90e8\u5206\u52a0 $1$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5047\u5982\u7ea2\u8272\u90e8\u5206\u7684\u6700\u5927\u503c\u5728\u9ec4\u8272\u90e8\u5206\u91cc\uff0c\u90a3\u4e48\u5b83\u5e76\u4e0d\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f\u8d21\u732e\uff0c\u53ef\u4ee5\u5ffd\u7565\u3002</p> <p>\u53e6\u4e00\u79cd\u60c5\u51b5\uff1a</p> <p></p> <p>\u540c\u7406\uff0c\u4e0d\u89e3\u91ca\u4e86\u3002</p> <p></p> <p>\u590d\u6742\u5ea6 $O(n \\log \\frac{n}{K}\\cdot\\log K)$ \u9898\u89e3\u8bf4\u80fd\u8fc7 $2 \\times 10^6$\uff0c\u4f46\u6211\u4e0d\u4fe1\u3002</p>"},{"location":"solution/20230426C_ABC/#100-pts","title":"100 pts","text":"<p>\u6ce8\u610f\u5230\u6bcf\u4e00\u5217\u53ea\u6709\u6c42\u524d\u7f00\u64cd\u4f5c\uff0c\u4e14\u5904\u7406\u5b8c\u5f53\u524d\u5217\u540e\u5c31\u4e0d\u4f1a\u4fee\u6539\uff0c\u60f3\u5230\u7eb5\u5411\u7ef4\u5ea6\u4e0a\u5e76\u4e0d\u9700\u8981\u6811\u72b6\u6570\u7ec4\uff0c\u6211\u4eec\u5bf9\u5f53\u524d\u5217\u5355\u72ec\u5f00\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\uff0c\u6bcf\u6b21\u6e05\u7a7a\uff0c\u5904\u7406\u5b8c\u5f53\u5217\u540e\u987a\u7740\u8dd1\u4e00\u8fb9\u524d\u7f00\u6700\u5927\u503c\u4e0a\u4f20\u5230\u5bf9\u5e94\u7684\u6a2a\u5411\u6811\u72b6\u6570\u7ec4\u4e2d\u3002</p> <p>\u590d\u6742\u5ea6 $O(n \\log \\frac{n}{K})$\u3002</p> <p>\u9700\u8981\u6ce8\u610f\uff0c100pts \u505a\u6cd5\u548c 90pts \u505a\u6cd5\u90fd\u9700\u8981\u7528 <code>vector</code> \u52a8\u6001\u5f00\u7a7a\u95f4\u6765\u9632\u6b62 MLE\u3002</p>"},{"location":"solution/20230426C_ABC/#code_2","title":"code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(register ll i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register ll i=(s);i&gt;=(e);i--)\nusing namespace std;\ntypedef long long ll;\n#define T (1&lt;&lt;15)\nchar buf[T],*p1=buf,*p2=buf;\n#define nc() (p1==p2&amp;&amp;(p2=buf+fread(p1=buf,1,T,stdin),p1==p2)?-1:*p1++)\nll read(){//\u9898\u76ee\u7ed9\u7684\u5feb\u8bfb\uff0c\u8d5e\u7f8e\u597d\u9898\uff01\nll x=0;char c;bool s=0;\ndo c=nc();while(c!=45&amp;&amp;(c&lt;48||c&gt;57));\nif(c==45)c=nc(),s=1;\ndo x=10*x+(c&amp;15),c=nc();while(c&gt;=48&amp;&amp;c&lt;=57);\nreturn s?-x:x;\n}\n#undef T\nconst ll N=2e6+5,inf=1e18;\nll n,K,D,h[N],t[N],dp[N],blg[N],L[N],R[N];\nvoid mymax(ll&amp; a,ll b){\nif(a&lt;b) a=b;\n}\nstruct Tree1{\nvector&lt;ll&gt; c;\nll sz;\nvoid resz(ll x){c.resize(x+1);sz=x;forup(i,1,sz)c[i]=-inf;}\nvoid Upd(ll x,ll k){\nfor(;x&lt;=sz;x+=x&amp;-x){\nif(c[x]&gt;k)break;\nc[x]=k;\n}\n}\nll Ask(ll x){ll res=-inf;for(;x&gt;0;x-=x&amp;-x)res=max(res,c[x]);return res;}\n}nt;\nvector&lt;Tree1&gt; mt;\nsigned main(){\nn=read();K=read();D=read();\nmt.resize(K+1);\nforup(i,0,K){\nmt[i].resz((n+K-1)/K+1);\n}\nforup(i,1,n){\nh[i]=read();\n}\nforup(i,1,n-1){\nt[i]=read();\n}\nll cnt;//\u5757\u6570\nfor(int i=1;R[i-1]!=n;++i){\ncnt=i;\nL[i]=max((i-1)*K,1ll);R[i]=min(i*K-1,n);\nforup(j,L[i],R[i]){blg[j]=i;}\n}\nfordown(bl,cnt,1){\nnt.resz(K+1);//\u6e05\u7a7a\u5f53\u524d\u6811\u72b6\u6570\u7ec4\nfordown(i,R[bl],L[bl]){\nll pipi=i%K;//\u5728\u54ea\u4e00\u884c\nif(i==n){//n \u8981\u7279\u5224\ndp[i]=h[i];\nnt.Upd(pipi+1,dp[i]-i/K*D);\ncontinue;\n}\nll rted=min(t[i]+pipi+1,K);//\u5728\u5f53\u524d\u5757\u6700\u53f3\u80fd\u53d6\u5230\u54ea\u91cc\nll res=-inf;\nmymax(res,nt.Ask(rted)+i/K*D);\nif(t[i]+pipi+1&lt;=K){//\u5982\u679c i+T \u5c31\u5728\u5f53\u524d\u884c\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\ndp[i]=res+h[i];\nnt.Upd(pipi+1,dp[i]-i/K*D);\ncontinue;\n}\nll post=blg[i+t[i]],ppt=(pipi+t[i])%K;//Ti+i \u7684\u884c\u6570\u548c\u5217\u6570\nif(ppt&gt;=pipi-1){\nif(pipi!=0) mymax(res,mt[pipi-1].Ask(post)+i/K*D+D);\n//\u6ce8\u610f\u4e0d\u53d6\u7b49\uff0c\u6240\u4ee5\u8981\u51cf\u4e00\nmymax(res,mt[K-1].Ask(post-1)+i/K*D);\nmymax(res,mt[ppt].Ask(post)+i/K*D);\n}else{\nmymax(res,mt[pipi-1].Ask(post-1)+i/K*D+D);\nmymax(res,mt[K-1].Ask(post-1)+i/K*D);\nmymax(res,mt[ppt].Ask(post)+i/K*D+D);\n}\ndp[i]=res+h[i];//\u7edf\u8ba1\u7b54\u6848\nnt.Upd(pipi+1,dp[i]-i/K*D);//\u4e0a\u4f20\u5230\u5f53\u524d\u6811\u72b6\u6570\u7ec4\n}\nll mx=-inf;//\u524d\u7f00\u6700\u5927\u503c\nforup(i,L[bl],max(R[bl],L[bl]+K-1)){\n//\u5904\u7406\u5b8c\u540e\u9806\u5411\u4e0a\u4f20\u524d\u7f00\u6700\u5927\u503c\nif(i&lt;=R[bl]) mymax(mx,dp[i]-i/K*D);\nmt[i%K].Upd(bl,mx);\n}\n}\nll ans=0;\nforup(i,1,n){\n//      printf(\"%lld \",dp[i]);\nans^=(dp[i]+i);\n}\nprintf(\"%lld\",ans);\n}\n</code></pre>"},{"location":"solution/20230428C_ABC/","title":"20230428C","text":"<p>\u4f20\u9001\u95e8</p> <p>\u56e0\u4e3a\u9ed1\u6811\u8bf4\u6700\u597d\u4e0d\u8981\u653e\u51fa\u6765\u6211\u5c31\u628a\u642c\u8fd0\u5220\u6389\u4e86\u3002</p>"},{"location":"solution/20230428C_ABC/#t1","title":"T1 \u9898\u89e3","text":"<p>\u8fd9\u9053\u9898\u6211\u8d5b\u65f6\u90e8\u5206\u5206\u70b8\u6389\u4e86\uff0c\u6240\u4ee5\u6211\u4e0d\u4f1a\u90e8\u5206\u5206\u3002</p> <p>\u9996\u5148\u6211\u4eec\u53d1\u73b0 $f(n)$ \u975e\u5e38\u96be\u5904\u7406\uff0c\u6211\u4eec\u8003\u8651\u5bf9\u6bcf\u4e2a\u4e0d\u540c\u7684 $f(n)$ \u5206\u522b\u8ba1\u7b97\u3002</p> <p>\u5bb9\u6613\u53d1\u73b0\uff0c$f(n)=x$ \u7684 $n$ \u4e2d\uff0c\u4efb\u610f\u4e00\u4e2a\u6570\u90fd\u53ef\u4ee5\u8868\u793a\u4e3a $p\\cdot 2^x+c\\cdot x$\uff0c\u5176\u4e2d $p$ \u662f\u4e00\u4e2a\u5947\u6570\uff0c\u6240\u4ee5 $f=x$ \u7684\u7b2c $m$ \u4e2a\u6570\u5373\u53ef\u8868\u793a\u4e3a $(2m-1)\\cdot 2^x+c\\cdot x$\uff0c\u5316\u7b80\u4e00\u4e0b\u5c31\u662f $m\\cdot 2^{x+1}-2^x+c\\cdot x$\uff0c\u5bb9\u6613\u53d1\u73b0\u8fd9\u662f\u4e2a\u5173\u4e8e $m$ \u7684\u4e00\u6b21\u51fd\u6570\uff08\u7531\u4e8e\u662f\u79bb\u6563\u7684\u6240\u4ee5\u5176\u5b9e\u4e5f\u662f\u4e2a\u7b49\u5dee\u6570\u5217\uff09\u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u7b2c $k$ \u5927\u7684 $a$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $f$\uff0c\u6c42\u51fa\u6709\u51e0\u4e2a $a$ \u5927\u4e8e\u5b83\u3002\u5f97\u5230\u7b54\u6848\u540e\u7528\u7b49\u5dee\u6570\u5217\u6c42\u548c\u89e3\u51b3\uff0c\u590d\u6742\u5ea6 $O(\\log^2V)$\uff0c\u5176\u4e2d $V$ \u4e3a\u503c\u57df\u3002</p>"},{"location":"solution/20230428C_ABC/#code","title":"code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define ll long long\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(register ll i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register ll i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline ll read(){\nll x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst ll inf=0x3f3f3f3f;\nll t,l,r,k,c,rkr[35],rkl[35];\nll rk(ll x,ll i){\nreturn (x+(1&lt;&lt;i))&gt;&gt;(i+1);\n}\nll rkf(ll x,ll i){\nreturn rk(x-c*i,i);\n}\nll getf(ll x,ll i){\nreturn (x&lt;&lt;(i+1))-(1&lt;&lt;i)+c*i;\n}\nll get(ll x,ll i){\nreturn getf(rk(x,i),i);\n}\nbool chk(ll x){\nll cnt=0;\nforup(i,0,30){\nif(rkl[i]==0&amp;&amp;rkr[i]==0) break;\nif(rkl[i]==rkr[i]) continue;\nif(rkf(x,i)&lt;=rkr[i]&amp;&amp;rkf(x,i)&gt;rkl[i]){\ncnt+=rkr[i]-rkf(x,i);\nif(get(x-c*i,i)==x) cnt++;\n}else if(rkf(x,i)&lt;=rkl[i]){\ncnt+=rkr[i]-rkl[i];\n}else{\ncontinue;\n}\nif(cnt&lt;0) return false;\n}\nreturn cnt&gt;=k;\n}\nll calc(ll x){\nll res=0,cnt=0;\nforup(i,0,30){\nif(rkl[i]==0&amp;&amp;rkr[i]==0) break;\nif(rkl[i]==rkr[i]) continue;\nll cc;\nif(rkf(x,i)&lt;=rkr[i]&amp;&amp;rkf(x,i)&gt;rkl[i]){\ncc=rkr[i]-rkf(x,i);\nres+=(getf(rkf(x,i)+1,i)+getf(rkr[i],i))*cc/2;\n}else if(rkf(x,i)&lt;=rkl[i]){\ncc=rkr[i]-rkl[i];\nres+=(getf(rkl[i]+1,i)+getf(rkr[i],i))*cc/2;\n}else{\ncontinue;\n}\ncnt+=cc;\n}\nif(cnt&lt;k) res+=x*(k-cnt);\nreturn res;\n}\nsigned main(){\nt=read();\nwhile(t--){\nl=read();r=read();k=read();c=read();\nmem(rkr,0);mem(rkl,0);\nforup(i,0,30){\nrkr[i]=rk(r,i);\nrkl[i]=rk(l-1,i);\nif(rkr[i]&lt;=0) break;\n}\nll L=0,R=1e18,M;\nwhile(L&lt;R){\nM=(L+R+1)&gt;&gt;1;\nif(chk(M)) L=M;\nelse R=M-1;\n}\nprintf(\"%lld\\n\",calc(L));\n}\n}\n</code></pre>"},{"location":"solution/20230428C_ABC/#t2","title":"T2 \u9898\u89e3","text":"<p>\u56e0\u4e3a\u6211\u8d5b\u65f6\u5c31\u5207\u51fa\u6765\u4e86\u6240\u4ee5\u6211\u4e0d\u77e5\u9053\u90e8\u5206\u5206\u600e\u4e48\u5199\u3002</p> <p>\u7531\u4e8e\u4e09\u79cd\u624b\u52bf\u662f\u7b49\u4ef7\u7684\u6240\u4ee5\u53ea\u8bb2 $R$ \u7684\u60c5\u51b5\u3002</p> <p>\u9996\u5148\u5047\u8bbe\u4e0d\u5904\u7406\u95ee\u53f7\uff0c\u5373\u6bcf\u4e2a\u4eba\u7684\u624b\u52bf\u90fd\u662f\u5df2\u77e5\u7684\u3002</p> <p>\u5bb9\u6613\u60f3\u5230\uff0c\u4e24\u4e2a\u76f8\u90bb\u7684 $R$ \u4e4b\u95f4\u8981\u4e48\u6ca1\u6709\u5143\u7d20\uff0c\u8981\u4e48\u6709\u81f3\u5c11\u4e00\u4e2a $S$\uff0c\u5426\u5219\u5c31\u8981\u7528\u4e2d\u95f4\u7684\u4e00\u4e2a $P$ \u6253\u8d25\u5176\u4e2d\u4e00\u4e2a $R$ \u7136\u540e\u7528\u65c1\u8fb9\u7684\u53e6\u4e00\u4e2a\u533a\u95f4\u4e2d\u7684 $S$ \u6253\u8d25\u8fd9\u91cc\u9762\u7684 $P$\u3002</p> <p>\u8fd9\u662f\u4e00\u4e2a\u8d2a\u5fc3\u7684\u601d\u8def\uff0c\u901a\u4fd7\u70b9\u8bb2\uff0c\u6211\u4eec\u8981\u5c3d\u91cf\u4f7f\u5220\u9664\u7684 $R$ \u6700\u5c11\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u8ba9 $?$ \u53d8\u6210 $R$ \u6216 $S$\u3002</p> <p>\u8003\u8651\u4ece\u524d\u5411\u540e dp\uff0c$dp_{i,0/1}$ \u8868\u793a\u8003\u8651\u524d $i$ \u4f4d\uff0c\u524d\u9762\u8fd8\u6709\u6ca1\u6709\u672a\u5904\u7406\u7684 $P$ \u9700\u8981\u5728\u540e\u9762\u5904\u7406\uff0c\u6240\u80fd\u5269\u4e0b\u7684\u6700\u591a\u7684 $R$\u3002\u4f46\u662f\u8fd9\u4e2a\u505a\u6cd5\u8f6c\u79fb\u6709\u70b9\u590d\u6742\uff0c\u6211\u8bb2\u5b8c\u8fd9\u4e2a\u505a\u6cd5\u8d34\u4e00\u4e0b\u5b98\u65b9\u9898\u89e3\u3002</p> <ul> <li>\u5047\u5982 $s_i=R$\uff0c$dp_{i,1}=dp_{i-1,1},dp_{i,0}=dp_{i-1,0}+1$\u3002</li> </ul> <p>\u8fd9\u5f88\u597d\u7406\u89e3\uff0c\u5982\u679c\u524d\u9762\u6709\u672a\u5904\u7406\u7684 $P$\uff0c\u90a3\u4e48\u5728\u88ab\u5904\u7406\u524d\u4ed6\u5c06\u4f1a\u6740\u7a7f\uff0c\u6240\u4ee5\u4e2d\u95f4\u7684 $R$ \u90fd\u4e0d\u4f1a\u9020\u6210\u8d21\u732e\u3002</p> <ul> <li>\u5047\u5982 $s_i=P$\uff0c\u6211\u4eec\u8bbe $ns$ \u4e3a $1\\le j &lt; i$ \u4e2d\uff0c$s_j=S$ \u7684\u6700\u5927\u7684 $j$\uff08\u8fd9\u53ef\u4ee5\u5728\u626b\u5230\u5b83\u7684\u65f6\u5019\u5b58\u4e0b\u6765\uff09\uff0c$nq$ \u8868\u793a\u6700\u5927\u7684 $s_j=?$\uff0c\u5047\u5982\u8fd9\u4e24\u4e2a\u5747\u5b58\u5728\uff08\u5982\u679c\u4e0d\u5b58\u5728\u7279\u5224\u5373\u53ef\uff09\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a</li> </ul> <p>$$dp_{i,1}=\\max{dp_{i-1,0},dp_{i-1,1}}$$ $$dp_{i,0}=\\max{dp_{ns,0},dp_{nq-1,0},dp_{nq-1,1}}$$</p> <p>\u9996\u5148\uff0c\u7b2c\u4e8c\u7ef4\u4e3a $1$ \u7684\u5f88\u597d\u7406\u89e3\uff0c\u56e0\u4e3a\u65e0\u8bba\u524d\u9762\u6709\u6ca1\u6709 $P$ \u5230\u8fd9\u91cc\u603b\u5f52\u6709\u4e00\u4e2a\uff0c\u53d6\u8f83\u5927\u7684\u3002\u4e3a $0$ \u7684\u6bd4\u8f83\u590d\u6742\uff0c\u4e3a\u4e86\u4e0d\u7559\u540e\u60a3\uff0c\u9700\u8981\u4ece\u524d\u9762\u627e\u4e00\u4e2a\u80fd\u5904\u7406\u5b83\u7684\uff0c\u6211\u521a\u624d\u8bf4\u8fc7\uff0c\u8fd9\u662f\u4e2a\u8d2a\u5fc3\u7684\u8fc7\u7a0b\uff0c\u663e\u7136\u6211\u4eec\u627e\u6700\u9760\u540e\u7684 $?$ \u6216 $S$ \u6765\u5904\u7406\u4f1a\u6bd4\u8f83\u597d\uff0c\u7531\u4e8e $?$ \u6709\u53ef\u80fd\u5728\u8f6c\u79fb\u65f6\u63d0\u4f9b\u4e86\u8d21\u732e\uff0c\u6240\u4ee5\u8981\u4ece $nq-1$ \u8f6c\u79fb\u3002</p> <ul> <li>\u5047\u5982 $s_i=S$\uff0c\u90a3 $dp_{i,0}=\\max{dp_{i-1,0},dp_{i-1,1}},dp_{i,1}=-\\infty$\u3002</li> </ul> <p>\u663e\u7136\uff0c\u7531\u4e8e $S$ \u662f\u6709\u80fd\u529b\u5904\u7406 $P$ \u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ef\u4ee5\u76f4\u63a5\u53d6\u6700\u5927\u503c\uff0c\u4f46\u662f\u7531\u4e8e\u524d\u9762\u7684 $P$ \u5fc5\u5b9a\u88ab\u5904\u7406\u4e86\uff08\u7531\u4e8e\u8981\u6784\u9020\u6700\u4f18\u89e3\uff09\uff0c\u6240\u4ee5 $dp_{i,1}$ \u5c31\u4e0d\u5b58\u5728\u4e86\u3002</p> <ul> <li>\u5047\u5982 $s_i=?$\uff0c$dp_{i,0}=\\max{dp_{i-1,0}+1,dp_{i-1,1}},dp_{i,1}=-\\infty$\u3002</li> </ul> <p>\u5927\u4f53\u601d\u8def\u548c $S$ \u7684\u4e00\u6837\u5c31\u4e0d\u591a\u8d58\u8ff0\uff0c\u9700\u8981\u6ce8\u610f\u5982\u679c\u524d\u9762\u6ca1\u6709\u9700\u8981\u5904\u7406\u7684 $P$\uff0c\u90a3\u4e48 $?$ \u662f\u53ef\u4ee5\u505a\u51fa\u8d21\u732e\u7684\uff0c\u52a0\u4e2a\u4e00\u3002</p> <p>\u53e6\u5916\u5bb9\u6613\u53d1\u73b0\u6bcf\u6b21 $dp_{i}$ \u90fd\u662f\u4ece $dp_{i-1}$ \u6216\u8005 $ns,nq$ \u8f6c\u79fb\u8fc7\u6765\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a $i$ \u8fd9\u4e00\u7ef4\u538b\u6389\uff0c\u5377\u7a7a\u95f4\u548c\u957f\u5ea6\u6700\u4f18\u89e3\u3002</p>"},{"location":"solution/20230428C_ABC/#code_1","title":"code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(register int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register int i=(s);i&gt;=(e);i--)\nusing namespace std;\nconst int N=1e6+5,inf=0x3f3f3f3f;\nint n,a[N],nw[2];\nchar s[N];\nsigned main(){\nscanf(\" %s\",s+1);n=strlen(s+1);\nforup(i,1,n) a[i]=(s[i]=='R'?1:s[i]=='P'?2:s[i]=='S'?3:0);\nforup(i,1,3){\nint bt=i-1;\nif(!bt) bt=3;\nnw[0]=0;nw[1]=-inf; int nb=-inf,nq=-inf;\nforup(j,1,n){\nif(a[j]==i){\n++nw[0];\n}else if(a[j]==0){\nnq=max(nw[0],nw[1]);\nnw[0]=max(nw[0]+1,nw[1]);\nnw[1]=-inf; }else if(a[j]==bt){\nnw[0]=max(nw[0],nw[1]);\nnw[1]=-inf; nb=nw[0];\n}else{\nnw[1]=max(nw[1],nw[0]);\nnw[0]=(nq&lt;0&amp;&amp;nb&lt;0?-inf:max(nb,nq));\n}\n}\nprintf(\"%d\\n\",max(nw[0],0));\n}\n}\n</code></pre> <p>\u9644\u4ef6\uff1a\u5b98\u65b9\u9898\u89e3\u3002</p>"},{"location":"solution/20230428C_ABC/#t3","title":"T3 \u9898\u89e3","text":"<p>\u9996\u5148\u4e0d\u8003\u8651\u5220\u9664\u64cd\u4f5c\uff0c\u8fd9\u9053\u9898\u5e94\u8be5\u600e\u4e48\u505a\u3002</p> <p>\u5bb9\u6613\u53d1\u73b0\uff0c\u6bcf\u4e2a\u6570\u6700\u540e\u4e00\u6b21\u4fee\u6539\u4e3a $0$ \u4e4b\u524d\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u4e0d\u4f1a\u6709\u8d21\u732e\uff0c\u6240\u4ee5\u6bcf\u4e2a\u6570\u5bf9\u6700\u5927\u503c\u7684\u8d21\u732e\u5c31\u662f\u5b83\u6700\u540e\u4e00\u6b21\u4fee\u6539\u4e3a $0$ \u540e\uff0c\u6240\u6709\u64cd\u4f5c $2$ \u7684\u6700\u5927\u503c\u3002\u6362\u8a00\u4e4b\uff0c\u5373\u4e3a\u64cd\u4f5c\u961f\u5217\u7684\u540e\u7f00\u6700\u5927\u503c\u3002\u4f46\u662f\u6709\u4e9b\u6570\u4ece\u5934\u5230\u5c3e\u90fd\u6ca1\u6709\u88ab\u8d4b\u4e3a $0$ \u8fc7\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u518d\u5f00\u5934\u52a0 $2n$ \u4e2a\u64cd\u4f5c\u4ee3\u66ff\u6570\u7ec4\u7684\u521d\u59cb\u5316\u3002</p> <p>\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u7ef4\u62a4\u5220\u9664\u3002\u53d1\u73b0\u7ef4\u62a4\u5220\u9664\u975e\u5e38\u9ebb\u70e6\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5148\u52a0\u5165\u6240\u6709\u6ca1\u88ab\u5220\u9664\u8fc7\u7684\u64cd\u4f5c\uff0c\u7136\u540e\u6309\u5220\u9664\u7684\u5012\u5e8f\u52a0\u5165\u64cd\u4f5c\uff0c\u6bcf\u52a0\u5165\u4e00\u4e2a\u7edf\u8ba1\u7b54\u6848\uff0c\u8fd9\u5c31\u6bd4\u8f83\u597d\u5904\u7406\u3002</p> <p>\u8003\u8651\u53ea\u52a0\u64cd\u4f5c\u4e00\u7684\u60c5\u51b5\uff0c\u5bb9\u6613\u53d1\u73b0\u6bcf\u6b21\u589e\u52a0\u64cd\u4f5c\u4e00\u5176\u5b9e\u5c31\u662f\u628a\u5f53\u524d\u4f4d\u7f6e\u7684\u8d21\u732e\u6539\u4e3a\u53e6\u4e00\u4e2a\u4f4d\u7f6e\u7684\u540e\u7f00\u6700\u5927\u503c\uff0c\u8fd9\u542f\u53d1\u6211\u4eec\u7528\u67d0\u79cd\u65b9\u6cd5\u7ef4\u62a4\u540e\u7f00\u6700\u5927\u503c\u6765\u5904\u7406\u64cd\u4f5c $2$\u3002</p> <p>\u5bb9\u6613\u60f3\u5230\u5728\u64cd\u4f5c\u5e8f\u5217\u4e0a\u7ef4\u62a4\u4e00\u9897\u7ebf\u6bb5\u6811\uff0c\u7ef4\u62a4\u533a\u95f4\uff08\u64cd\u4f5c $2$ \u7684\uff09\u540e\u7f00\u6700\u5927\u503c\u6700\u5927\u503c\uff0c\u533a\u95f4\u64cd\u4f5c\u4e00\u7684\u6570\u91cf\uff08\u6700\u540e\u4ea7\u751f\u8d21\u732e\u7684\u90a3\u4e2a\uff09\uff0c\u533a\u95f4\u64cd\u4f5c\u4e00\u4f4d\u7f6e\u4e0a\u7684\u540e\u7f00\u6700\u5927\u503c\u4e4b\u548c\u3002\uff08\u9ed1\u4f53\u662f\u4e3a\u4e86\u5e2e\u52a9\u65ad\u53e5\uff09</p> <p>\u5bf9\u4e8e\u64cd\u4f5c\u4e8c\uff0c\u5047\u5982\u5f53\u524d\u8981\u589e\u52a0\u7684\u64cd\u4f5c\u4e3a <code>2 v</code>\uff0c\u7531\u4e8e\u540e\u7f00\u6700\u5927\u503c\u663e\u7136\u662f\u5355\u8c03\u4e0d\u589e\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u5728\u7ebf\u6bb5\u6811\u4e0a\u4e8c\u5206\u627e\u5230\u6700\u540e\u4e00\u4e2a\u5927\u4e8e $v$ \u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u5c06\u8fd9\u4e00\u6574\u6bb5\u7684\u540e\u7f00\u6700\u5927\u503c\u4fee\u6539\u4e3a $v$ \u5373\u53ef\u6ce8\u610f\u7ef4\u62a4\u5176\u4ed6\u53d8\u91cf\uff0c\u5177\u4f53\u770b\u4ee3\u7801\u3002</p> <p>\u64cd\u4f5c\u4e00\u5341\u5206\u7b80\u5355\uff0c\u5047\u5982\u6bd4\u539f\u6765\u4f4d\u7f6e\u9760\u524d\u5c31\u4e0d\u52a8\uff0c\u9760\u540e\u5c31\u5148\u51cf\u53bb\u539f\u6765\u7684\u518d\u52a0\u4e0a\u65b0\u7684\u5c31\u884c\u4e86\u3002</p> <p>\u590d\u6742\u5ea6\u5c31\u662f\u7ebf\u6bb5\u6811\u6a21\u677f\u7684\u590d\u6742\u5ea6\uff0c\u5b8c\u5168\u80fd\u8fc7\uff0c\u9700\u8981\u6ce8\u610f\u7a7a\u95f4\u8981\u5f00\u4e09\u500d\uff08\u56e0\u4e3a\u6700\u5f00\u59cb\u8981\u52a0 $2n$ \u4e2a\u64cd\u4f5c\uff09\u3002</p>"},{"location":"solution/20230428C_ABC/#code_2","title":"code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define ll long long\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(register ll i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(register ll i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline ll read(){\nll x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nusing pii=pair&lt;ll,ll&gt;;\nconst ll N=1e6+5;//\u6ce8\u610f\u5f00\u4e09\u500d\nll n,m,mm,q,vis[N],d[N],ans[N],gz[N];\npii a[N];\nstruct Node{\nll s,x;\n}op[N];\nstruct SegmentTree{\n#define mid ((l+r)&gt;&gt;1)\n#define lson l,mid,id&lt;&lt;1\n#define rson mid+1,r,id&lt;&lt;1|1\nprivate:\nll querymax[N&lt;&lt;2],mark[N&lt;&lt;2],querysum[N&lt;&lt;2],querycnt[N&lt;&lt;2];\nvoid PushUp(ll id){//\u4e0a\u4f20\u7684\u65f6\u5019\u76f4\u63a5\u9012\u5f52\u5408\u5e76\u5373\u53ef\nquerymax[id]=max(querymax[id&lt;&lt;1],querymax[id&lt;&lt;1|1]);\nquerysum[id]=querysum[id&lt;&lt;1]+querysum[id&lt;&lt;1|1];\nquerycnt[id]=querycnt[id&lt;&lt;1]+querycnt[id&lt;&lt;1|1];\n}\nvoid PushDown(ll id){\n//\u7531\u4e8e\u6574\u4e2a\u533a\u95f4\u90fd\u88ab\u4fee\u6539\u4e86\uff0c\n//\u6240\u4ee5querysum[id&lt;&lt;1|1]=querymax[id&lt;&lt;1|1]*querycnt[id&lt;&lt;1|1];\nmark[id&lt;&lt;1]=mark[id&lt;&lt;1|1]=mark[id];\nquerymax[id&lt;&lt;1]=querymax[id&lt;&lt;1|1]=mark[id];\nquerysum[id&lt;&lt;1]=querymax[id&lt;&lt;1]*querycnt[id&lt;&lt;1];\nquerysum[id&lt;&lt;1|1]=querymax[id&lt;&lt;1|1]*querycnt[id&lt;&lt;1|1];\nmark[id]=0;\n}\npublic:\nvoid Update(ll L,ll R,ll X,ll l=1,ll r=m,ll id=1){\n//\u533a\u95f4\u4fee\u6539\u4e3a\u67d0\u4e2a\u503c\nif(L&lt;=l&amp;&amp;r&lt;=R){\nquerymax[id]=X;\nquerysum[id]=querymax[id]*querycnt[id];\nmark[id]=X;\nreturn;\n}\nif(l&lt;r&amp;&amp;mark[id]!=0) PushDown(id);\nif(L&lt;=mid) Update(L,R,X,lson);\nif(mid&lt; R) Update(L,R,X,rson);\nPushUp(id);\n}\nvoid Add(ll P,ll X,ll l=1,ll r=m,ll id=1){\n//\u5355\u70b9\u52a0\u64cd\u4f5c 1\nif(l==r){\nquerycnt[id]=X;\nquerysum[id]=querymax[id]*querycnt[id];\nreturn;\n}\nif(l&lt;r&amp;&amp;mark[id]!=0) PushDown(id);\nif(P&lt;=mid) Add(P,X,lson);\nelse       Add(P,X,rson);\nPushUp(id);\n}\nll Search(ll X,ll l=1,ll r=m,ll id=1){\n//\u4e8c\u5206\u627e\u5de6\u8fb9\u754c\nif(l==r) return l;\nif(l&lt;r&amp;&amp;mark[id]!=0) PushDown(id);\nif(querymax[id&lt;&lt;1|1]&gt;X) return Search(X,rson);\nelse if(querymax[id&lt;&lt;1]&gt;X) return Search(X,lson);\nelse return 0;\n}\nll AskSum(){//\u6574\u4e2a\u6570\u7ec4\u7684\u548c\nreturn querysum[1];\n}\n}mt;\nbool cmp(pii a,pii b){\nreturn a.first&gt;b.first;\n}\nsigned main(){\nn=read();mm=read();q=read();\nforup(i,1,n){\na[i].first=read();a[i].second=i;\n}\nsort(a+1,a+n+1,cmp);\nforup(i,1,n){//\u6700\u5f00\u59cb\u52a0 2n \u4e2a\u64cd\u4f5c\u4ee3\u66ff\u6570\u7ec4\u521d\u59cb\u5316\nop[++m]=Node{1,a[i].second};\nop[++m]=Node{2,a[i].first};\n}\nforup(i,1,mm){\nop[++m].s=read();op[m].x=read();\n}\nforup(i,1,q){\nd[i]=read()+n*2;\nvis[d[i]]=1;\n}\nforup(i,1,m){\nif(!vis[i]){\nif(op[i].s==1){//\u5148\u5220\u518d\u52a0\nif(gz[op[i].x]!=0) mt.Add(gz[op[i].x],0);\ngz[op[i].x]=max(gz[op[i].x],i);\nmt.Add(gz[op[i].x],1);\n}else{\nll res=mt.Search(op[i].x);//\u5148\u67e5\u518d\u4fee\nif(res&lt;i){\nmt.Update(res+1,i,op[i].x);\n}\n}\n}\n}\nfordown(i,q,1){\n//\u6ce8\u610f\u7b54\u6848\u662f\u5220\u9664\u540e\u7684\uff0c\u8f6c\u6362\u8fc7\u6765\u5c31\u662f\u6dfb\u52a0\u524d\u7684\uff0c\u5148\u7edf\u8ba1\u518d\u64cd\u4f5c\nans[i]=mt.AskSum();\nif(op[d[i]].s==1){\nmt.Add(gz[op[d[i]].x],0);\ngz[op[d[i]].x]=max(gz[op[d[i]].x],d[i]);\nmt.Add(gz[op[d[i]].x],1);\n}else{\nll res=mt.Search(op[d[i]].x);\nif(res&lt;d[i]){\nmt.Update(res+1,d[i],op[d[i]].x);\n}\n}\n}\nforup(i,1,q){\nprintf(\"%lld\\n\",ans[i]);\n}\n}\n</code></pre>"},{"location":"solution/20230430C_ABCD/","title":"20230430C","text":""},{"location":"solution/20230430C_ABCD/#_1","title":"\u4e0d\u60f3\u642c\u4e86","text":"<p>\u4f20\u9001\u95e8</p>"},{"location":"solution/20230430C_ABCD/#t1","title":"T1 \u9898\u89e3","text":"<p>\u9898\u76ee\u8bf4\u6f0f\u4e86\uff0c\u4fdd\u8bc1\u6570\u7ec4\u6240\u6709\u6570\u90fd\u4e3a\u6b63\u6574\u6570\u3002</p> <p>\u601d\u8003\u4e00\u4e0b\uff0c\u9996\u5148\u6700\u5927\u7684\u5b50\u6bb5\u548c\u80af\u5b9a\u662f\u6574\u4e2a\u6570\u7ec4\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6\u4e3a $l$ \u7684\u5b50\u6bb5\uff0c\u5220\u9664\u4e24\u7aef\u5176\u4e2d\u00b7\u4e00\u4e2a\u6570\u5f97\u5230\u7684\u4e24\u4e2a\u957f\u5ea6\u4e3a $l-1$ \u7684\u5b50\u6bb5\u7684\u548c\u80af\u5b9a\u5c0f\u4e8e\u539f\u5148\u7684\u90a3\u4e2a\u5b50\u6bb5\uff08\u663e\u800c\u6613\u89c1\uff0c\u56e0\u4e3a\u90fd\u662f\u6b63\u6574\u6570\uff09\u3002</p> <p>\u5bb9\u6613\u60f3\u5230\u7528\u4e00\u4e2a\u5e73\u8861\u6811\uff08<code>set</code>\uff09\uff0c\u7ef4\u62a4\u5b50\u6bb5\u7684\u5de6\u53f3\u7aef\u70b9\uff08\u95ed\u533a\u95f4\uff09\u548c\u5b50\u6bb5\u548c\uff0c\u6309\u5b50\u6bb5\u548c\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\uff0c\u5de6\u53f3\u7aef\u70b9\u4e3a\u7b2c\u4e8c\u3001\u7b2c\u4e09\u5173\u952e\u5b57\u6392\u5e8f\u3002\u6700\u521d\u538b\u5165\u6574\u4e2a\u6570\u7ec4\uff08\u5373\u6700\u5927\u7684\u5b50\u6bb5\uff09\uff0c\u6bcf\u6b21\u53d6\u51fa\u5806\u9876\u7684\u6570\u540e\u518d\u628a\u5220\u9664\u4e24\u7aef\u5f97\u5230\u7684\u65b0\u5b50\u6bb5\u5206\u522b\u538b\u5165\u3002\u6bcf\u6b21\u538b\u5165\u65f6\u4f1a\u53bb\u91cd\u6240\u4ee5\u4e0d\u7528\u62c5\u5fc3\u91cd\u590d\u7684\u95ee\u9898\u3002\u8fd9\u6837\u505a\u5fc5\u7136\u4f1a\u5148\u627e\u5230\u8f83\u5927\u7684\u5b50\u6bb5\u540e\u518d\u627e\u5230\u8f83\u5c0f\u7684\uff0c\u539f\u56e0\u4e0a\u9762\u5df2\u7ecf\u8bc1\u4e86\u3002</p>"},{"location":"solution/20230430C_ABCD/#code","title":"code","text":"<pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;string.h&gt;\n#define ll long long\n#define mem(a,b) memset(a,b,sizeof(a))\n#include&lt;vector&gt;\n#include&lt;set&gt;\n#define pbk(a) emplace_back(a) \n#define forup(i,s,e) for(ll i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(ll i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline ll read(){\nll x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst ll N=1e5+5,inf=0x3f3f3f3f;\nll n,k,a[N],sum;\nstruct Node{\nll l,r,val;\nbool operator &lt;(const Node &amp;p)const{\nif(val!=p.val) return val&gt;p.val;\nif(l!=p.l) return l&lt;p.l;\nreturn r&lt;p.r;\n}\n};\nset&lt;Node&gt; q;\nsigned main(){\nn=read();k=read();\nforup(i,1,n){\na[i]=read();sum+=a[i];\n}\nq.insert(Node{1,n,sum});\nforup(i,1,k){\nset&lt;Node&gt;::iterator it=q.begin();\nll val=it-&gt;val,l=it-&gt;l,r=it-&gt;r;\nq.erase(it);\nprintf(\"%lld \",val);\nif(l&lt;r){\nq.insert(Node{l+1,r,val-a[l]});\nq.insert(Node{l,r-1,val-a[r]});\n}\n}\n}\n</code></pre>"},{"location":"solution/20230430C_ABCD/#t2","title":"T2 \u9898\u89e3","text":"<p>\u5f88\u663e\u7136\u8fd9\u662f\u4e00\u9053\u6811\u5f62 dp\u3002</p> <p>\u8bbe $dp_{u,i}$ \u8868\u793a\u8003\u8651\u4ee5\u70b9 $u$ \u4e3a\u6839\u7684\u5b50\u6811\uff0c\u70b9 $u$ \u53d6 $i$ \u7684\u65b9\u6848\u6570\uff0c\u6709\u4e00\u4e2a\u663e\u7136\u7684\u8f6c\u79fb\u65b9\u7a0b\u3002</p> <p>$$dp_{u,i}=\\prod\\limits_{v \\in children(u)}(\\sum\\limits_{1 \\le j\\le m,\\left|j-i\\right|\\ge k}dp_{v,j})$$</p> <p>\u6211\u4eec\u76f4\u63a5 $O(nm^2)$ \u5957\u8fd9\u4e2a\u65b9\u7a0b\u53ef\u4ee5\u5f97 $20pts$.</p> <p>\u6ce8\u610f\u5230\u5408\u6cd5\u7684 $j$ \u662f\u8fde\u7eed\u7684\u4e24\u6bb5\uff0c\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u590d\u6742\u5ea6\u53d8\u4e3a $O(nm)$ \u5c31\u53ef\u4ee5\u5f97 $40pts$\u3002</p> <p>\u5047\u5982\u6211\u4eec\u6253\u4e2a\u8868\uff0c\u5bb9\u6613\u53d1\u73b0\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u7ed3\u70b9 $u$\uff0c\u6709\u4e24\u4e2a\u6027\u8d28\uff1a</p> <ul> <li>$dp_1=dp_m,dp_2=dp_{m-1}\\dots$\uff08\u5373 dp \u503c\u662f\u5bf9\u79f0\u7684\uff09</li> <li>dp \u503c\u7684\u4e2d\u95f4\u6709\u4e00\u6bb5\u662f\u76f8\u7b49\u7684\u3002</li> </ul> <p>\u8fd9\u975e\u5e38\u597d\u7406\u89e3\uff0c\u9996\u5148\u5bf9\u79f0\u6027\u5f88\u663e\u7136\uff0c\u56e0\u4e3a\u5177\u4f53\u5927\u5c0f\u4e0d\u5f71\u54cd dp \u503c\uff0c\u53ea\u6709\u4e0e\u4e0a\u4e0b\u754c\u7684\u8ddd\u79bb\u5f71\u54cd\u3002\u7ed3\u8bba\u4e8c\u56e0\u4e3a\u53f6\u5b50\u7ed3\u70b9\u7684 dp \u503c\u5168\u4e3a $1$\uff0c\u6240\u4ee5\u53f6\u5b50\u7ed3\u70b9\u7684\u7236\u4eb2\u9664\u53bb\u5f00\u5934 $k$ \u4e2a\u548c\u672b\u5c3e $k$ \u4e2a\u4ee5\u5916\u5176\u4ed6\u503c\u90fd\u662f\u76f8\u7b49\u7684\uff0c\u518d\u5f80\u4e0a\u4e00\u5c42\u9664\u53bb\u5f00\u5934 $2k$ \u4e2a\u548c\u672b\u5c3e $2k$ \u4e2a\u90fd\u662f\u76f8\u7b49\u7684\uff0c\u540c\u7406\u53ef\u4ee5\u63a8\u5230\u6839\u8282\u70b9\u3002</p> <p>\u901a\u8fc7\u8fd9\u4e2a\u8bc1\u660e\uff0c\u5bb9\u6613\u53d1\u73b0\u53e6\u4e00\u4e2a\u6027\u8d28\uff1a</p> <ul> <li>dp \u503c\u81f3\u591a\u5f00\u5934\u548c\u7ed3\u5c3e\u5206\u522b\u6709 $k\\cdot(n-1)$ \u4e2a\u4e0e\u4e2d\u95f4\u4e0d\u76f8\u7b49\u3002</li> </ul> <p>\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53ea\u5b58\u5f00\u5934 $k\\cdot(n-1)$ \u4e2a\u503c\uff0c\u4e2d\u95f4\u53ea\u7528\u5b58\u4e00\u4e2a\uff0c\u8f6c\u79fb\u4e5f\u53ea\u7b97\u8fd9 $k \\cdot (n-1)+1$ \u4e2a\u503c\uff0c\u590d\u6742\u5ea6 $O(n^2k)$\u3002</p> <p>\u53e6\u5916\u6211\u5c0f\u6570\u636e\u7528\u66b4\u529b\u8fc7\u7684\uff0c\u56e0\u4e3a\u6211\u4e0d\u77e5\u9053\u600e\u4e48\u628a\u8fd9\u4e2a\u7ed3\u8bba\u7528\u5728\u6570\u636e\u8f83\u5c0f\uff08\u6307 $m &lt; k\\cdot(n-1)$\uff09\u7684\u60c5\u51b5\u3002</p>"},{"location":"solution/20230430C_ABCD/#code_1","title":"code\uff08\u6bd4\u8f83\u5c4e\u5c71\uff09","text":"<pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;string.h&gt;\n#define ll long long\n#define mem(a,b) memset(a,b,sizeof(a))\n#include&lt;vector&gt;\n#define pbk(a) emplace_back(a) \n#define forup(i,s,e) for(ll i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(ll i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline ll read(){\nll x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst ll N=105,M=1e5+5,mod=1e9+7;\nll t,n,m,k,len;\nvector&lt;ll&gt; e[N];\nll dp[N][M],pre[N][M];\nvoid dfs(ll x,ll fa){\nforup(i,1,len){\ndp[x][i]=1;\n}\nfor(auto v:e[x]){\nif(v==fa) continue;\ndfs(v,x);\nforup(i,1,len){\nint res=0;\nif(i&gt;k){\nres=(res+pre[v][i-k])%mod;\n}\nif(i+k&lt;=m){\nint bk=m-(i+k-1);\nif(k==0) bk--;\nif(bk&lt;=len){\nres=(res+pre[v][bk])%mod;\n}else if(i+k&lt;=len){\nres=(res+(pre[v][len-1]+mod-pre[v][i+k-1])%mod)%mod;\nres=(res+pre[v][len-1])%mod;\nres=(res+dp[v][len]*(m-len*2+2)%mod)%mod;\n}else{\nres=(res+pre[v][len])%mod;\nres=(res+dp[v][len]*(bk-len)%mod)%mod;\n}\n}\ndp[x][i]=dp[x][i]*res%mod;\n}\n}\nforup(i,1,len){\npre[x][i]=(pre[x][i-1]+dp[x][i])%mod;\n}\n}\nvoid dfs1(int x,int fa){\nforup(i,1,m){\ndp[x][i]=1;\n}\nfor(auto i:e[x]){\nif(i==fa) continue;\ndfs1(i,x);\nforup(j,1,m){\nll res=0;\nif(j&gt;=k){\nres=(res+pre[i][j-k])%mod;\n}if(j+k&lt;=m){\nif(k!=0){\nres=(res+pre[i][m]+mod-pre[i][j+k-1])%mod;\n}else{\nres=(res+pre[i][m]+mod-pre[i][j+k])%mod;\n}\n}\ndp[x][j]=(dp[x][j]*res)%mod;\n}\n}\nforup(i,1,m){\npre[x][i]=(pre[x][i-1]+dp[x][i])%mod;\n}\n}\nsigned main(){\nt=read();\nwhile(t--){\nn=read();m=read();k=read();\nmem(dp,0);mem(pre,0);\nforup(i,1,n){\ne[i].clear();\n}\nforup(i,1,n-1){\nll u=read(),v=read();\ne[u].push_back(v);e[v].push_back(u);\n}\nif(m&gt;10000){\nlen=min((m+1)/2,(n-1)*k+1);\ndfs(1,0);\nprintf(\"%lld\\n\",(pre[1][len-1]*2%mod+dp[1][len]*(m-len*2+2)%mod)%mod);          }else{\ndfs1(1,0);\nprintf(\"%lld\\n\",pre[1][m]);\n}\n}\n}\n</code></pre>"},{"location":"solution/20230430C_ABCD/#t3","title":"T3 \u9898\u89e3","text":"<p>\u8fd9\u9053\u9898\u7ed9\u4e86\u5f88\u591a\u90e8\u5206\u5206\uff0c\u6bcf\u4e2a\u90e8\u5206\u5206\u90fd\u6709\u5bf9\u5e94\u7684\u505a\u6cd5\uff0c\u4f46\u662f\u6211\u53ea\u8bb2\u6b63\u89e3\u3002</p> <p>\u9996\u5148\u6211\u4eec\u5f88\u597d\u6c42\u4ee5\u6bcf\u4e2a\u70b9\u4e3a\u53f3\u4e0b\u89d2\u7684\u6700\u5927\u7684\u6b63\u65b9\u5f62\u3002</p> <p>\u505a\u6cd5\u662f\u8fd9\u6837\u7684\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u4ee5\u70b9 $(i,j)$ \u4e3a\u53f3\u4e0b\u89d2\u7684\u6b63\u65b9\u5f62\u7684\u6700\u5927\u53ef\u80fd\u8fb9\u957f\uff0c\u6613\u5f97 dp \u5f0f\u5b50\uff1a</p> <p>$$\\forall a_{i,j}=0,f_{i,j}=0$$ $$\\forall a_{i,j}=1,f_{i,j}=\\min{f_{i-1,j},f_{i,j-1},f_{i-1,j-1}}+1$$</p> <p>\u8fd9\u4e2a\u5f0f\u5b50\u5f88\u663e\u7136\u5c31\u4e0d\u8bf4\u4e86\uff0c\u9884\u5904\u7406\u590d\u6742\u5ea6 $O(n^2)$\u3002</p> <p>\u7136\u540e\u8003\u8651\u5982\u4f55\u6c42\u7b54\u6848\u3002\u53d1\u73b0\u53ef\u4ee5\u4e8c\u5206\u7b54\u6848\uff0c\u5047\u5982\u5728 $(x_1,y_1)(x_2,y_2)$ \u4e4b\u95f4\u7b54\u6848\u4e3a $r$\uff0c\u90a3\u4e48\u5fc5\u5b9a $\\exists(i,j),x_1+r \\le i \\le x_2,y_1+r \\le j \\le y_2,f_{i,j} \\ge r$\u3002\u8fd9\u662f\u663e\u7136\u7684\uff0c\u56e0\u4e3a\u9996\u5148\u5fc5\u987b\u8981\u6709\u4e00\u4e2a $f \\ge r$\uff0c\u5176\u6b21\u5047\u5982\u8fd9\u4e2a\u70b9\u592a\u9760\u8fb9\u90a3\u6b63\u65b9\u5f62\u5c31\u4e0d\u5b8c\u5168\u5728\u8be2\u95ee\u77e9\u9635\u5185\u4e86\u3002</p> <p>\u4f46\u662f\u8fd9\u6837\u7684\u590d\u6742\u5ea6 $O(n^2 \\log n)$ \u663e\u7136\u8fc7\u4e0d\u4e86\uff0c\u6ce8\u610f\u5230\u6211\u4eec\u53ea\u9700\u8981\u67e5\u8be2\u77e9\u9635\u5185\u6700\u5927\u7684 $f$\uff0c\u8fd9\u662f\u4e00\u4e2a\u4e8c\u7ef4 $rmq$\uff0c\u53ef\u4ee5 $O(n^2\\log^2n)$ \u9884\u5904\u7406\uff0c$O(1)$ \u67e5\u8be2\u3002</p> <p>\u6545\u603b\u590d\u6742\u5ea6\u4e3a $O(n^2+n^2\\log^2n+T)$\uff0c\u6ce8\u610f\u5e38\u6570\u4f18\u5316\u3002</p>"},{"location":"solution/20230430C_ABCD/#code_2","title":"code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(int i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst int N=1005,LN=15,inf=0x3f3f3f3f;\nint n,m,a[N][N],f[N][N],qq;\nint lg[N];\nstruct ST{\nint g[LN][LN][N][N];\nvoid init(){\nforup(i,1,n){\nforup(j,1,m){\ng[0][0][i][j]=f[i][j];\n}\n}\nfor(int ln=0;(1&lt;&lt;ln)&lt;=n;++ln){\nint nn=max(ln-1,0),sn=1&lt;&lt;nn;\nif(ln==0) sn=0;\nfor(int lm=0;(1&lt;&lt;lm)&lt;=m;++lm){\nint nm=max(lm-1,0),sm=1&lt;&lt;nm;\nif(lm==0) sm=0;\nif(lm==0&amp;&amp;ln==0) continue;\nforup(i,1,min(n,n-sn*2+1)){\nforup(j,1,min(m,m-sm*2+1)){\ng[ln][lm][i][j]=max({g[nn][nm][i][j],g[nn][nm][i+sn][j],g[nn][nm][i][j+sm],g[nn][nm][i+sn][j+sm]});\n}\n}\n}\n}\n}\nint ask(int x1,int y1,int x2,int y2){\nint ln=lg[x2-x1+1],lm=lg[y2-y1+1],sn=1&lt;&lt;ln,sm=1&lt;&lt;lm;\nreturn max({g[ln][lm][x1][y1],g[ln][lm][x2-sn+1][y1],g[ln][lm][x1][y2-sm+1],g[ln][lm][x2-sn+1][y2-sm+1]});\n}\n}mst;\nsigned main(){\nn=read(),m=read();\nforup(i,2,max(n,m)){\nlg[i]=lg[i&gt;&gt;1]+1;\n}\nforup(i,1,n){\nforup(j,1,m){\na[i][j]=read();\nif(a[i][j]==0) f[i][j]=0;\nelse f[i][j]=min({f[i-1][j],f[i][j-1],f[i-1][j-1]})+1;\n}\n}\nmst.init();\nqq=read();\nforup(i,1,qq){\nint x1=read(),y1=read(),x2=read(),y2=read();\nint ll=0,rr=min(x2-x1+1,y2-y1+1),mm;\nwhile(ll&lt;rr){\nmm=(ll+rr+1)&gt;&gt;1;\nif(mst.ask(x1+mm-1,y1+mm-1,x2,y2)&gt;=mm) ll=mm;\nelse rr=mm-1;\n}\nprintf(\"%d\\n\",ll);\n}\n}\n</code></pre>"},{"location":"solution/20230430C_ABCD/#t4","title":"T4 \u9898\u89e3","text":"<p>\u8fd9\u9898\u4e0d\u96be\u3002</p> <p>\u9996\u5148\uff0c\u8fd9\u6761\u6700\u77ed\u8def\u4e00\u5b9a\u662f\u4ee5\u67d0\u4e2a\u7279\u6b8a\u57ce\u5e02\u5f00\u59cb\uff0c\u4ee5\u67d0\u4e2a\u7279\u6b8a\u57ce\u5e02\u7ed3\u675f\u7684\uff0c\u4e0d\u7136\u5b83\u5fc5\u5b9a\u4e0d\u4f18\u3002\u5bb9\u6613\u5f97\u5230 $40pts$ \u505a\u6cd5\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7279\u6b8a\u57ce\u5e02\u8dd1\u4e00\u904d dijkstra\uff0c\u9664\u4e86\u8ddd\u79bb\u5916\uff0c\u8bbe $dp_{i,j}$ \u8868\u793a $i$ \u5230 $j$ \u7684\u6700\u77ed\u8def\u81f3\u591a\u7ecf\u8fc7\u591a\u5c11\u4e2a\u7279\u6b8a\u57ce\u5e02\uff0c\u6700\u540e\u7edf\u8ba1 $dp_{i,j}=k$ \u7684\u6700\u5c0f\u8ddd\u79bb\u5373\u53ef\u3002\u590d\u6742\u5ea6 $O(n^2\\log n)$\uff08\u5806\u4f18\u5316\uff09\u3002</p> <p>\u8003\u8651\u80fd\u5426\u5feb\u901f\u627e\u5230\u6b63\u89e3\u7684\u8d77\u59cb\u70b9\uff0c\u53d1\u73b0\u5047\u5982\u6211\u4eec\u5bf9\u4efb\u610f\u4e00\u4e2a\u7279\u6b8a\u70b9\u8dd1 dijkstra\uff0c\u8ddd\u79bb\u5b83\u6700\u8fdc\u7684\u70b9\u5373\u4e3a\u4e00\u4e2a\u53ef\u884c\u7684\u8d77\u70b9\uff0c\u56e0\u4e3a\u5982\u679c\u4ece\u5176\u5b83\u70b9\u5f00\u59cb\u5c31\u8981\u5f80\u90a3\u8fb9\u7ed5\u4e00\u5708\uff0c\u90a3\u5fc5\u5b9a\u4e0d\u4f18\uff08\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff09\uff0c\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$\u3002</p>"},{"location":"solution/20230430C_ABCD/#code_3","title":"code","text":"<pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;string.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#include&lt;queue&gt;\n#include&lt;vector&gt;\n#define pbk(a) emplace_back(a) \n#define forup(i,s,e) for(int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(int i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst int N=1e5+5,inf=0x3f3f3f3f;\nint n,m,K,a[N];\nstruct edge{\nint v,w;\n};\nvector&lt;edge&gt; e[N];\nstruct Node{\nint dis,u;\nbool operator &lt;(const Node &amp;p)const{return dis&gt;p.dis;}\n};\nint dist[N],vis[N],dp[N],nece[N];\npriority_queue&lt;Node&gt; q;\nvoid dij(int rt){\nwhile(q.size()) q.pop();\nmem(vis,0);mem(dist,0x3f);\nmem(dp,0);\ndist[rt]=0;\nq.push(Node{0,rt});\nwhile(q.size()){\nint u=q.top().u;q.pop();\nif(vis[u]) continue;\nvis[u]=1;\nif(nece[u]) dp[u]++;\nfor(auto i:e[u]){\nint v=i.v,w=i.w;\nif(dist[v]&gt;=dist[u]+w){\ndist[v]=dist[u]+w;\nq.push(Node{dist[v],v});\ndp[v]=max(dp[v],dp[u]);\n}\n}\n}\n}\nsigned main(){\nn=read();m=read();\nforup(i,1,m){\nint u=read(),v=read(),w=read();\ne[u].push_back(edge{v,w});\ne[v].push_back(edge{u,w});\n}\nK=read();\nforup(i,1,K){\na[i]=read();\nnece[a[i]]=1;\n}\ndij(a[1]);\nint mmm=1;\nforup(i,1,K){\nif(dist[a[i]]&gt;dist[a[mmm]]) mmm=i;\n}\ndij(a[mmm]);\nint ans=inf; forup(i,1,K){\nif(dp[a[i]]==K) ans=min(ans,dist[a[i]]);\n}\nprintf(\"%d\",ans);\n}\n</code></pre>"},{"location":"solution/20230524C_D/","title":"20230524C \u6570\u6570\u9898","text":"<p>TMD \u8fd9\u9053\u9898\u592a\u6076\u5fc3\u4e86\u6211\u4e00\u5b9a\u8981\u5199\u7bc7\u9898\u89e3\uff0c\u53e6\u5916\u8fd9\u9053\u9898\u5b98\u65b9\u9898\u89e3\u6709\u9519\u3002</p> <p>\u4f20\u9001\u95e8</p> <p>update 2023/6/29 </p> <p>\u4fee\u6539\u4e86\u4e00\u4e9b\u7b14\u8bef\u3002</p> <p></p> <p>\u611f\u8c22 kk \u7684\u5efa\u8bae\u3002</p>"},{"location":"solution/20230524C_D/#_1","title":"\u5206\u6790","text":"<p>\u6211\u4eec\u5728\u5904\u7406\u6811\u4e0a\u94fe\u957f\u5ea6\u65f6\uff0c\u901a\u5e38\u4f1a\u8f6c\u5316\u4e3a\u6811\u4e0a\u524d\u7f00\u548c\uff0c\u6240\u4ee5\u8fd9\u9053\u9898\u7684\u8be2\u95ee\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a $dpt_u+dpt_v- 2dpt_{\\operatorname{lca}(u,v)}$ \u7684\u671f\u671b\uff0c\u5176\u4e2d $dpt_i$ \u8868\u793a\u70b9 $i$ \u4e0e\u6839\u8282\u70b9\uff08\u70b9 $1$\uff09\u7684\u8ddd\u79bb\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a\u95ee\u9898\u5206\u4e3a\u51e0\u4e2a\u90e8\u5206\u89e3\u51b3\u4e86\u3002</p>"},{"location":"solution/20230524C_D/#x","title":"\u5982\u4f55\u6c42\u7ed3\u70b9 $x$ \u7684\u671f\u671b\u6df1\u5ea6","text":"<p>\u5047\u5982\u6211\u4eec\u60f3\u77e5\u9053\u70b9 $x$ \u7684\u6df1\u5ea6\uff0c\u90a3\u6211\u4eec\u80af\u5b9a\u8981\u77e5\u9053\u5b83\u548c\u70b9 $1$ \u4e4b\u95f4\u8def\u5f84\u4e0a\u6240\u6709\u8fb9\u7684\u8fb9\u6743\uff0c\u7531\u4e8e\u8fd9\u9053\u9898\u8fb9\u6743\u53ea\u548c\u7ed3\u70b9\u6709\u5173\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u77e5\u9053\u70b9 $x$ \u5230\u70b9 $1$ \u4e4b\u95f4\u5177\u4f53\u6709\u54ea\u4e9b\u70b9\u5373\u53ef\u3002\u8bbe\u8fd9\u4e9b\u70b9\uff08\u5305\u62ec $1$ \u548c $x$\uff09\u7ec4\u6210\u7684\u96c6\u5408\u4e3a $S'$\uff0c\u6613\u5f97\u51fa\u73b0\u60c5\u51b5 $S'$ \u7684\u6982\u7387\u4e3a\uff1a</p> <p>$$\\prod\\limits_{i=1}^{\\left|S'\\right|-1}\\dfrac{a_{S_{i+1}'}}{\\sum_{j=1}^{S_i'-1}a_j}$$</p> <p>\u5176\u4e2d $S_i'$ \u8868\u793a\u96c6\u5408 $S'$ \u4e2d\u7b2c $i$ \u5927\u6570\u3002\u8fd9\u4e2a\u5f0f\u5b50\u5f88\u597d\u7406\u89e3\uff0c\u56e0\u4e3a\u6240\u6709\u70b9\u662f\u4ece\u5927\u5230\u5c0f\u987a\u6b21\u8fde\u63a5\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8ba1\u7b97\u51fa\u6bcf\u4e2a\u70b9\u8fde\u5411\u524d\u4e00\u4e2a\u70b9\u7684\u6982\u7387\u6c42\u79ef\u5373\u53ef\u3002</p> <p>\u5bb9\u6613\u53d1\u73b0\u4e0a\u5f0f\u7684\u5206\u6bcd\u662f\u4e00\u6bb5\u524d\u7f00\u548c\uff0c\u4ee4 $b_i=\\sum\\limits_{j=1}^ia_i$\uff0c\u4e0a\u5f0f\u53ef\u8f6c\u5316\u4e3a\uff1a</p> <p>$$\\prod\\limits_{i=1}^{\\left|S'\\right|-1}\\dfrac{a_{S_{i+1}'}}{b_{S_i'-1}}$$</p> <p>\u6211\u4eec\u53d1\u73b0\u9664\u4e86 $S_1'$ \u548c $S_{\\left|S'\\right|}'$ \u4ee5\u5916 $S$ \u4e2d\u6240\u6709\u5143\u7d20\u90fd\u4ee5 $a_i$ \u548c $\\frac{1}{b_{i-1}}$ \u7684\u4e24\u79cd\u5f62\u5f0f\u5206\u522b\u51fa\u73b0\u8fc7\u4e00\u6b21\uff0c\u800c $S_1'=x,S_{\\left|S'\\right|}'=1$\uff0c\u6545\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e24\u9879\u63d0\u51fa\u6765\uff0c\u628a\u5176\u4f59\u7684\u6570\u653e\u5728\u4e00\u4e2a\u96c6\u5408 $S$ \u91cc\uff08\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u6211\u6700\u5f00\u59cb\u8981\u7528 $S'$\uff09\uff0c\u7136\u540e\u5206\u5b50\u5206\u6bcd\u91cd\u65b0\u914d\u5bf9\uff0c\u53ef\u4ee5\u628a\u4e0a\u5f0f\u8f6c\u5316\u6210\u8fd9\u6837\uff1a</p> <p>$$\\dfrac{a_1}{b_{x-1}}\\prod\\limits_{i\\in S}\\dfrac{a_{i}}{b_{i-1}}$$</p> <p>\u8fd9\u5c31\u975e\u5e38\u4f18\u96c5\u4e86\u3002\u7136\u540e\u6211\u4eec\u8003\u8651\u7528\u6982\u7387\u4e58\u4ee5\u6743\u503c\uff08\u5373\u8def\u5f84\u957f\u5ea6\uff09\u7b97\u671f\u671b\uff0c\u8def\u5f84\u957f\u5ea6\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u53ef\u4ee5\u5316\u6210\u8fd9\u6837\u7684\u5f62\u5f0f\uff1a</p> <p>$$c_1+c_x+\\sum\\limits_{i\\in S}2c_i$$</p> <p>\u7136\u540e\u76f8\u4e58\uff1a</p> <p>$$\\dfrac{a_1}{b_{x-1}}\\prod\\limits_{i\\in S}\\dfrac{a_{i}}{b_{i-1}}\\times \\left(c_1+c_x+\\sum\\limits_{i\\in S}2c_i\\right)$$</p> <p>\u7136\u540e\u6211\u4eec\u5728\u5916\u5c42\u679a\u4e3e\u96c6\u5408 $S$\uff0c\u5bb9\u6613\u53d1\u73b0 $S\\subseteq(1,x)$\uff0c\u6211\u4eec\u679a\u4e3e\u6240\u6709\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\u7684 $S$ \u5c31\u80fd\u5f97\u5230 $x$ \u6df1\u5ea6\u7684\u671f\u671b\u4e3a\uff1a</p> <p>$$\\sum\\limits_{S \\subseteq (1,x)}\\left[\\dfrac{a_1}{b_{x-1}}\\prod\\limits_{i\\in S}\\dfrac{a_{i}}{b_{i-1}}\\times \\left(c_1+c_x+\\sum\\limits_{i\\in S}2c_i\\right)\\right]$$</p> <p>\u5bb9\u6613\u53d1\u73b0 $c_1+c_x$ \u5728\u6bcf\u4e2a $S$ \u4e2d\u90fd\u51fa\u73b0\u4e86\uff0c\u5b83\u4eec\u4ea7\u751f\u8d21\u732e\u7684\u6982\u7387\u4e3a $1$\uff0c\u5bf9\u671f\u671b\u7684\u8d21\u732e\u5c31\u662f\u5b83\u4eec\u81ea\u5df1\uff0c\u76f4\u63a5\u63d0\u51fa\u6765\uff0c$\\frac{a_1}{b_x}$ \u548c $2$ \u4e5f\u5728\u6bcf\u4e2a $S$ \u4e2d\u90fd\u51fa\u73b0\u4e86\uff0c\u7528\u4e58\u6cd5\u5206\u914d\u5f8b\u63d0\u51fa\u6765\uff1a</p> <p>$$c_1+c_x+2\\cdot\\dfrac{a_1}{b_{x-1}}\\sum\\limits_{S \\subseteq (1,x)}\\left(\\prod\\limits_{i\\in S}\\dfrac{a_{i}}{b_{i-1}}\\times \\sum\\limits_{i\\in S}c_i\\right)$$</p> <p>\u770b\u5230 $\\prod$ \u548c $\\sum$ \u76f8\u4e58\u7684\u5f62\u5f0f\uff0c\u8003\u8651\u628a $\\prod$ \u4e58\u5230 $\\sum$ \u91cc\u9762\u53bb\uff1a</p> <p>$$c_1+c_x+2\\cdot\\dfrac{a_1}{b_{x-1}}\\sum\\limits_{S \\subseteq (1,x)}\\left[\\sum\\limits_{i\\in S}\\left(c_i \\times \\prod\\limits_{j\\in S}\\dfrac{a_{j}}{b_{j-1}}\\right)\\right]$$</p> <p>\u63a5\u4e0b\u6765\u8fd9\u4e00\u6b65\u4e5f\u662f\u4e2a\u5957\u8def\uff0c\u6211\u4eec\u628a\u5b83\u653e\u5230\u4e00\u4e2a\u66f4\u4e00\u822c\u7684\u60c5\u51b5\u91cc\uff08\u4ee5\u4e0b\u53d8\u91cf\u540d\u4e0e\u672c\u9898\u65e0\u5173\uff09\u3002</p> <ul> <li>\u6211\u662f\u5206\u5272\u7ebf\uff08markdown \u7684\u5206\u5272\u7ebf\u5728\u900f\u660e\u80cc\u666f\u4e0b\u51e0\u4e4e\u770b\u4e0d\u5230\uff0c\u5c06\u5c31\u4e00\u4e0b\uff09</li> </ul> <p>\u5047\u5982\u6211\u4eec\u8981\u7b97\u4e0b\u9762\u8fd9\u4e2a\u5f0f\u5b50\uff1a</p> <p>$$\\sum\\limits_{s\\subseteq S}\\prod\\limits_{i\\in s}w_i$$</p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u4e00\u4e2a\u5728 $S$ \u4e2d\u7684 $i$ \u8981\u4e48\u5728 $s$ \u4e2d\uff0c\u8981\u4e48\u4e0d\u5728 $s$ \u4e2d\uff0c\u5047\u5982\u5b83\u5728 $s$ \u4e2d\u5b83\u5c31\u4f1a\u4f7f\u7ed3\u679c\u4e58\u4ee5 $w_i$\uff0c\u5047\u5982\u5b83\u4e0d\u5728\u5c31\u4f1a\u4f7f\u7ed3\u679c\u4e58\u4ee5 $1$\uff0c\u6240\u4ee5\u5047\u5982\u6211\u4eec\u628a\u4e0a\u5f0f\u5c55\u5f00\u5b83\u5927\u6982\u5c31\u957f\u8fd9\u6837\uff08\u5047\u8bbe $S$ \u4e2d\u7684\u5143\u7d20\u662f $1,2\\dots n$\uff09\uff1a</p> <p>$$(w_1w_2\\dots w_n)+(1w_2w_3\\dots w_n)+(w_11w_3\\dots w_n)+(1\\times1w_3\\dots w_n)\\dots$$</p> <p>\u6211\u4eec\u5bf9\u5b83\u56e0\u5f0f\u5206\u89e3\uff0c\u5177\u4f53\u65b9\u6cd5\u53ef\u4ee5\u548c\u5206\u89e3\u8fd9\u4e2a\u5f0f\u5b50 $ac+bc+ad+bd$ \u4e00\u6837\uff0c\u63d0\u4e24\u6b21\u516c\u56e0\u5f0f\uff0c\u53ea\u4e0d\u8fc7\u4e0a\u5f0f\u8981\u63d0 $n$ \u6b21\u516c\u56e0\u5f0f\uff1a</p> <p>$$(w_1+1)(w_2+1)(w_3+1)\\dots(w_n+1)$$</p> <p>\u5199\u6210 $\\prod$ \u7684\u5f62\u5f0f\u957f\u8fd9\u6837\uff1a</p> <p>$$\\prod\\limits_{i\\in S}(w_i+1)$$</p> <ul> <li>\u6211\u662f\u5206\u5272\u7ebf</li> </ul> <p>\u56de\u5230\u672c\u9898\uff0c\u5229\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u6211\u4eec\u53ef\u4ee5\u628a\u4e0a\u5f0f\u8f6c\u5316\u6210\u8fd9\u6837\uff1a</p> <p>$$c_1+c_x+2\\cdot\\dfrac{a_1}{b_{x-1}}\\sum\\limits_{i=2}^{x-1}\\left(\\dfrac{c_ia_i}{b_{i-1}} \\times \\prod\\limits_{j=2,j\\ne i}^{x-1}\\dfrac{a_{j}+b_{j-1}}{b_{j-1}}\\right)$$</p> <p>\u7531\u4e8e\u542b\u6709 $i$ \u7684\u96c6\u5408\u4e2d $\\frac{a_i}{b_{i-1}}$ \u5fc5\u987b\u9009\uff0c\u6240\u4ee5\u8981\u62ff\u51fa\u6765\u5355\u72ec\u8003\u8651\u3002\u4f46\u662f\u8fd9\u6837\u5f88\u4e0d\u4f18\u96c5\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u4e58\u5728\u91cc\u9762\u518d\u9664\u51fa\u6765\uff1a</p> <p>$$c_1+c_x+2\\cdot\\dfrac{a_1}{b_{x-1}}\\sum\\limits_{i=2}^{x-1}\\left(\\dfrac{c_ia_i}{b_{i-1}} \\times \\dfrac{b_{i-1}}{a_i+b_{i-1}}\\prod\\limits_{j=2}^{x-1}\\dfrac{a_{j}+b_{j-1}}{b_{j-1}}\\right)$$</p> <p>\u6ce8\u610f\u5230 $b$ \u662f $a$ \u7684\u524d\u7f00\u548c\uff0c\u6240\u4ee5 $a_j+b_{j-1}=b_j$\uff0c\u6709\uff1a</p> <p>$$c_1+c_x+2\\cdot\\dfrac{a_1}{b_{x-1}}\\sum\\limits_{i=2}^{x-1}\\left(\\dfrac{c_ia_i}{b_{i-1}} \\times \\dfrac{b_{i-1}}{b_{i}}\\prod\\limits_{j=2}^{x-1}\\dfrac{b_{j}}{b_{j-1}}\\right)$$</p> <p>\u53d1\u73b0\u5185\u5c42\u7684 $\\prod$ \u4e5f\u53ef\u4ee5\u628a\u5206\u5b50\u5206\u6bcd\u7684 $b_j$ \u914d\u5bf9\uff0c\u7136\u540e\u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u7ea6\u5206\uff1a</p> <p>$$c_1+c_x+2\\cdot\\dfrac{a_1}{b_{x-1}}\\sum\\limits_{i=2}^{x-1}\\left(\\dfrac{c_ia_i}{b_{i}}\\times\\dfrac{b_{x-1}}{b_1}\\right)$$</p> <p>\u53ef\u4ee5\u628a\u91cc\u9762\u7684 $\\frac{b_{x-1}}{b_1}$ \u63d0\u51fa\u6765\uff0c\u53c8\u53d1\u73b0 $b_1=a_1$\uff0c\u53ef\u5f97\uff1a</p> <p>$$c_1+c_x+2\\sum\\limits_{i=2}^{x-1}\\dfrac{c_ia_i}{b_{i}}$$</p> <p>\u8fd9\u6837\u4e00\u4e2a\u5de8\u7b80\u77ed\u7684\u5f0f\u5b50\uff0c\u53ea\u8981\u9884\u5904\u7406 $\\dfrac{c_ia_i}{b_{i}}$ \u4ece $2$ \u5f00\u59cb\u7684\u524d\u7f00\u548c\u5c31\u53ef\u4ee5 $O(1)$ \u6c42\u3002</p> <p>\u4ee5\u9632\u6709\u4eba\u4e0d\u60f3\u770b\u8fc7\u7a0b\u6211\u628a\u7ed3\u8bba\u653e\u5728\u8fd9\u91cc\uff1a</p> <p>$$\\boxed{E(dpt_x)=c_1+c_x+2\\sum\\limits_{i=2}^{x-1}\\dfrac{c_ia_i}{b_{i}}}$$</p>"},{"location":"solution/20230524C_D/#operatornamelca","title":"\u5982\u4f55\u5904\u7406 $\\operatorname{lca}$ \u7684\u671f\u671b","text":"<p>\u8fd8\u8bb0\u5f97\u6211\u4eec\u7684\u76ee\u6807\u5f0f\u5b50\u5417\uff1f</p> <p>$$dpt_u+dpt_v- 2dpt_{\\operatorname{lca}(u,v)}$$</p> <p>\u5b83\u7684\u671f\u671b\u53ef\u4ee5\u8868\u8fbe\u6210\u8fd9\u6837\uff1a</p> <p>$$E(dpt_u)+E(dpt_v)-2\\sum\\limits_{l=1}^{u}E(dpt_{l})P(l)$$</p> <p>\u8fd9\u4e2a\u5f0f\u5b50\u7684\u524d\u63d0\u662f $uv$ \u4ea4\u6362\u5373\u53ef\uff0c$u=v$ \u7684\u8bdd\u4f60\u8fd8\u7b97\u4ec0\u4e48\uff0c\u76f4\u63a5\u8f93\u51fa $0$\uff09\uff0c\u5176\u4e2d $P(l)$ \u8868\u793a $l=\\operatorname{lca}(u,v)$ \u7684\u6982\u7387\u3002\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5206\u4e3a $l=u$ \u548c $l \\ne v$ \u7684\u60c5\u51b5\u5206\u522b\u8ba1\u7b97\u3002 <p>\u81f3\u4e8e\u4e3a\u4ec0\u4e48 $dpt_{\\operatorname{lca}(u,v)}=\\sum_{l=1}^{u}E(dpt_l)P(l)$ \u8fd9\u8981\u8003\u8651\u5230\u6811\u7684\u751f\u6210\u65b9\u5f0f\uff0c\u5bb9\u6613\u53d1\u73b0\u67d0\u4e2a\u70b9 $i$ \u7684\u7236\u4eb2\u662f\u8c01\u4e0e $1\\sim i$ \u5177\u4f53\u5982\u4f55\u6784\u9020\u65e0\u5173\uff0c\u53ea\u4e0e $a_1\\sim a_{i-1}$ \u7684\u503c\u6709\u5173\uff0c\u628a\u8fd9\u4e2a\u7ed3\u8bba\u5177\u4f53\u5230\u95ee\u9898\u4e0a\uff0c\u5bb9\u6613\u53d1\u73b0 $E(dpt_l)$ \u53ea\u4e0e $a_1\\sim a_{l-1}$ \u7684\u503c\u6709\u5173\uff0c$P(l)$ \u53ea\u4e0e $a_l\\sim a_{v}$ \u7684\u503c\u6709\u5173\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u8fd9\u662f\u4e24\u4e2a\u4e92\u76f8\u72ec\u7acb\u7684\u4e8b\u4ef6\uff0c\u9002\u7528\u671f\u671b\u7684\u53ef\u4e58\u6027\u3002</p> <ul> <li>$l \\ne u$</li> </ul> <p>\u53d1\u73b0 $l$ \u662f $\\operatorname{lca}(u,v)$ \u5f53\u4e14\u4ec5\u5f53 $l$ \u662f $u$ \u7684\u7956\u5148\u4e14 $l$ \u662f $v$ \u7684\u7956\u5148\u5e76\u4e14\u8def\u5f84 $ul$ \u548c $vl$ \u4e2d\u65e0\u91cd\u590d\u7684\u70b9\u3002\u90a3\u4e48 $l$ \u662f $\\operatorname{lca}(u,v)$ \u7684\u6982\u7387\u5c31\u662f\u8fd9\u4e09\u4e2a\u4e8b\u4ef6\u7684\u6982\u7387\u76f8\u4e58\uff0c\u6211\u4eec\u8003\u8651\u7c7b\u4f3c\u4e8e\u521a\u624d\u7684\u65b9\u6cd5\uff0c\u679a\u4e3e $ul$ \u548c $vl$ \u8def\u5f84\u4e0a\u70b9\u7684\u96c6\u5408\u6ee1\u8db3\u987a\u6b21\u4e3a\u4e0b\u4e00\u4e2a\u7684\u7236\u4eb2\u7684\u6982\u7387\u6c42\u89e3\uff0c\u540c\u6837\u4e0d\u5305\u62ec\u7aef\u70b9\u3002</p> <p>$ul$ \u7684\u8def\u5f84\uff08\u8df3\u4e86\u4e00\u70b9\u6b65\u9aa4\uff0c\u5e94\u8be5\u80fd\u770b\u61c2\uff0c\u548c\u524d\u6587\u7684\u8f6c\u5316\u5dee\u4e0d\u591a\uff09\uff1a</p> <p>$$\\dfrac{a_l}{b_{u-1}}\\sum\\limits_{A\\subseteq (l,u)}\\prod\\limits_{i\\in A}\\dfrac{a_i}{b_{i-1}}$$</p> <p>$vl$ \u7684\u8def\u5f84\uff08\u540c\u4e0a\uff09\uff1a</p> <p>$$\\dfrac{a_l}{b_{v-1}}\\sum\\limits_{B\\subseteq ((l,u)\\setminus A)\\cup(u,v)}\\prod\\limits_{i\\in S}\\dfrac{a_i}{b_{i-1}}$$</p> <p>\u8003\u8651\u628a\u8fd9\u4e24\u4e2a\u5f0f\u5b50\u5408\u5e76\u8d77\u6765\uff0c\u5bb9\u6613\u53d1\u73b0 $B$ \u548c $A$ \u6709\u4e00\u90e8\u5206\u7684\u8303\u56f4\u662f\u76f8\u540c\u7684\uff08\u90fd\u662f $(l,u)$\uff09\uff0c\u7531\u4e8e $A$ \u548c $B$ \u663e\u7136\u662f\u6ca1\u6709\u4ea4\u7684\uff08\u4ece\u5f0f\u5b50\u7684\u610f\u4e49\u548c\u5b83\u672c\u8eab\u90fd\u80fd\u770b\u51fa\u6765\uff09\uff0c\u6211\u4eec\u8003\u8651\u628a\u8fd9\u4e00\u90e8\u5206\u5e76\u8d77\u6765\uff0c\u548c\u5269\u4e0b\u7684\uff08$(u,v)$ \u8fd9\u4e00\u90e8\u5206\uff09\u5206\u5f00\u8003\u8651\uff08\u8df3\u4e86\u4e00\u4e9b\u6b65\u9aa4\uff0c\u5e94\u8be5\u80fd\u770b\u61c2\uff09\uff1a</p> <p>$$\\dfrac{a_l^2}{b_{u-1}b_{v-1}}\\sum\\limits_{S_1\\subseteq(l,u)}2^{\\left|S_1\\right|}\\sum\\limits_{S_2\\subseteq(u,v)}\\prod\\limits_{i\\in S_1}\\dfrac{a_i}{b_{i-1}}\\prod\\limits_{j\\in S_2}\\dfrac{a_j}{b_{j-1}}$$</p> <p>\u5176\u4e2d $2^{\\left|S_1\\right|}$ \u8868\u793a $S_1$ \u4e2d\u7684\u5143\u7d20\u5177\u4f53\u5206\u7ed9 $A$ \u8fd8\u662f\u5206\u7ed9 $B$\u3002</p> <p>\u4e3a\u4ec0\u4e48\u4e0d\u540c\u7684\u5206\u914d\u65b9\u6cd5\u53ef\u4ee5\u5957\u540c\u4e00\u4e2a\u5f0f\u5b50\u5462\uff1f\u56de\u987e\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u662f\u7528\u6700\u521d\u7684\u5f0f\u5b50\u5206\u5b50\u5206\u6bcd\u9519\u5f00\u91cd\u65b0\u914d\u5bf9\u5f97\u5230\u7684\uff0c\u800c $S_1$ \u4e2d\u7684\u5143\u7d20\u5728\u6240\u6709\u60c5\u51b5\u4e0b\u5747\u4ee5 $a_i$ \u548c $\\frac{1}{b_{i-1}}$ \u7684\u5f62\u5f0f\u5404\u51fa\u73b0\u8fc7\u4e00\u6b21\uff08\u81ea\u5df1\u63a8\u4e00\u63a8\uff0c\u53ef\u4ee5\u753b\u4e00\u753b\u56fe\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e0d\u7ba1\u539f\u5f0f\u957f\u5565\u6837\uff0c\u9519\u5f00\u540e\u90fd\u80fd\u5199\u6210\u4e00\u6837\u7684\u5f62\u5f0f\u3002</p> <p>\u7136\u540e\u4e3a\u4e86\u65b9\u4fbf\u8ba1\u7b97\uff0c\u628a $2$ \u5206\u914d\u7ed9\u7b2c\u4e00\u4e2a $\\prod$\uff1a</p> <p>$$\\dfrac{a_l^2}{b_{u-1}b_{v-1}}\\sum\\limits_{S_1\\subseteq(l,u)}\\sum\\limits_{S_2\\subseteq(u,v)}\\prod\\limits_{i\\in S_1}\\dfrac{2a_i}{b_{i-1}}\\prod\\limits_{j\\in S_2}\\dfrac{a_j}{b_{j-1}}$$</p> <p>\u7136\u540e\u6211\u4eec\u628a\u4e24\u4e2a $\\sum$ \u5206\u522b\u5206\u7ed9\u4e24\u4e2a $\\prod$\uff1a</p> <p>$$\\dfrac{a_l^2}{b_{u-1}b_{v-1}}\\sum\\limits_{S_1\\subseteq(l,u)}\\prod\\limits_{i\\in S_1}\\dfrac{2a_i}{b_{i-1}}\\sum\\limits_{S_2\\subseteq(u,v)}\\prod\\limits_{j\\in S_2}\\dfrac{a_j}{b_{j-1}}$$</p> <p>\u7528\u4e4b\u524d\u8bb2\u8fc7\u7684\u5957\u8def\u5316\u7b80\uff1a</p> <p>$$\\dfrac{a_l^2}{b_{u-1}b_{v-1}}\\prod\\limits_{i=l+1}^{u-1}\\dfrac{2a_i+b_{i-1}}{b_{i-1}}\\prod\\limits_{j=u+1}^{v-1}\\dfrac{a_j+b_{j-1}}{b_{j-1}}$$</p> <p>\u628a $a_j+b_{j-1}$ \u6362\u6210 $b_j$\uff08\u4e2d\u95f4\u90a3\u5768\u56e0\u4e3a\u6362\u4e0d\u6362\u8026\u5408\u5ea6\u4e00\u6837\u5c31\u4e0d\u7ba1\u5b83\u4e86\uff09\uff1a</p> <p>$$\\dfrac{a_l^2}{b_{u-1}b_{v-1}}\\prod\\limits_{i=l+1}^{u-1}\\dfrac{2a_i+b_{i-1}}{b_{i-1}}\\prod\\limits_{j=u+1}^{v-1}\\dfrac{b_{j}}{b_{j-1}}$$</p> <p>\u5bf9\u7b2c\u4e8c\u4e2a $\\prod$ \u7ea6\u5206\uff1a</p> <p>$$\\dfrac{a_l^2}{b_{u-1}b_{v-1}}\\prod\\limits_{i=l+1}^{u-1}\\dfrac{2a_i+b_{i-1}}{b_{i-1}}\\cdot\\dfrac{b_{v-1}}{b_{u}}$$</p> <p>\u518d\u7ea6\uff1a</p> <p>$$\\dfrac{a_l^2}{b_{u-1}b_{u}}\\prod\\limits_{i=l+1}^{u-1}\\dfrac{2a_i+b_{i-1}}{b_{i-1}}$$</p> <p>\u540e\u9762\u8fd9\u90e8\u5206\u5df2\u7ecf\u53ef\u4ee5\u7528\u524d\u7f00\u79ef\u5904\u7406\u4e86\uff0c\u8bbe $d_i=\\prod\\limits_{j=2}^{i}\\frac{2a_i+b_{i-1}}{b_{i-1}}$\uff1a</p> <p>$$\\dfrac{a_l^2}{b_{u-1}b_{u}}\\cdot \\dfrac{d_{u-1}}{d_l}$$</p> <p>\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u53ea\u4e0e $u$ \u548c $l$ \u6709\u5173\u7684\u5f0f\u5b50\uff0c\u6211\u4eec\u628a\u5b83\u539f\u5f0f\u91cc\u4e0e $l$ \u6709\u5173\u7684\u90e8\u5206\u62ff\u8fc7\u6765\uff08\u6ce8\u610f\u8fd9\u662f $l \\ne u$ \u7684\u60c5\u51b5\uff09\uff1a</p> <p>$$\\sum\\limits_{l=1}^{u-1}\\dfrac{a_l^2}{b_{u-1}b_{u}}\\cdot \\dfrac{d_{u-1}}{d_l}\\cdot E(dpt_l)$$</p> <p>\u628a $u$ \u548c $l$ \u5206\u5f00\uff1a</p> <p>$$\\dfrac{d_{u-1}}{b_{u-1}b_u}\\sum\\limits_{l=1}^{u-1}\\dfrac{a_l^2}{d_l}\\cdot E(dpt_l)$$</p> <p>\u540e\u9762\u8fd9\u4e2a $\\sum$ \u7684\u9650\u5236\u91cc\u9762\u7684 $u$ \u63d0\u4e0d\u51fa\u6765\uff0c\u4f46\u8fd9\u4e2a\u90e8\u5206\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u7ef4\u62a4\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u4f18\u96c5\u5730\u5904\u7406\u5b8c\u4e86\u8fd9\u4e2a\u5b50\u95ee\u9898\u3002</p> <p>\u540c\u6837\u7684\uff0c\u6211\u628a\u7b54\u6848\u653e\u5728\u8fd9\u91cc\uff1a</p> <p>$$\\boxed{\\sum\\limits_{l=1}^{u}E(dpt_{l})P(l)=\\dfrac{d_{u-1}}{b_{u-1}b_u}\\sum\\limits_{l=1}^{u-1}\\dfrac{a_l^2}{d_l}\\cdot E(dpt_l)}$$</p> <ul> <li>$l=u$</li> </ul> <p></p> <p>\u548c\u4e0a\u4e2a\u60c5\u51b5\u51e0\u4e4e\u4e00\u6837\uff0c\u751a\u81f3\u66f4\u7b80\u5355\uff0c\u81ea\u5df1\u63a8\u4e00\u4e0b\u3002</p> <p>\u76f4\u63a5\u653e\u7b54\u6848\uff08\u4e00\u5b9a\u8981\u81ea\u5df1\u63a8\u4e00\u4e0b\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff09\uff1a</p> <p>$$\\boxed{P(u)=\\dfrac{a_u}{b_u}}$$</p>"},{"location":"solution/20230524C_D/#_2","title":"\u603b\u7ed3","text":"<p>\u7b54\u6848\u957f\u8fd9\u6837\uff1a</p> <p>$$\\boxed{c_1+c_u+2\\sum\\limits_{i=2}^{u-1}\\dfrac{c_ia_i}{b_{i}}+c_1+c_v+2\\sum\\limits_{i=2}^{v-1}\\dfrac{c_ia_i}{b_{i}}-2\\dfrac{d_{u-1}}{b_{u-1}b_u}\\sum\\limits_{l=1}^{u-1}\\dfrac{a_l^2}{d_l}\\cdot \\left(c_1+c_l+2\\sum\\limits_{i=2}^{l-1}\\dfrac{c_ia_i}{b_{i}}\\right)-2\\dfrac{a_u}{b_u}\\cdot\\left(c_1+c_u+2\\sum\\limits_{i=2}^{u-1}\\dfrac{c_ia_i}{b_{i}}\\right)}$$</p> <p>\u5f88\u7b54\u8fa9\u5bf9\u5427\uff0c\u4f46\u5047\u5982\u6211\u628a $E(dpt_i)$ \u5c01\u88c5\u6210\u51fd\u6570 $dpt(i)$\uff0c\u7528 $f$ \u8868\u793a $\\frac{a_l^2}{d_l}\\cdot E(dpt_l)$ \u7684\u524d\u7f00\u548c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u53ef\u4ee5\u4f18\u96c5\u5730\u5199\u6210\u8fd9\u6837\uff1a</p> <p>$$\\boxed{dpt(u)+dpt(v)-2\\dfrac{d_{u-1}}{b_{u-1}b_u}\\cdot f_{u-1}-2\\dfrac{a_u}{a_v}\\cdot dpt(u)}$$</p> <p>\u5bb9\u6613\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u53ea\u548c $u,v$ \u6709\u5173\uff0c\u7b97\u4e0a\u9006\u5143\u53ef\u4ee5 $O(\\log mod)$ \u6c42\uff0c\u5176\u4e2d $mod$ \u4e3a\u6a21\u6570\u3002</p> <p>\u9884\u5904\u7406\u5404\u79cd\u524d\u7f00\u548c\u662f $O(n\\log mod)$ \u7684\uff0c\u8c8c\u4f3c\u6bcf\u6b21 $\\frac{1}{b}$ \u90fd\u7528\u5feb\u901f\u5e42\u8fc7\u4e0d\u4e86\uff0c\u53ef\u4ee5\u5148\u9884\u5904\u7406\u5b58\u8d77\u6765\uff0c\u8fd9\u6837\u8be2\u95ee\u5c31\u53d8\u6210 $O(1)$ \u7684\u4e86\u3002</p> <p>\u53e6\u5916\u6709\u4e00\u4e2a $O(n+\\log mod)$ \u6c42\u4e00\u4e2a\u5e8f\u5217\u6240\u6709\u6570\u5206\u522b\u7684\u9006\u5143\u7684\u5c0f trick\uff0c\u4f46\u662f\u8fd9\u9053\u9898\u5982\u679c\u4f60\u4e0d\u5377\u6700\u4f18\u89e3\u6ca1\u5fc5\u8981\u5199\uff0c\u6211\u5c31\u6ca1\u5199\u3002</p> <p>\u6ce8\u610f\u53d6\u6a21\u3002\u53e6\u5916\u5b98\u65b9\u9898\u89e3\u9519\u5728\u5b8c\u5168\u6ca1\u63d0 $l=u$ \u7684\u60c5\u51b5\u3002</p>"},{"location":"solution/20230524C_D/#code","title":"code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(i64 i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(i64 i=(s);i&gt;=(e);i--)\nusing namespace std;\nusing i64=long long;\n#define gc getchar()\ninline i64 read(){\ni64 x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst i64 N=1e6+5,inf=0x3f3f3f3f,mod=1e9+7;\ni64 n,q,a[N],b[N],c[N],sum1[N],mult[N],sum2[N],invb[N];\ni64 ksm(i64 a,i64 b){\ni64 c=1;\nwhile(b){\nif(b&amp;1) c=a*c%mod;\na=a*a%mod;\nb&gt;&gt;=1;\n}\nreturn c;\n}\ni64 inv(i64 a){return ksm(a,mod-2);}\ni64 dpt(i64 x){return x!=1?(c[1]+c[x]+2*sum1[x-1]%mod)%mod:0;}\nsigned main(){\nn=read();q=read();\nforup(i,1,n-1){\na[i]=read();\nb[i]=b[i-1]+a[i];\ninvb[i]=inv(b[i]);\n}\nforup(i,1,n){\nc[i]=read();\n}\nforup(i,2,n){\nsum1[i]=(sum1[i-1]+c[i]*a[i]%mod*invb[i]%mod)%mod;\n}\nmult[1]=1;\nforup(i,2,n){\nmult[i]=mult[i-1]*(a[i]*2%mod+b[i-1])%mod*invb[i-1]%mod;\n}\nforup(i,1,n){\nsum2[i]=(sum2[i-1]+dpt(i)*a[i]%mod*a[i]%mod*inv(mult[i])%mod)%mod;\n}\nforup(i,1,q){\ni64 x=read(),y=read();\nif(x==y){\nputs(\"0\");\ncontinue;\n}\nif(x&gt;y) swap(x,y);\nprintf(\"%lld\\n\",(dpt(x)+dpt(y)+mod-2*mult[x-1]%mod*invb[x-1]%mod*invb[x]%mod*sum2[x-1]%mod+mod-2*dpt(x)%mod*a[x]%mod*invb[x]%mod)%mod);\n}\n}\n</code></pre>"},{"location":"solution/20230617C_C/","title":"20230617C \u6811","text":""},{"location":"solution/20230617C_C/#_1","title":"\u95f2\u626f","text":"<p>\u597d\u5de7\u4e0d\u5de7\u4eca\u5929 B \u7ec4 C \u9898\u4e5f\u53eb\u6811\u3002</p> <p>\u519b\u8bad\u56de\u6765\u590d\u5065\u529b\u3002</p> <p>\u4f20\u9001\u95e8</p>"},{"location":"solution/20230617C_C/#_2","title":"\u9898\u89e3","text":"<p>\u7531\u4e8e\u76f4\u5f84\u6ca1\u6709\u4ec0\u4e48\u597d\u7684\u6027\u8d28\uff0c\u6211\u4eec\u8003\u8651\u628a\u76f4\u5f84\u62c6\u6210\u4e24\u6bb5\u957f\u5ea6\u76f8\u7b49\u7684\u534a\u5f84\u5904\u7406\u3002</p> <p>\u53c8\u7531\u4e8e\u76f4\u5f84\u7684\u4e2d\u70b9\u53ef\u80fd\u5728\u67d0\u6761\u8fb9\u4e0a\uff0c\u6211\u4eec\u5728\u6bcf\u6761\u8fb9\u4e0a\u52a0\u4e00\u4e2a\u70b9\uff0c\u6bd4\u5982\u539f\u5148 $(u,v)$ \u95f4\u6709\u4e00\u6761\u8fb9\uff0c\u6211\u4eec\u5728\u5176\u4e2d\u52a0\u4e00\u4e2a\u70b9 $e$ \u53d8\u6210 $(u,e),(e,v)$ \u4e24\u6761\u8fb9\u3002\u8fd9\u6837\u76f4\u5f84\u7684\u4e2d\u70b9\u5c31\u4e00\u5b9a\u5728\u4e00\u4e2a\u70b9\u4e0a\u4e86\u3002</p> <p>\u4f46\u8fd9\u6837\u8ba1\u7b97\u76f4\u5f84\u5c31\u8981\u9664\u4ee5\u4e8c\uff08\u534a\u5f84\uff09\uff0c\u4e3a\u9632\u6b62\u51fa\u9519\u6211\u4eec\u5c06\u6bcf\u6b21\u8fb9\u6743 $+1$ \u53d8\u6210 $+2$\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u6709\u95ee\u9898\u4e86\u3002</p> <p>\u8003\u8651\u628a\u6240\u6709\u8fb9\u6743\u90fd\u52a0\u5728\u53f6\u5b50\u7ed3\u70b9\u5230\u7236\u4eb2\u7684\u8fb9\u4e0a\uff0c\u5bb9\u6613\u53d1\u73b0\u8fd9\u6837\u80af\u5b9a\u662f\u4e0d\u52a3\u7684\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5148\u505a\u4e00\u904d\u6811\u5f62 DP\uff0c\u6c42\u51fa\u6bcf\u4e2a\u975e\u53f6\u7ed3\u70b9\u5230\u53f6\u5b50\u7ed3\u70b9\u7684\u6700\u8fdc\u8ddd\u79bb $r_i$\uff0c\u6bcf\u4e2a\u975e\u53f6\u8282\u70b9\u5230\u53f6\u5b50\u7ed3\u70b9\u7684\u8ddd\u79bb\u548c $s_i$\uff0c\u53e6\u5916\u8fd8\u8981\u7edf\u8ba1\u53f6\u5b50\u7ed3\u70b9\u7684\u4e2a\u6570 $c$\u3002\u9700\u8981\u6ce8\u610f\uff0c\u4e3a\u65b9\u4fbf DP\uff0c\u8fd9\u91cc\u9ed8\u8ba4\u6839\u8282\u70b9\u5ea6\u6570\u4e0d\u4e3a $1$\uff0c\u5982\u679c\u662f $1$ \u5c31\u6362\u4e00\u4e2a\u3002</p> <p>\u7136\u540e\u5982\u4f55\u7ef4\u62a4\u6211\u4eec\u6ca1\u770b\u61c2\u9898\u89e3\uff0c@\u674e\u81f3\u64ce \u7ed9\u6211\u4eec\u8bb2\u4e86\u4ed6\u7684\u505a\u6cd5\u3002</p> <p>\u8003\u8651\u5047\u5982\u786e\u5b9a\u4e2d\u5fc3\u70b9\u540e\uff0c\u4e00\u4e2a $K$ \u8981\u52a0\u5230\u6811\u4e0a\u6709\u51e0\u79cd\u60c5\u51b5\u3002</p> <ol> <li>\u80fd\u628a\u534a\u5f84\u8865\u9f50\uff0c\u4e14\u80fd\u4f7f\u5f97\u6240\u6709\u53f6\u5b50\u7ed3\u70b9\u5230\u8be5\u7ed3\u70b9\u7684\u8ddd\u79bb\u5c0f\u4e8e\u7b49\u4e8e\u534a\u5f84\uff0c\u6b64\u65f6 $K \\le \\frac{r_i \\times c - s_i}{2}$\uff0c\u76f4\u5f84\u957f\u5ea6\u4e3a $r_i$\uff08\u6ce8\u610f\u76f8\u5bf9\u4e8e\u539f\u56fe\u662f\u4e58\u4ee5\u4e8c\u7684\uff09\u3002</li> <li>\u6839\u672c\u4e0d\u591f\u628a\u53e6\u5916\u4e00\u6761\u8fb9\u8865\u5f97\u548c\u534a\u5f84\u4e00\u6837\u957f\uff0c\u5bb9\u6613\u53d1\u73b0\u8fd9\u79cd\u60c5\u51b5\u5fc5\u7136\u5b58\u5728\u53e6\u4e00\u4e2a\u4e2d\u5fc3\u70b9\u6ee1\u8db3\u60c5\u51b5 $1$\uff0c\u76f4\u63a5\u4e0d\u8003\u8651\u3002</li> <li>\u80fd\u8865\u9f50\u7684\u60c5\u51b5\u4e0b\u8fd8\u591a\uff0c\u6b64\u65f6\u6700\u4f18\u7b56\u7565\u663e\u7136\u662f\u628a\u591a\u7684\u5e73\u5747\u5206\u7ed9\u53f6\u5b50\u7ed3\u70b9\uff0c\u5047\u5982\u8fd9\u79cd\u60c5\u51b5\u4e0b\u76f4\u5f84\u7b49\u4e8e $r_i+2x$\uff0c\u90a3\u4e48 $\\frac{r_i \\times c - s_i}{2} &lt; K \\le\\frac{r_i \\times c - s_i}{2}+x\\times c$</li> </ol> <p>\u4e3a\u65b9\u4fbf\u53d9\u8ff0\uff0c\u6211\u4eec\u8bbe $ O_i=\\frac{r_i \\times c - s_i}{2}$\u3002</p> <p>\u5bb9\u6613\u53d1\u73b0\u60c5\u51b5 $1$ \u7684\u7b54\u6848\u548c $K$ \u65e0\u5173\uff0c\u4e14\u6309 $O_i$ \u6392\u5e8f\u540e\u6070\u597d\u662f\u4e00\u4e2a\u540e\u7f00\uff0c\u76f4\u63a5\u7ef4\u62a4\u4e00\u4e2a\u540e\u7f00\u6700\u5c0f\u503c\u5373\u53ef\u3002</p> <p>\u5bf9\u4e8e\u60c5\u51b5 $3$\uff0c\u6211\u4eec\u5316\u4e00\u4e0b\u5f0f\u5b50\u53d1\u73b0 $x=\\left\\lceil\\frac{k-O_i}{c}\\right\\rceil$\uff0c\u5219\u7b54\u6848\u4e3a $2\\left\\lceil\\frac{k-O_i}{c}\\right\\rceil+r_i$</p> <p>\u8003\u8651\u8fdb\u884c\u4e00\u4e9b\u5316\u7b80\u964d\u4f4e\u8026\u5408\u5ea6\uff0c\u9996\u5148\u5bb9\u6613\u60f3\u5230\u5c06\u4e0a\u53d6\u6574\u8f6c\u5316\u4e3a\u5206\u7c7b\u8ba8\u8bba\uff0c\u5373\uff1a</p> <p>$$ \\begin{cases} 2\\left\\lfloor\\frac{k}{c}\\right\\rfloor + 2 - 2\\left\\lfloor\\frac{O_i}{c}\\right\\rfloor + r_i &amp; k\\bmod c&gt;O_i \\bmod c \\\\ 2\\left\\lfloor\\frac{k}{c}\\right\\rfloor-2\\left\\lfloor\\frac{O_i}{c}\\right\\rfloor+r_i &amp; k\\bmod c\\le O_i \\bmod c \\end{cases} $$</p> <p>\u5bb9\u6613\u60f3\u5230\u5148\u628a $K$ \u548c $O_i$ \u79bb\u7ebf\u4e0b\u6765\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u6bcf\u6b21\u78b0\u5230 $K$ \u7ef4\u62a4\u4e00\u4e2a\u6307\u9488\u628a\u5c0f\u4e8e\u7b49\u4e8e\u5b83\u7684 $O_i$ \u5bf9\u5e94\u7684 $- 2\\left\\lfloor\\frac{O_i}{c}\\right\\rfloor+r_i$ \u7684\u5168\u90e8\u52a0\u8fdb\u4e00\u68f5 \u6309 $O_i \\bmod c$ \u7ef4\u62a4\u7ebf\u6bb5\u6811\u91cc\uff0c\u7136\u540e\u67e5\u8be2\u524d\u7f00\u3001\u540e\u7f00\u6700\u5c0f\u503c\u8fd8\u6709\u60c5\u51b5\u4e00\u7684\u540e\u7f00\u6700\u5c0f\u503c\u5206\u522b\u4ee3\u5f0f\u5b50\u5c31\u5b8c\u4e8b\u4e86\u3002</p> <p>\u6709\u4e00\u5806\u7ec6\u8282\u8981\u5904\u7406\uff0c\u5177\u4f53\u770b\u4ee3\u7801\u3002</p>"},{"location":"solution/20230617C_C/#code","title":"code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(i64 i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(i64 i=(s);i&gt;=(e);i--)\nusing namespace std;\nusing i64=long long;\n#define gc getchar()\ninline i64 read(){\ni64 x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst i64 N=4e5+5,inf=1e18;\ni64 n,q,cnte,lf;\nvector&lt;i64&gt; e[N];\nstruct Node{\ni64 mx,se;\nNode():mx(-inf),se(-inf){};\nvoid operator()(const i64 &amp;r){\nif(r&gt;=mx){\nse=mx;mx=r;\n}else if(r&gt;se){\nse=r;\n}\n}\n};\nNode dp[N],pd[N];\ni64 pd1[N],sum[N],sz[N],rt=1;\nvoid dfs(i64 x,i64 fa){\nsum[x]=0;\nfor(auto i:e[x]){\nif(i==fa) continue;\ndfs(i,x);\nsum[x]+=sum[i]+sz[i];\nsz[x]+=sz[i];\ndp[x](dp[i].mx+1);\n}\nif(e[x].size()==1){\nsz[x]=1;\ndp[x](0);\n}\n}\nvoid dfs1(i64 x,i64 fa){\nfor(auto i:e[x]){\nif(i==fa) continue;\npd[i](dp[i].mx);\npd[i](dp[i].se);\nif(pd[x].mx==dp[i].mx+1){\npd[i](pd[x].se+1);\n}else{\npd[i](pd[x].mx+1);\n}\npd1[i]=pd1[x]+sz[rt]-sz[i]*2;\ndfs1(i,x);\n}\n}\ni64 o[N];\nstruct SegmentTree{\n#define mid ((l+r)&gt;&gt;1)\n#define lson l,mid,id&lt;&lt;1\n#define rson mid+1,r,id&lt;&lt;1|1\ni64 querymin[N&lt;&lt;1];\nvoid clear(){\nmem(querymin,0x3f);\n}\nvoid PushUp(i64 id){\nquerymin[id]=min(querymin[id&lt;&lt;1],querymin[id&lt;&lt;1|1]);\n}\nvoid Update(i64 X,i64 P,i64 l=0,i64 r=lf,i64 id=1){\nif(l==r){\nquerymin[id]=min(querymin[id],P);\nreturn;\n}\nif(X&lt;=mid) Update(X,P,lson);\nelse       Update(X,P,rson);\nPushUp(id);\n}\ni64 Ask(i64 L,i64 R,i64 l=0,i64 r=lf,i64 id=1){\nif(L&lt;=l&amp;&amp;r&lt;=R){\nreturn querymin[id];\n}\ni64 res=inf;\nif(L&lt;=mid) res=min(res,Ask(L,R,lson));\nif(mid&lt; R) res=min(res,Ask(L,R,rson));\nreturn res;\n}\n}mt;\nstruct node{\ni64 op,r;\n}nds[N];\nbool cmp(node &amp;a,node &amp;b){\nreturn a.op&lt;b.op;\n}\ni64 suf[N];\nstruct ques{\ni64 pos,num;\n}qq[N];\ni64 ans[N];\nbool cmp1(ques &amp;a,ques &amp;b){\nreturn a.num&lt;b.num;\n}\ni64 cntn;\nsigned main(){\ncnte=n=read();\nmt.clear();\nforup(i,1,n-1){\ni64 u=read(),v=read();++cnte;\ne[u].push_back(cnte);e[cnte].push_back(u);\ne[v].push_back(cnte);e[cnte].push_back(v);\n}\nforup(i,1,cnte){\nif(e[i].size()==1){\nlf++;\n}\n}\nforup(i,1,cnte){\nif(e[i].size()&gt;1){\nrt=i;\nbreak;\n}\n}\ndfs(rt,0);\npd[rt]=dp[rt];\npd1[rt]=sum[rt];\ndfs1(rt,0);\nforup(i,1,cnte){\no[i]=(pd[i].mx*lf-pd1[i])/2;\nif(e[i].size()&gt;1) nds[++cntn]=node{o[i],pd[i].mx};\n}\nsort(nds+1,nds+cntn+1,cmp); suf[cntn+1]=inf;\nfordown(i,cntn,0){\nsuf[i]=min(suf[i+1],nds[i].r);\n}\nq=read();\nforup(i,1,q){\nqq[i].num=read();\nqq[i].pos=i;\n}\nsort(qq+1,qq+n+1,cmp1);\ni64 l=1;\nforup(i,1,q){\nwhile(l&lt;=cntn&amp;&amp;nds[l].op&lt;=qq[i].num){\nmt.Update(nds[l].op%lf,-2*(nds[l].op/lf)+nds[l].r);\nl++;\n}\ni64 res=inf;\nres=min(res,suf[l]);\nres=min(res,2*(qq[i].num/lf)+2+mt.Ask(0,qq[i].num%lf));\nres=min(res,2*(qq[i].num/lf)+mt.Ask(qq[i].num%lf,lf-1));\nans[qq[i].pos]=res;\n}\nforup(i,1,q){\nprintf(\"%lld\\n\",ans[i]);\n}\n}\n</code></pre>"},{"location":"solution/20230624B_ABCD/","title":"20230624B","text":"<p>\u5185\u542b\uff1a\u8df3\u8dc3\uff0c\u5339\u914d\uff0c\u56fe\uff0c\u5f02\u6216\u3002</p>"},{"location":"solution/20230624B_ABCD/#_1","title":"\u95f2\u626f","text":"<p>\u8fd9\u6b21\u51e0\u9053\u9898\u90fd\u633a\u6709\u8bb2\u5934\u7684\u5c31\u4e00\u8d77\u5199\u4e86\u3002</p>"},{"location":"solution/20230624B_ABCD/#t1","title":"T1","text":"<p>\u9996\u5148\u6613\u8bc1\u6700\u4f18\u89e3\u5fc5\u5b9a\u662f\u4e00\u76f4\u5f80\u53f3\u8df3\uff0c\u7531\u4e8e\u8fd9\u9053\u9898 $N \\le 10^5,M\\le 10^9$ \u76f4\u63a5\u8003\u8651\u5728 $T_i$ \u4e0a dp\uff0c\u6613\u5f97 dp \u5f0f\u5b50\uff1a</p> <p>$$dp_i =\\max_{j=0}^{i-1}{dp_j-\\left\\lceil \\dfrac{T_i-T_j}{D}\\right\\rceil\\times A+B_i}$$</p> <p>\u7136\u540e\u4f60\u5c31\u4f1a $O(n^2)$ \u505a\u6cd5\u4e86\u3002</p> <p>\u8003\u8651 dp \u7ecf\u5178\u64cd\u4f5c\uff0c\u628a $i,j$ \u5206\u5f00\u518d\u8003\u8651\u5982\u4f55\u7ef4\u62a4\uff0c\u9996\u5148\u8003\u8651\u90a3\u5768\u4e0a\u53d6\u6574\u600e\u4e48\u62c6\uff08\u6211\u4e0d\u4f1a\u544a\u8bc9\u4f60\u6211\u8d5b\u65f6\u8fd9\u91cc\u641e\u9519\u4e86\u75db\u5931 100pts\uff09\uff1a</p> <p>$$ \\begin{aligned} \\left\\lceil\\dfrac{T_i-T_j}{D}\\right\\rceil\\times A  &amp;=\\left\\lceil\\dfrac{\\left\\lfloor\\frac{T_i}{D}\\right\\rfloor D+T_i \\bmod D-\\left\\lfloor\\frac{T_j}{D}\\right\\rfloor D-T_j  \\bmod D}{D}\\right\\rceil\\times A\\\\ &amp;=\\left\\lceil\\dfrac{\\left\\lfloor\\frac{T_i}{D}\\right\\rfloor D}{D}-\\dfrac{\\left\\lfloor\\frac{T_j}{D}\\right\\rfloor D}{D}+\\dfrac{T_i \\bmod D -T_j \\bmod D}{D}\\right\\rceil\\times A\\\\ &amp;=\\left\\lceil\\left\\lfloor\\frac{T_i}{D}\\right\\rfloor-\\left\\lfloor\\frac{T_j}{D}\\right\\rfloor+\\dfrac{T_i \\bmod D -T_j \\bmod D}{D}\\right\\rceil\\times A\\\\ &amp;=\\left(\\left\\lfloor\\frac{T_i}{D}\\right\\rfloor-\\left\\lfloor\\frac{T_j}{D}\\right\\rfloor+\\left\\lceil\\dfrac{T_i \\bmod D -T_j \\bmod D}{D}\\right\\rceil\\right)\\times A\\\\ &amp;=A\\left\\lfloor\\frac{T_i}{D}\\right\\rfloor-A\\left\\lfloor\\frac{T_j}{D}\\right\\rfloor+A\\left[T_i \\bmod D &gt;T_j \\bmod D\\right] \\end{aligned} $$</p> <p>\u5176\u4e2d\u4e2d\u62ec\u53f7\u8868\u793a\u82e5\u5185\u4fa7\u8868\u8fbe\u5f0f\u4e3a true\uff0c\u503c\u4e3a $1$\uff0c\u53cd\u4e4b\u4e3a $0$\u3002</p> <p>\u7136\u540e\u628a\u8fd9\u4e2a\u5f0f\u5b50\u585e\u56de\u8f6c\u79fb\u65b9\u7a0b\uff1a</p> <p>$$ \\begin{aligned} dp_i &amp;=\\max_{j=0}^{i-1}{dp_j-\\left\\lceil \\dfrac{T_i-T_j}{D}\\right\\rceil\\times A+B_i}\\\\ &amp;=\\max_{j=0}^{i-1}{dp_j-A\\left\\lfloor\\frac{T_i}{D}\\right\\rfloor+A\\left\\lfloor\\frac{T_j}{D}\\right\\rfloor-A\\left[T_i \\bmod D &gt;T_j \\bmod D\\right]+B_i}\\\\ &amp;=B_i-A\\left\\lfloor\\frac{T_i}{D}\\right\\rfloor+\\max_{j=0}^{i-1}{dp_j+A\\left\\lfloor\\frac{T_j}{D}\\right\\rfloor-A\\left[T_i \\bmod D &gt;T_j \\bmod D\\right]} \\end{aligned} $$</p> <p>\u8fd9\u6837\u53ea\u7528\u7ef4\u62a4 $\\max$ \u91cc\u9762\u7684\u4e1c\u897f\u5c31\u597d\u4e86\uff0c\u53d1\u73b0\u91cc\u9762\u7684 $A\\left[T_i \\bmod D &gt;T_j \\bmod D\\right]$ \u5f88\u70e6\u4eba\uff0c\u4f46\u662f\u8003\u8651\u5982\u679c\u6309 $T_i \\bmod D$ \u5347\u5e8f\u6392\u5217\u540e\u80fd\u4f7f\u8fd9\u4e2a\u5f0f\u5b50\u4e0d\u4e3a $0$ \u7684 $j$ \u5fc5\u5b9a\u662f\u4e00\u6bb5\u8fde\u7eed\u7684\u524d\u7f00\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u524d\u7f00 $\\max$ \u540e\u7f00 $\\max$ \u5206\u522b\u4ee3\u5f0f\u5b50\u5373\u53ef\uff0c\u8fd9\u91cc\u53ef\u4ee5\u7528\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811/\u79bb\u6563\u5316+\u7ebf\u6bb5\u6811/\u79bb\u6563\u5316+\u6811\u72b6\u6570\u7ec4\u3002</p>"},{"location":"solution/20230624B_ABCD/#code","title":"code","text":"<p>\u6211\u7684\u4ee3\u7801\u5199\u7684\u5f88\u4e11\uff0c\u8fd9\u91cc\u8d34\u4e00\u4e0b  \u7684\u4ee3\u7801\u3002</p> <p>\u5f00\u4e24\u4e2a\u6811\u72b6\u6570\u7ec4\u5206\u522b\u7ef4\u62a4\u524d\u540e\u7f00\u6700\u5927\u503c\u3002</p> <pre><code>//author: _Cyan_\n#include&lt;bits/stdc++.h&gt;\n#define lowbit(x) (x)&amp;(-x)\n#define int long long\nusing namespace std;\ninline int read(){\nint x=0,f=1; char c=getchar();\nwhile(!isdigit(c)){if(c=='-') f=-1; c=getchar();}\nwhile(isdigit(c)){x=(x&lt;&lt;1)+(x&lt;&lt;3)+(c^48); c=getchar();}\nreturn x*f;\n}\nconst int mod=998244353,inf=1e18,N=1e5+5;\nint k,m,d,a,n,t[N],b[N],dp[N],s[N],op[N],q[N],h[N],len;\ninline void addq(int p,int k){for(;p&lt;=len;p+=lowbit(p)) q[p]=max(q[p],k);}\ninline void addh(int p,int k){for(;p;p-=lowbit(p)) h[p]=max(h[p],k);}\ninline int askq(int p){int res=-inf; for(;p;p-=lowbit(p)) res=max(q[p],res); return res;}\ninline int askh(int p){int res=-inf; for(;p&lt;=len;p+=lowbit(p)) res=max(h[p],res); return res;}\nsigned main(){\nfreopen(\"jump.in\",\"r\",stdin);\nfreopen(\"jump.out\",\"w\",stdout);\nk=read(),m=read(),d=read(),a=read(),n=read()+1;\nfor(int i=2;i&lt;=n;i++) t[i]=read(),b[i]=read();\nt[++n]=m;t[1]=k;\nfor(int i=1;i&lt;=n;i++) op[i]=s[i]=t[i]%d;\nsort(s+1,s+n+1);\nlen=unique(s+1,s+n+1)-s-1;\nfor(int i=1;i&lt;=n;i++) op[i]=lower_bound(s+1,s+len+1,op[i])-s;\nfor(int i=1;i&lt;=len;i++) q[i]=h[i]=-inf;\ndp[1]=0;\naddq(op[1],dp[1]+t[1]/d*a); addh(op[1],dp[1]+t[1]/d*a);\nfor(int i=2;i&lt;=n;i++){\ndp[i]=max(askq(op[i]-1)-t[i]/d*a-a,askh(op[i])-t[i]/d*a)+b[i];\naddq(op[i],dp[i]+t[i]/d*a); addh(op[i],dp[i]+t[i]/d*a);\n}\ncout&lt;&lt;dp[n]&lt;&lt;'\\n';\n}\n</code></pre>"},{"location":"solution/20230624B_ABCD/#t2","title":"T2 \u9898\u89e3","text":"<p>\u9996\u5148\u5bb9\u6613\u53d1\u73b0\u957f\u5ea6\u4e3a $k$ \u7684\u5b57\u7b26\u4e32 $P$ \u548c $Q$ \u80fd\u5339\u914d\u5f53\u4e14\u4ec5\u5f53\uff1a</p> <p>$$\\nexists 1 \\le i,j \\le k,i \\ne j\\;s.t.\\;P_i=P_j,Q_i \\ne Q_j \\;or\\;P_i \\ne P_j,Q_i=Q_j$$</p> <p>\u8fd9\u4e2a\u81ea\u5df1\u5206\u60c5\u51b5\u8ba8\u8bba\u4e00\u4e0b\uff0c\u6211\u4e0d\u63d0\u4f9b\u8bc1\u660e\u3002</p> <p>\u7136\u540e\u8fd9\u4e2a\u95ee\u9898\u5c31\u8f6c\u5316\u6210\u4e86\u7ef4\u62a4\u4e24\u5b57\u7b26\u4e32\u5185\u7684\u5b57\u7b26\u662f\u5426\u4e00\u4e00\u5bf9\u5e94\uff0c\u5bb9\u6613\u5f97\u5230 $O(n^2)$ \u505a\u6cd5\uff1a</p> <p>$O(n)$ \u679a\u4e3e $S$ \u4e2d\u5b50\u4e32\u7684\u5f00\u5934\uff0c\u7136\u540e $O(n)$ \u626b\u4e00\u904d\u5224\u65ad\u6709\u6ca1\u6709\u4e00\u4e2a\u5bf9\u591a\u4e2a\u7684\u60c5\u51b5\uff0c\u7edf\u8ba1\u7b54\u6848\u3002</p> <p>\u53d1\u73b0\u679a\u4e3e\u5b50\u4e32\u5f00\u5934\u5f88\u96be\u4f18\u5316\uff0c\u8003\u8651\u4f18\u5316\u5224\u65ad\u7684\u8fc7\u7a0b\uff0c\u4ee5\u4e0b\u7684 $S$ \u662f\u679a\u4e3e\u7684\u5b50\u4e32\uff0c$T$ \u662f\u6574\u4e2a $T$\u3002</p> <p>\u9996\u5148\u8003\u8651\u5047\u5982 $S$ \u4e2d\u5b57\u7b26 $a$ \u4e0e $T$ \u4e2d\u5b57\u7b26 $b$ \u4e00\u4e00\u5bf9\u5e94\u7684\u8bdd\uff0c\u5b83\u4eec\u4f1a\u6709\u4ec0\u4e48\u5171\u540c\u70b9\uff0c\u5bb9\u6613\u53d1\u73b0\u5b83\u4eec\u7684\u4f4d\u7f6e\u662f\u4e00\u4e00\u76f8\u540c\u7684\uff0c\u5bb9\u6613\u60f3\u5230\u628a\u4f4d\u7f6e\u4f5c\u4e3a\u54c8\u5e0c\u7684\u6743\u503c\u7528\u54c8\u5e0c\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f46\u662f\u8fd9\u96be\u4ee5\u63a8\u5230\u4e0b\u4e00\u4e2a\u5b50\u4e32\uff0c\u8fd9\u65f6\u5019\u5bb9\u6613\u60f3\u5230\u5c06\u6bcf\u4e2a\u5b57\u7b26\u4e0e\u4e0a\u4e00\u4e2a\u8be5\u5b57\u7b26\u7684\u8ddd\u79bb\u4f5c\u4e3a\u6743\u503c\u6765\u505a\u54c8\u5e0c\u3002</p> <p>\u6ce8\uff1a\u6211\u5bf9\u54c8\u5e0c\u7684\u5b9a\u4e49\u662f $V=(\\sum\\limits_{i=1}^{n} val_i\\times P^{n-i})\\bmod Q$\uff0c\u5373\u4ee5\u5de6\u4fa7\u4e3a\u9ad8\u4f4d\u7684 $P$ \u8fdb\u5236\u6570\uff0c\u5176\u4e2d $P$ \u548c $Q$ \u4e3a\u4f60\u559c\u6b22\u7684\u5927\u8d28\u6570\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u5047\u5982\u5728\u5f53\u524d\u5b50\u4e32\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u5b57\u7b26 $a$ \u7684\u4f4d\u7f6e\u662f $a_1$\uff0c\u90a3\u4e48\u5b83\u5728\u54c8\u5e0c\u4e2d\u7684\u6743\u503c\u5c31\u662f $0$\uff0c\u5047\u5982\u7b2c\u4e8c\u4e2a\u5b57\u7b26 $a$ \u7684\u4f4d\u7f6e\u662f $a_2$ \u5b83\u5728\u54c8\u5e0c\u4e2d\u7684\u6743\u503c\u5c31\u662f $a_2-a_1$\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u5bb9\u6613\u53d1\u73b0\u8fd9\u6837\u505a $S$ \u548c $T$ \u5339\u914d\u5f53\u4e14\u4ec5\u5f53\u54c8\u5e0c\u503c\u76f8\u540c\uff08\u6b64\u5904\u4e0d\u8003\u8651\u54c8\u5e0c\u51b2\u7a81\uff09\u3002</p> <p>\u8003\u8651\u5982\u4f55\u7ef4\u62a4\uff0c\u5047\u8bbe $S$ \u957f\u8fd9\u6837\uff1a</p> <p>$$\\boxed{A_1\\dots A_2\\dots B_1\\dots}B_2$$</p> <p>\u5176\u4e2d\u6846\u51fa\u6765\u7684\u662f\u4e0a\u4e00\u4e2a\u5904\u7406\u7684\u5b50\u4e32\uff0c\u4e24\u4e2a $A$ \u5206\u522b\u662f\u7b2c\u4e00\u4e2a\u3001\u7b2c\u4e8c\u4e2a\u5b57\u7b26 $A$\uff0c\u4e24\u4e2a $B$ \u662f\u6700\u540e\u4e24\u4e2a\u3002\u5bb9\u6613\u53d1\u73b0\u6211\u4eec\u4e0b\u4e00\u6b65\u8981\u5904\u7406\u7684\u5b50\u4e32\u957f\u8fd9\u6837\uff1a</p> <p>$$A_1\\boxed{\\dots A_2\\dots B_1\\dots B_2}$$</p> <p>\u8003\u8651\u6bcf\u4e2a\u5b57\u7b26\u7684\u8d21\u732e\u4f1a\u5982\u4f55\u53d8\u5316\uff0c\u9996\u5148 $A_1$ \u7684\u8d21\u732e\u4e0d\u4f1a\u53d8\uff0c\u56e0\u4e3a\u5b83\u672c\u6765\u5c31\u662f $0$\uff0c\u4f46 $A_2$ \u4f1a\u4ece\u539f\u6765\u7684 $(A_2-A_1)\\times P^{B_2-A_2+1}$ \u53d8\u6210 $0$\u3002</p> <p>\u7136\u540e\u4e2d\u95f4\u7701\u7565\u53f7\u7684\u5b57\u7b26\u5305\u62ec $B_1$ \u7684\u8d21\u732e\u4f1a\u5168\u90e8\u4e58\u4ee5 $P$\uff0c\u8fd9\u4e2a\u5f88\u5e38\u89c4\u3002</p> <p>\u6700\u540e $B_2$ \u4f1a\u5bf9\u54c8\u5e0c\u503c\u52a0\u4e0a $B_2-B_1$ \u7684\u8d21\u732e\u3002</p> <p>\u7136\u540e\u76f4\u63a5\u505a\u5c31\u884c\u4e86\uff0c\u6bd4\u8f83\u677f\u3002</p>"},{"location":"solution/20230624B_ABCD/#code_1","title":"code","text":"<pre><code>//author:six-floor-slip-liu\n#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(i64 i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(i64 i=(s);i&gt;=(e);i--)\nusing namespace std;\nusing i64=long long;\n#define gc getchar()\ninline i64 read(){\ni64 x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst i64 N=1e6+5,inf=1e18,MOD=1e9+7,P=13331;\ni64 Q,c,n,m,s[N],t[N];\ni64 pren[N],sufn[N];\ni64 hsn,hsm;\ni64 ksm(i64 a,i64 b){\ni64 c=1;\nwhile(b){\nif(b&amp;1) (c*=a)%=MOD;\n(a*=a)%=MOD;\nb&gt;&gt;=1;\n}\nreturn c;\n}\nvoid del(i64 x,i64 ed){\nif(sufn[x]!=0){\nhsn=(hsn-(sufn[x]-x)*ksm(P,ed-sufn[x])%MOD+MOD)%MOD;\n}\n}\nvoid add(i64 i,i64 x){\nhsn=hsn*P%MOD;\nif(pren[s[x]]&gt;=i){\n(hsn+=x-pren[s[x]])%=MOD;\n}\nsufn[pren[s[x]]]=x;\npren[s[x]]=x;\n}\ni64 pre[N];\nvoid solve(){\nmem(pre,0);mem(pren,0);mem(sufn,0);\nhsm=hsn=0;\nn=read();m=read();\nforup(i,1,n){\ns[i]=read();\n}\nforup(i,1,m){\nt[i]=read();\n}\nif(n&lt;m){\nputs(\"0\\n\");\nreturn;\n}\nforup(i,1,m){\nadd(1,i);\nhsm=hsm*P%MOD;\nif(pre[t[i]]!=0){\n(hsm+=i-pre[t[i]])%=MOD;\n}\npre[t[i]]=i;\n}\nvector&lt;i64&gt; ans;\nif(hsm==hsn) ans.push_back(1);\nforup(i,1,n-m){\ndel(i,i+m-1);\nadd(i+1,i+m);\nif(hsn==hsm) ans.push_back(i+1);\n}\nprintf(\"%lld\\n\",(i64)ans.size());\nfor(auto i:ans){\nprintf(\"%lld \",i);\n}\nputs(\"\");\n}\nsigned main(){\nfreopen(\"match.in\",\"r\",stdin);\nfreopen(\"match.out\",\"w\",stdout);\nQ=read();c=read();\nwhile(Q--) solve();\n}\n</code></pre>"},{"location":"solution/20230624B_ABCD/#t3","title":"T3 \u9898\u89e3","text":"<p>\u8fd9\u9053\u9898\u60f3\u5230\u4e86\u505a\u6cd5\u5c31\u7206\u7b80\u5355\uff0c\u6ca1\u60f3\u5230\u5c31\u7206\u96be\u3002</p> <p>\u9996\u5148\u5bb9\u6613\u60f3\u5230\u8fd9\u9053\u9898\u7c7b\u4f3c\u4e8e\u6c42\u51fa\u7f51\u7edc\u6d41\u56fe\u7684\u6240\u6709\u5272\u5e76\u8f93\u51fa\u65b9\u6848\uff0c\u7136\u540e\u6211\u8d5b\u65f6\u56e0\u4e3a\u89c9\u5f97\u548c\u7f51\u7edc\u6d41\u6709\u5173\u5c31\u76f4\u63a5\u653e\u5f03\u4e86\u3002</p> <p>\u9996\u5148\u7b54\u6848\u7684 $K$ \u80af\u5b9a\u5c0f\u4e8e\u7b49\u4e8e\u4ece $S$ \u5230 $T$ \u7684\u6700\u77ed\u8def\u957f\u5ea6\uff0c\u56e0\u4e3a\u5047\u8bbe $K$ \u5927\u4e8e\u6700\u77ed\u8def\u957f\u5ea6\uff0c\u90a3\u4e48\u5fc5\u7136\u5b58\u5728\u4e00\u4e2a\u6743\u503c $x$ \u4f7f\u5f97\u5220\u6389\u5b83\u5bf9\u6700\u77ed\u8def\u6ca1\u5f71\u54cd\uff0c\u90a3\u4e48 $S$ \u548c $T$ \u5c31\u8fde\u901a\u4e86\u3002</p> <p>\u77e5\u9053\u4e86\u8fd9\u4e2a\u7ed3\u8bba\u8003\u8651\u5982\u4f55\u6784\u9020\u65b9\u6848\uff0c\u5bb9\u6613\u53d1\u73b0\u5728\u7f51\u7edc\u6d41\u5206\u5c42\u56fe\u4e2d\u5047\u5982\u5220\u6389\u4e86\u67d0\u4e00\u5c42\u7684\u6240\u6709\u7ed3\u70b9\u548c\u4e0e\u4e4b\u76f8\u8fde\u7684\u8fb9\uff0c\u90a3\u4e48\u6e90\u70b9 $S$ \u548c\u6c47\u70b9 $T$ \u5fc5\u5b9a\u4e0d\u8fde\u901a\uff0c\u8fd9\u9053\u9898\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u6837\u7684\u601d\u8def\u7ed9\u56fe\u5206\u5c42\uff0c\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002</p>"},{"location":"solution/20230624B_ABCD/#code_2","title":"code","text":"<pre><code>//author:six-floor-slip-liu\n#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(int i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst int N=405,inf=0x3f3f3f3f;\nint n,m,s,t,dpt[N],val[N*N],ans=inf;\nstruct edge{\nint v,pos;\n};\nvector&lt;edge&gt; e[N];\nqueue&lt;int&gt; q;\nvoid bfs(int x){\nmem(dpt,-1);\ndpt[x]=0;\nq.push(x);\nwhile(q.size()){\nint u=q.front();q.pop();\nfor(auto i:e[u]){\nint v=i.v,pos=i.pos;\nif(dpt[v]==dpt[u]+1||dpt[v]==dpt[u]){\nval[pos]=min(dpt[u]+1,ans);\n}else if(dpt[v]==-1){\ndpt[v]=min(dpt[u]+1,ans);\nval[pos]=min(dpt[u]+1,ans);\nq.push(v);\nif(v==t) ans=dpt[v];\n}\n}\n}\n}\nsigned main(){\nfreopen(\"graph.in\",\"r\",stdin);\nfreopen(\"graph.out\",\"w\",stdout);\nn=read();m=read();s=read();t=read();\nforup(i,1,m){\nint u=read(),v=read();\ne[u].push_back(edge{v,i});\ne[v].push_back(edge{u,i});\n}\nbfs(s);\nprintf(\"%d\\n\",ans);\nforup(i,1,m){\nprintf(\"%d\\n\",val[i]);\n}\n}\n</code></pre>"},{"location":"solution/20230624B_ABCD/#t4","title":"T4 \u9898\u89e3","text":"<p>\u9996\u5148\u770b\u5230\u5f02\u6216\u5c31\u60f3\u5230 01Trie\uff0c\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\u5728 Trie \u4e0a\u5e94\u8be5\u5982\u4f55\u89e3\u51b3\u3002</p> <p>\u6ce8\uff1a\u4ee5\u4e0b\u7ea6\u5b9a $ls(i)$ \u8868\u793a $i$ \u5728\u5b57\u5178\u6811\u4e2d\u8fd9\u4e00\u5c42\u53d6 $0$ \u8fde\u5411\u7684\u7ed3\u70b9\uff0c$rs(i)$ \u8868\u793a\u53d6 $1$ \u8fde\u5411\u7684\u7ed3\u70b9\u3002</p> <p>\u8bbe $f(i,p)$ \u8868\u793a\u8003\u8651 $2^{p+1}\\sim2^{60}$ \u8fd9\u4e9b\u4f4d\u6570\u5168\u90fd\u76f8\u7b49\u7684\u6570\u4e2d\uff0c\u5f53\u524d\u5728 $i$ \u7ed3\u70b9\u5408\u6cd5\u7684\u65b9\u6848\u6570\uff0c\u5373\u53ea\u8003\u8651\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u7684\u65b9\u6848\u6570\uff0c\u6613\u5f97\u9012\u5f52\u5f0f\uff1a</p> <p>$$ f(i,p)=\\begin{cases} f(ls(i),p-1)\\cdot f(rs(i),p-1) &amp;x \\le 2^p\\ ? &amp;x&gt;2^p \\end{cases} $$</p> <p>\u5176\u4e2d\u8fb9\u754c\u4e3a $f(i,-1)=2^{cnt_i}$\uff08\u867d\u7136\u4e00\u822c\u53d6\u4e0d\u5230\uff09\uff0c$cnt_i$ \u4e3a\u503c\u53d6\u5728 $i$ \u8282\u70b9\u5b50\u6811\u4e2d\u7684\u53f6\u7ed3\u70b9\u4e0a\u7684\u6570\u7684\u6570\u91cf\u3002</p> <p>\u5f0f\u5b50\u5f88\u597d\u7406\u89e3\uff0c\u5047\u5982\u5728\u8fd9\u4e00\u5c42 $x\\le 2^p$\uff0c\u8bf4\u660e\u4ece\u5de6\u5b50\u6811\u968f\u4fbf\u9009\u4e00\u4e2a\u53f3\u5b50\u6811\u968f\u4fbf\u9009\u4e00\u4e2a\u5f02\u6216\u8d77\u6765\u90fd\u5927\u4e8e\u7b49\u4e8e $x$\uff0c\u8fd9\u65f6\u5019\u5c31\u8f6c\u5316\u6210\u4e86\u4e24\u4e2a\u5b50\u6811\u4e2d\u7684\u5b50\u95ee\u9898\u3002</p> <p>\u4f46\u662f\u5047\u5982\u8fd9\u4e00\u5c42\u5fc5\u5b9a\u4ea7\u751f\u5206\u652f\uff0c\u6211\u4eec\u53ea\u7528 $f$ \u5c31\u65e0\u6cd5\u5904\u7406\u4e86\uff0c\u8fd9\u65f6\u5019\u4e0d\u59a8\u4ee4 $g(i,j,p,w)$ \u8868\u793a\u8003\u8651\u5728 $i$ \u7684\u5b50\u6811\u4e2d\u9009\u6070\u597d\u4e00\u4e2a\uff0c$j$ \u7684\u5b50\u6811\u4e2d\u9009\u6070\u597d\u4e00\u4e2a\uff0c$x$ \u51cf\u53bb $p$ \u4ee5\u4e0a\u4f4d\u6570\u4ea7\u751f\u7684\u8d21\u732e\u540e\u8fd8\u5269\u4e0b $w$ \u7684\u65b9\u6848\u6570\uff0c\u8fd9\u65f6\u5019\u5c31\u80fd\u628a\u4e0a\u9762\u7684\u9012\u5f52\u5f0f\u8865\u9f50\u4e86:</p> <p>$$ f(i,p)=\\begin{cases} f(ls(i),p-1)\\cdot f(rs(i),p-1) &amp;x \\le 2^p\\ g(ls(i),rs(i),p-1,x-2^p)+cnt_i+1 &amp;x&gt;2^p \\end{cases} $$</p> <p>\u6ce8\u610f\u8981\u52a0\u4e0a\u53ea\u9009\u4e00\u4e2a\u7684\u65b9\u6848\u6570\u3002</p> <p>\u8fd9\u65f6\u5019\u6211\u4eec\u8003\u8651\u5982\u4f55\u6c42 $g(i,j,p,w)$\uff0c\u5148\u4e0a\u9012\u5f52\u5f0f\uff1a</p> <p>$$ g(i,j,p,w)=\\begin{cases} g(ls(i),rs(j),p-1,w-2^p)+g(rs(i),ls(j),p-1,w-2^p) &amp;w \\And 2^p =1\\ g(rs(i),rs(j),p-1,w)+g(ls(i),ls(j),p-1,w)\\+g(ls(i),rs(j),p-1,w-2^p)+g(rs(i),ls(j),p-1,w-2^p) &amp;w \\And 2^p \\ne1 \\end{cases} $$</p> <p>\u4ed6\u5988\u7684\u597d\u957f\u3002</p> <p>\u5176\u4e2d\u8fb9\u754c\u4e3a $g(i,j,p,w)=cnt_i\\cdot cnt_j(w \\le 0)$\u3002\u8fd9\u4e2a\u5f88\u597d\u7406\u89e3\uff0c\u5047\u5982 $w \\le 0$ \u8bf4\u660e\u5de6\u8fb9\u968f\u4fbf\u9009\u4e00\u4e2a\u53f3\u8fb9\u968f\u4fbf\u9009\u4e00\u4e2a\u90fd\u5408\u6cd5\uff0c\u5e76\u4e14\u7531\u4e8e\u6211\u4eec\u5206\u7c7b\u8ba8\u8bba\u7684\u65b9\u5f0f\u5fc5\u5b9a\u4e0d\u4f1a\u51fa\u73b0 $p=-1,w&gt;0$ \u7684\u60c5\u51b5\u3002</p> <p>\u7136\u540e\u89e3\u91ca\u4e00\u4e0b\u9012\u5f52\u5f0f\uff0c\u9996\u5148\u5047\u5982 $w$ \u8fd9\u4e00\u4f4d\u4e3a $1$ \u8bf4\u660e\u4e0b\u9762\u4e00\u5b9a\u8981\u8d70\u4e0d\u4e00\u6837\u7684\u4e24\u6761\u8fb9\u4e0d\u7136\u5c31\u4e0d\u53ef\u80fd\u6784\u9020\u51fa\u5408\u6cd5\u89e3\uff0c\u5047\u5982\u4e0d\u4e3a $1$ \u90a3\u4e48\u56db\u79cd\u60c5\u51b5\u90fd\u80fd\u8d70\uff08\u4f46\u5176\u5b9e\u8fd9\u79cd\u60c5\u51b5\u4e0b\u8d70\u4e24\u6761\u4e0d\u4e00\u6837\u7684\u8fb9\u4f1a\u76f4\u63a5\u5230\u8fbe\u8fb9\u754c\uff0c\u4e3a\u4e86\u65b9\u4fbf\u6211\u76f4\u63a5\u5199\u6210\u8fd9\u6837\u4e86\uff09\u3002</p> <p>\u603b\u4e4b\u5927\u4f53\u5b9e\u73b0\u5c31\u662f\u5199\u4e24\u4e2a\u9012\u5f52\u51fd\u6570\u4e92\u76f8\u8c03\u7528\u5c31\u884c\u4e86\u3002</p> <p>\u53e6\u5916\u6ce8\u610f\u4e00\u4e0b\u6211\u7684\u9012\u5f52\u5f0f\u9ed8\u8ba4 Trie \u662f\u4e00\u68f5\u6ee1\u4e8c\u53c9\u6811\uff0c\u5b9e\u73b0\u65f6\u6ce8\u610f\u5224\u4e00\u4e0b\u7ed3\u70b9\u7684\u5b58\u5728\u6027\u3002</p>"},{"location":"solution/20230624B_ABCD/#code_3","title":"code","text":"<pre><code>//author:six-floor-slip-liu\n#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(i64 i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(i64 i=(s);i&gt;=(e);i--)\nusing namespace std;\nusing i64=long long;\n#define gc getchar()\ninline i64 read(){\ni64 x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst i64 N=3e5+5,inf=0x3f3f3f3f,mod=998244353;\ni64 n,x;\ni64 son[N*65][2],cnts;\ni64 cnt[N*65];\nvoid Insert(i64 x){\ni64 p=0;\nfordown(i,60,0){\ncnt[p]++;\ni64 c=(x&gt;&gt;i)&amp;1;\nif(son[p][c]==-1) son[p][c]=++cnts;\np=son[p][c];\n}\ncnt[p]++;\n}\ni64 work(i64 u,i64 v,i64 x,i64 p){\nif(u==-1||v==-1) return 0;\nif(x&lt;=0)         return cnt[u]*cnt[v]%mod;\nif((x&gt;&gt;p)&amp;1)     return (work(son[u][0],son[v][1],x-(1ll&lt;&lt;p),p-1)+work(son[u][1],son[v][0],x-(1ll&lt;&lt;p),p-1))%mod;\nelse             return (work(son[u][0],son[v][1],x-(1ll&lt;&lt;p),p-1)+work(son[u][1],son[v][0],x-(1ll&lt;&lt;p),p-1)+work(son[u][1],son[v][1],x,p-1)+work(son[u][0],son[v][0],x,p-1))%mod;\n}\ni64 solve(i64 u,i64 x,i64 p){\nif(u==-1)        return 1;\nif(p==-1)        return (1ll&lt;&lt;cnt[u])%mod;\nif(x&gt;(1ll&lt;&lt;p))   return cnt[u]+1+work(son[u][0],son[u][1],x-(1ll&lt;&lt;p),p-1);\nelse             return solve(son[u][0],x,p-1)*solve(son[u][1],x,p-1)%mod;\n}\nsigned main(){\n//  freopen(\"xor.in\",\"r\",stdin);\n//  freopen(\"xor.out\",\"w\",stdout);\nmem(son,-1);\nn=read();x=read();\nforup(i,1,n){\ni64 a=read();\nInsert(a);\n}\nprintf(\"%lld\",solve(0,x,60)-1);\n}\n</code></pre>"},{"location":"solution/20230626B_ABC/","title":"20230626B","text":"<p>\u5185\u542b\uff1a\u4e32\uff0c\u827a\u672f\u5bb6\uff0c\u9ed1\u767d\u6811\uff0c\u6562\u89c8\u6c42</p>"},{"location":"solution/20230626B_ABC/#_1","title":"\u95f2\u626f","text":"<p>\u600e\u4e48\u4f1a\u6709\u5b66\u6821\u9694\u4e00\u5929\u8003\u4e00\u6b21\u554a\u3002</p> <p>\u8fd9\u6b21 T2T3 \u8003\u573a\u4e0a\u90fd\u60f3\u5230\u505a\u6cd5\u4e86\uff0c\u4f46\u662f\u4e24\u9053\u9898\u90fd\u6ca1\u60f3\u901a\u5b9e\u73b0\u7ec6\u8282\uff0c\u76f4\u63a5\u62a5\u7075\uff0c\u611f\u89c9\u6211\u662f\u7802\u73bb\u7eb8\u5f20\u3002</p> <p>\u8fd9\u6b21\u6570\u636e\u7ed3\u6784\u5927\u4f6c\u8bf4 T2 \u662f\u7802\u73bb\u9898\uff0c\u601d\u7ef4\u9898\u5927\u4f6c\u8bf4 T3 \u662f\u7802\u73bb\u9898\uff0c\u6211\u8bf4\u6211\u662f\u7802\u73bb\u3002</p>"},{"location":"solution/20230626B_ABC/#t1","title":"T1","text":"<p>\u8fd9\u9053\u9898\u597d\u591a\u4eba\u90fd\u662f\u6253\u8868\u627e\u7684\u89c4\u5f8b\uff0c\u8ba9\u6211\u8fd9\u4e2a\u7528\u6570\u5b66\u65b9\u6cd5\u63a8\u7684\u683c\u683c\u4e0d\u5165\u3002</p> <p>\u5148\u7279\u5224 $k=0$ \u7684\u60c5\u51b5\uff0c\u7136\u540e\u8003\u8651\u5047\u8bbe $k&gt; 1$ \u4e2a $1$ \u628a\u5269\u4e0b\u7684 $0$ \u5206\u6210 $k+1$ \u6bb5\u5e94\u8be5\u5982\u4f55\u5904\u7406\u3002</p> <p>\u5047\u8bbe\u7b2c\u4e00\u6bb5\u8fde\u7eed\u7684 $0$ \u957f\u5ea6\u4e3a $a_1$\uff0c\u7b2c\u4e8c\u6bb5\u4e3a $a_2$\uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002\u5bb9\u6613\u53d1\u73b0\u5047\u5982\u67d0\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u5728 $a_1$ \u4e2d\u6216\u5728 $a_1$ \u53f3\u4fa7\u7684 $1$ \u4e0a\uff0c\u53f3\u7aef\u70b9\u5728 $a_2$ \u6216\u5176\u5de6\u4fa7\u7684 $1$ \u4e0a\uff0c\u533a\u95f4\u5185\u5c31\u53ea\u6709\u4e00\u4e2a $1$\uff0c\u8fd9\u6837\u7684\u60c5\u51b5\u6709 $(a_1+1)\\times (a_2+1)$ \u79cd\uff0c\u540c\u7406\uff0c\u53f3\u7aef\u70b9\u5728 $a_4,a_6,a_8 \\dots$ \u4e2d\u90fd\u5408\u6cd5\u3002\u5bb9\u6613\u63a8\u51fa\u7ed3\u8bba\uff1a\u5f53\u4e14\u4ec5\u5f53\u67d0\u533a\u95f4\u5de6\u53f3\u7aef\u70b9\u6240\u5728\u533a\u95f4\u4e0b\u6807\u5947\u5076\u6027\u4e0d\u540c\uff0c\u533a\u95f4\u5185\u6709\u5947\u6570\u4e2a $1$\uff0c\u8bc1\u660e\u663e\u7136\u3002</p> <p>\u90a3\u4e48\u603b\u533a\u95f4\u4e2a\u6570\u5c31\u53ef\u4ee5\u7528\u4ee5\u4e0b\u5f0f\u5b50\u8868\u793a\uff1a</p> <p>$$ \\begin{aligned} &amp;\\sum_{i \\equiv 1\\pmod 2}^{1 \\le i \\le k+1}(a_i+1)\\times\\sum_{j\\equiv 0\\pmod 2}^{1 \\le j \\le k+1} (a_j+1)\\\\ =&amp;\\left(\\left\\lceil\\dfrac{k+1}{2}\\right\\rceil+\\sum_{i \\equiv 1 \\pmod 2}^{1 \\le i \\le k+1}a_i\\right)\\times\\left(\\left\\lfloor\\dfrac{k+1}{2}\\right\\rfloor+\\sum_{j \\equiv 0 \\pmod 2}^{1 \\le j \\le k+1}a_j\\right) \\end{aligned} $$</p> <p>\u5bb9\u6613\u53d1\u73b0\u7b54\u6848\u4ec5\u4e0e $\\sum_{i \\equiv 1 \\pmod 2}^{1 \\le i \\le k+1}a_i$ \u548c $\\sum_{j \\equiv 0 \\pmod 2}^{1 \\le j \\le k+1}a_j$  \u6709\u5173\uff0c\u5047\u5982\u628a\u5b83\u4eec\u5206\u522b\u770b\u505a\u4e24\u4e2a\u6574\u4f53 $x$ \u548c $y$\uff0c\u90a3\u4e48\u5f0f\u5b50\u5c31\u80fd\u5316\u6210\u8fd9\u6837\uff1a</p> <p>$$\\left(\\left\\lceil\\dfrac{k+1}{2}\\right\\rceil+x\\right)\\left(\\left\\lfloor\\dfrac{k+1}{2}\\right\\rfloor+y\\right)$$</p> <p>\u53e6\u5916\u5bb9\u6613\u53d1\u73b0 $x+y=n-k$\uff0c\u8bc1\u660e\u663e\u7136\uff0c\u90a3\u4e48 $y=n-k-x$\uff0c\u5e26\u5165\u539f\u5f0f\uff1a</p> <p>$$\\left(\\left\\lceil\\dfrac{k+1}{2}\\right\\rceil+x\\right)\\left(\\left\\lfloor\\dfrac{k+1}{2}\\right\\rfloor+n-k-x\\right)$$</p> <p>\u5bb9\u6613\u53d1\u73b0\u8fd9\u662f\u4e2a\u5173\u4e8e $x$ \u7684\u4e8c\u6b21\u51fd\u6570\u4e14\u5f00\u53e3\u5411\u4e0b\uff0c\u5316\u6210\u4e00\u822c\u5f0f\u627e\u5230\u5bf9\u79f0\u8f74\u6c42\u6700\u5927\u503c\uff0c\u8fc7\u7a0b\u7565\u3002\u603b\u4e4b\u5f53 $x=\\frac{n-k}{2}$ \u65f6 $f(x)$ \u53d6\u5230\u6700\u5927\u503c\u3002</p> <p>\u53e6\u5916\u5bb9\u6613\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u7684\u5927\u5c0f\u548c $x,y$ \u5177\u4f53\u5206\u7ed9\u54ea\u4e2a $a_i$ \u65e0\u5173\uff0c\u6545\u6784\u9020\u65b9\u6848\u65f6\u53ef\u4ee5\u76f4\u63a5\u628a $a_1\\sim a_{k-1}$ \u5168\u90e8\u53d6\u4e3a $0$\uff08\u5373\u8f93\u51fa\u4e00\u5806 $1$\uff09\uff0c\u7136\u540e\u628a $n-k$ \u5206\u7ed9\u540e\u9762\u4e24\u4e2a\u7a7a\u3002</p>"},{"location":"solution/20230626B_ABC/#code","title":"code","text":"<pre><code>//author: six-floor-slip-liu\n#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(i64 i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(i64 i=(s);i&gt;=(e);i--)\nusing namespace std;\nusing i64=long long;\n#define gc getchar()\ninline i64 read(){\ni64 x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst i64 N=1e5+5,inf=0x3f3f3f3f;\ni64 n,k;\nsigned main(){\nn=read();k=read();\nif(k==0){//\u4e00\u5b9a\u8981\u8bb0\u5f97\u7279\u5224 0\uff01\uff01\uff01\nputs(\"0\");\nforup(i,1,n){\nprintf(\"0 \");\n}\n}\ni64 l=(n-k)/2,r=n-k-l;\nif(k&amp;1){\nprintf(\"%lld\\n\",(l+(k+1)/2)*(r+(k+1)/2));\n}else{\nif(l&lt;r) swap(l,r);\nprintf(\"%lld\\n\",(l+k/2)*(r+k/2+1));\n}\nforup(i,1,k-1){\nprintf(\"1 \");\n}\nforup(i,1,l){\nprintf(\"0 \");\n}\nprintf(\"1 \");\nforup(i,1,r){\nprintf(\"0 \");\n}\n}\n</code></pre>"},{"location":"solution/20230626B_ABC/#t2","title":"T2","text":"<p>\u6ce8\uff1a\u672c\u6587\u4e2d\u79f0\u6ee1\u8db3\u201c\u533a\u95f4\u5185\u989c\u8272\u4e24\u4e24\u4e0d\u540c\u201d\u7684\u533a\u95f4\u4e3a\u5408\u6cd5\u3002</p> <p>\u9996\u5148\u8003\u8651\u5047\u5982\u53ea\u6709\u4e00\u4e2a\u533a\u95f4\uff0c\u6216\u8005\u8bf4\u5047\u8bbe\u662f\u6c42\u67d0\u4e2a\u5e8f\u5217\u5728\u54ea\u6b21\u4fee\u6539\u540e\u624d\u5408\u6cd5\u5e94\u8be5\u5982\u4f55\u89e3\u51b3\u3002</p> <p>\u663e\u800c\u6613\u89c1\uff0c\u53ea\u7528\u5bf9\u8fd9\u4e2a\u533a\u95f4\u5f00\u4e2a\u6876\u52a8\u6001\u7edf\u8ba1\u6bcf\u79cd\u989c\u8272\u662f\u5426\u53ea\u51fa\u73b0\u4e86\u4e00\u6b21\u5c31\u884c\u4e86\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u548c\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f\u7ebf\u6027\u7684\u3002</p> <p>\u4f46\u662f\u8fd9\u9053\u9898\u533a\u95f4\u7684\u6570\u91cf\u662f $O(n)$ \u7ea7\u522b\u7684\uff0c\u8fd9\u6837\u7a7a\u95f4\u590d\u6742\u5ea6\u548c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u53d8\u6210\u4e86\u5e73\u65b9\u7ea7\u522b\uff0c\u53cc\u53cc\u8d85\u6807\uff0c\u8003\u8651\u5982\u4f55\u4f18\u5316\u3002</p> <p>\u9996\u5148\u6876\u662f\u80af\u5b9a\u4e0d\u80fd\u7528\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u67d0\u79cd\u6570\u636e\u7ed3\u6784\u4ee3\u66ff\u6876\uff0c\u6bd4\u5982\u52a8\u6001\u5f00\u70b9\u6743\u503c\u7ebf\u6bb5\u6811\u6216\u8005\u5e73\u8861\u6811\u3002\u4f46\u6211\u4eec\u663e\u7136\u4e0d\u80fd\u5b58\u5b8c\u6bcf\u4e2a\u533a\u95f4\u4e2d\u6240\u6709\u989c\u8272\uff0c\u4e0d\u7136\u7a7a\u95f4\u590d\u6742\u5ea6\u4e0d\u964d\u53cd\u589e\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u65b9\u6cd5\u6765\u91cd\u590d\u5229\u7528\u7a7a\u95f4\u3002</p> <p>\u770b\u5230\u9898\u9762\u4e0a\u6709\u8fd9\u4e48\u4e00\u53e5\u8bdd\uff1a</p> <p>\u4fdd\u8bc1\u4efb\u4f55\u4e24\u4e2a\u533a\u95f4\u90fd\u662f\u4e0d\u76f8\u4ea4\u6216\u5305\u542b\u7684\u5173\u7cfb\u3002</p> <p>\u8fd9\u5c31\u6697\u793a\u6211\u4eec\u8fd9\u9053\u9898\u7684\u505a\u6cd5\u548c\u533a\u95f4\u7684\u5173\u7cfb\u6709\u5173\uff0c\u8003\u8651\u6309\u8986\u76d6\u5173\u7cfb\u8fde\u8fb9\u4f1a\u8fde\u6210\u4ec0\u4e48\u6837\u3002</p> <p></p> <p>\u5bb9\u6613\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u6811\u5f62\u7ed3\u6784\uff0c\u800c\u4e14\u6709\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u6027\u8d28\uff1a</p> <p>\u4e00\u4e2a\u533a\u95f4\uff08\u4ee5\u4e0b\u53ef\u4ee5\u8ba4\u4e3a\u201c\u533a\u95f4\u201d\u548c\u201c\u7ed3\u70b9\u201d\u662f\u540c\u4e49\u8bcd\uff09\u5408\u6cd5\u7684\u5fc5\u8981\u6761\u4ef6\u662f\u5b83\u5b50\u6811\u5185\u6240\u6709\u7ed3\u70b9\u5747\u5408\u6cd5\u3002</p> <p>\u6216\u8005\u6362\u53e5\u8bdd\u8bf4\uff0c\u5047\u5982\u4e00\u4e2a\u7ed3\u70b9\u4e0d\u5408\u6cd5\uff0c\u90a3\u4e48\u5b83\u6240\u6709\u7956\u5148\u5747\u4e0d\u5408\u6cd5\u3002\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u6bcf\u6b21\u53ea\u9700\u8981\u8003\u8651\u6240\u6709\u53f6\u5b50\u7ed3\u70b9\u662f\u5426\u5408\u6cd5\uff0c\u5047\u5982\u5b83\u5408\u6cd5\u4e86\u624d\u9700\u8981\u8003\u8651\u5b83\u7684\u7956\u5148\u3002\u800c\u6240\u6709\u53f6\u5b50\u7ed3\u70b9\u6240\u8986\u76d6\u7684\u533a\u95f4\u957f\u5ea6\u548c\u662f $O(n)$ \u7684\uff0c\u8fd9\u5c31\u975e\u5e38\u68d2\u4e86\u3002</p> <p>\u6ce8\u610f\u5230\u9898\u9762\u4e2d\u8981\u6c42\u7684\u662f\u6bcf\u4e2a\u7ed3\u70b9\u7b2c\u4e00\u6b21\u5408\u6cd5\u7684\u65f6\u95f4\u6233\uff0c\u4e5f\u5c31\u662f\u8bf4\u5047\u5982\u67d0\u4e2a\u7ed3\u70b9\u5408\u6cd5\u4e86\u540e\u9762\u5c31\u4e0d\u7528\u7ba1\u5b83\u4e86\uff0c\u53ef\u4ee5\u76f4\u63a5\u5220\u6389\u5b83\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u76f4\u63a5\u628a\u5b50\u7ed3\u70b9\u7684\u7a7a\u95f4\u4ea4\u7ed9\u7236\u7ed3\u70b9\uff0c\u65b9\u4fbf\u5feb\u6377\u3002\uff08\u6211\u4e0d\u4f1a\u544a\u8bc9\u4f60\u6211\u8d5b\u65f6\u5c31\u662f\u6ca1\u60f3\u5230\u8fd9\u4e00\u5c42\u62a5\u7075\u4e86\u3002\uff09</p> <p>\u201c\u628a\u5b50\u7ed3\u70b9\u7684\u7a7a\u95f4\u4ea4\u7ed9\u7236\u7ed3\u70b9\u201d\u662f\u4e2a\u5408\u5e76\u7684\u8fc7\u7a0b\uff0c\u8fd9\u9053\u9898\u7ebf\u6bb5\u6811\u5408\u5e76\u548c\u542f\u53d1\u5f0f\u5408\u5e76\u90fd\u53ef\u505a\uff0c\u5b9e\u6d4b\u542f\u53d1\u5f0f\u66f4\u5feb\u66f4\u77ed\u7a7a\u95f4\u66f4\u5c0f\u3002</p> <p>\u53e6\u5916\u6211\u4eec\u9700\u8981\u5feb\u901f\u6c42\u51fa\u5e8f\u5217\u4e0a\u6bcf\u4e2a\u70b9\u5bf9\u5e94\u7684\u6700\u6df1\u7684\u7ed3\u70b9\u662f\u54ea\u4e2a\uff0c\u6211\u7528\u4e86\u4e2a\u6570\u7ec4+DSU \u4e71\u641e\uff0c\u4e0d\u60f3\u52a8\u8111\u5b50\u7684\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u3002</p>"},{"location":"solution/20230626B_ABC/#code_1","title":"code","text":"<p>\u8fd9\u91cc\u63d0\u4f9b\u4e24\u4efd\u4ee3\u7801\u3002</p> <p>\u542f\u53d1\u5f0f\u5408\u5e76\u53c2\u8003\u4ee3\u7801</p> <pre><code>//author: six-floor-slip-liu\n#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(int i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst int N=5e5+5,inf=0x3f3f3f3f;\nint n,m,t,c[N],res;\nbitset&lt;N&gt; bs;\nint ff[N],blg[N],cnts[N],sz[N],pres[N];\nstruct que{\nint l,r,pos;\nbool operator &lt;(const que &amp;pp)const{\nif(l!=pp.l) return l&lt;pp.l;\nreturn r&gt;pp.r;\n}\n}s[N];\nmap&lt;int,int&gt; mp[N];\nint rt[N];\nvoid merge(int U,int V){\nif(mp[rt[U]].size()&lt;mp[rt[V]].size()) swap(rt[U],rt[V]);\nfor(auto i:mp[rt[V]]){\nmp[rt[U]][i.first]+=i.second;\n}\nmp[rt[V]].clear();\n}\nvoid buildtree(){\nint stk[N],top=1;\nstk[top++]=0;\ns[0].l=-1;s[0].r=n+1;\nint nw;\nforup(i,1,m){\nwhile(stk[top-1]!=0&amp;&amp;s[stk[top-1]].r&lt;s[i].l){\nif(sz[stk[top-1]]==0){\nforup(j,s[stk[top-1]].l,s[stk[top-1]].r){\nblg[j]=stk[top-1];\n}\n}else{\nforup(j,s[pres[stk[top-1]]].r+1,min(s[i].l-1,s[stk[top-1]].r)){\nblg[j]=stk[top-1];\n}\n}\nnw=stk[top-1];\ntop--;\nff[nw]=stk[top-1];\nif(sz[stk[top-1]]==0){\nforup(j,s[stk[top-1]].l,s[nw].l-1){\nblg[j]=stk[top-1];\n}\n}\nsz[stk[top-1]]++;\npres[stk[top-1]]=nw;\n}\nstk[top++]=i;\n}\nwhile(stk[top-1]!=0){\nif(sz[stk[top-1]]==0){\nforup(j,s[stk[top-1]].l,s[stk[top-1]].r){\nblg[j]=stk[top-1];\n}\n}else{\nforup(j,s[pres[stk[top-1]]].r+1,s[stk[top-1]].r){\nblg[j]=stk[top-1];\n}\n}\nnw=stk[top-1];\ntop--;\nff[nw]=stk[top-1];\nif(sz[stk[top-1]]==0){\nforup(j,s[stk[top-1]].l,s[nw].l-1){\nblg[j]=stk[top-1];\n}\n}\nsz[stk[top-1]]++;\npres[stk[top-1]]=nw;\n}\n}\nint fa[N];\nint getfa(int x){return x==fa[x]?x:fa[x]=getfa(fa[x]);}\nbool chk(int x){\nif(x==0) return false;\nreturn (int)mp[rt[x]].size()==s[x].r-s[x].l+1;\n}\nvoid work(int x,int CASE){\nif(chk(getfa(blg[x]))){\nint l=getfa(blg[x]);\nwhile(chk(l)){\nres^=CASE;\nbs[l]=true;\nmerge(ff[l],l);\ncnts[ff[l]]++;\nfa[l]=ff[l];\nl=getfa(l);\n}\n}\n}\nvoid add(int x,int c){\nmp[rt[x]][c]++;\n}\nvoid del(int x,int c){\nint qwer=--mp[rt[x]][c];\nif(qwer==0){\nmp[rt[x]].erase(c);\n}\n}\nvoid solve(){\nforup(i,1,n){\nadd(blg[i],c[i]);\n}\nforup(i,1,n){\nwork(i,0);\n}\nforup(CASE,1,t){\nint x=read(),y=read();\ndel(getfa(blg[x]),c[x]);\nc[x]=y;\nadd(getfa(blg[x]),c[x]);\nwork(x,CASE);\n}\n}\nsigned main(){\nn=read();m=read();t=read();\nforup(i,1,n){\nc[i]=read();\n}\nforup(i,1,m){\ns[i].l=read();s[i].r=read();s[i].pos=i;\nfa[i]=i;rt[i]=i;\n}\nsort(s+1,s+m+1);\nbuildtree();\nsolve();\nforup(i,1,m){\nif(!bs[i]){\nres^=m+s[i].pos;\n}\n}\nprintf(\"%d\",res);\n}\n</code></pre> <p>\u7ebf\u6bb5\u6811\u5408\u5e76\u53c2\u8003\u4ee3\u7801</p> <pre><code>//author: six-floor-slip-liu\n#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(int i=(s);i&gt;=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst int N=5e5+5,inf=0x3f3f3f3f;\nint n,m,t,c[N],ans[N],res;\nint ff[N],blg[N],cnts[N],sz[N],pres[N];\nstruct que{\nint l,r,pos;\nbool operator &lt;(const que &amp;pp)const{\nif(l!=pp.l) return l&lt;pp.l;\nreturn r&gt;pp.r;\n}\n}s[N];\nstruct SegmentTree{\n#define mid ((l+r)&gt;&gt;1)\n#define lson l,mid,ls[id]\n#define rson mid+1,r,rs[id]\nprivate:\nint querycnt[N*40],ls[N*40],rs[N*40],rt[N],cntseg;\nbitset&lt;N*40&gt; queryleg;//bitset \u662f\u6211\u7239\uff0c\u8fd9\u91cc\u4e0d\u538b\u4f4d\u4f1a MLE\nvoid _New(int &amp;k){\nk=++cntseg;\n}\nvoid _PushUp(int id){\nqueryleg[id]=true;\nif(ls[id]^0) querycnt[id]+=querycnt[ls[id]],queryleg[id]=queryleg[id]&amp;queryleg[ls[id]];\nif(rs[id]^0) querycnt[id]+=querycnt[rs[id]],queryleg[id]=queryleg[id]&amp;queryleg[rs[id]];\n}\nvoid _Insert(int X,int P,int l,int r,int id){\nif(l==r){\nquerycnt[id]+=P;\nqueryleg[id]=(querycnt[id]&lt;=1);\nreturn;\n}\nif(X&lt;=mid){\nif(ls[id]==0) _New(ls[id]);\n_Insert(X,P,lson);\n}else{\nif(rs[id]==0) _New(rs[id]);\n_Insert(X,P,rson);\n}\n_PushUp(id);\n}\nint _Merge(int U,int V,int l,int r){\nif(!U) return V;\nif(!V) return U;\nif(l==r){\nquerycnt[U]+=querycnt[V];\nqueryleg[U]=(querycnt[U]&lt;=1);\nreturn U;\n}\nls[U]=_Merge(ls[U],ls[V],l,mid);\nrs[U]=_Merge(rs[U],rs[V],mid+1,r);\n_PushUp(U);\nreturn U;\n}\npublic:\nvoid Insert(int X,int P,int U){\nif(!rt[U]) _New(rt[U]);\n_Insert(X,P,1,n,rt[U]);\n}\nvoid Merge(int U,int V){\nif(!rt[U]) _New(rt[U]);\nrt[U]=_Merge(rt[U],rt[V],1,n);\n}\nbool Ask(int U){\nreturn queryleg[rt[U]];\n}\n}mt;\nvoid buildtree(){\nint stk[N],top=1;\nstk[top++]=0;\ns[0].l=-1;s[0].r=n+1;\nint nw;\nforup(i,1,m){\nwhile(stk[top-1]!=0&amp;&amp;s[stk[top-1]].r&lt;s[i].l){\nif(sz[stk[top-1]]==0){\nforup(j,s[stk[top-1]].l,s[stk[top-1]].r){\nblg[j]=stk[top-1];\n}\n}else{\nforup(j,s[pres[stk[top-1]]].r+1,min(s[i].l-1,s[stk[top-1]].r)){\nblg[j]=stk[top-1];\n}\n}\nnw=stk[top-1];\ntop--;\nff[nw]=stk[top-1];\nif(sz[stk[top-1]]==0){\nforup(j,s[stk[top-1]].l,s[nw].l-1){\nblg[j]=stk[top-1];\n}\n}\nsz[stk[top-1]]++;\npres[stk[top-1]]=nw;\n}\nstk[top++]=i;\n}\nwhile(stk[top-1]!=0){\nif(sz[stk[top-1]]==0){\nforup(j,s[stk[top-1]].l,s[stk[top-1]].r){\nblg[j]=stk[top-1];\n}\n}else{\nforup(j,s[pres[stk[top-1]]].r+1,s[stk[top-1]].r){\nblg[j]=stk[top-1];\n}\n}\nnw=stk[top-1];\ntop--;\nff[nw]=stk[top-1];\nif(sz[stk[top-1]]==0){\nforup(j,s[stk[top-1]].l,s[nw].l-1){\nblg[j]=stk[top-1];\n}\n}\nsz[stk[top-1]]++;\npres[stk[top-1]]=nw;\n}\n}\nint fa[N];\nint getfa(int x){return x==fa[x]?x:fa[x]=getfa(fa[x]);}\nbool chk(int x){\nif(x==0) return false;\nif(cnts[x]!=sz[x]) return false;\nreturn mt.Ask(x);\n}\nvoid work(int x,int CASE){\nif(chk(getfa(blg[x]))){\nint l=getfa(blg[x]);\nwhile(chk(l)){\nans[l]=CASE;\nmt.Merge(ff[l],l);\ncnts[ff[l]]++;\nfa[l]=ff[l];\nl=getfa(l);\n}\n}\n}\nvoid solve(){\nforup(i,1,n){\nmt.Insert(c[i],1,blg[i]);\n}\nforup(i,1,n){\nwork(i,0);\n}\nforup(CASE,1,t){\nint x=read(),y=read();\nmt.Insert(c[x],-1,getfa(blg[x]));\nc[x]=y;\nmt.Insert(c[x],1,getfa(blg[x]));\nwork(x,CASE);\n}\n}\nsigned main(){\nn=read();m=read();t=read();\nforup(i,1,n){\nc[i]=read();\n}\nmem(ans,-1);\nforup(i,1,m){\ns[i].l=read();s[i].r=read();s[i].pos=i;\nfa[i]=i;\n}\nsort(s+1,s+m+1);\nbuildtree();\nsolve();\nforup(i,1,m){\nif(ans[i]!=-1){\nres^=ans[i];\n}else{\nres^=m+s[i].pos;\n}\n}\nprintf(\"%d\",res);\n}\n</code></pre> <p>\u4ee3\u7801\u597d\u4ed6\u5988\u957f\u3002</p>"},{"location":"solution/20230626B_ABC/#t3","title":"T3","text":"<p>\u8fd9\u9053\u9898 @GM_Joanna \u8bf4\u5f88\u7b80\u5355\uff0c\u6211\u89c9\u5f97\u4e5f\u4e0d\u96be\uff0c\u4f46\u662f\u5b9e\u73b0\u7ec6\u8282\u6ca1\u641e\u61c2\u62a5\u7075\u4e86\u3002</p> <p>\u9996\u5148\u770b\u5230\u6700\u957f\u8ddd\u79bb\u5bb9\u6613\u60f3\u5230\u6811\u7684\u76f4\u5f84\u7684\u6027\u8d28\uff1a</p> <p>\u5b9a\u7406\uff1a\u5728\u4e00\u68f5\u6811\u4e0a\uff0c\u4e0e\u4efb\u610f\u8282\u70b9 $y$ \u8ddd\u79bb\u6700\u8fdc\u7684\u8282\u70b9 $z$ \u5fc5\u4e3a\u76f4\u5f84\u7684\u4e00\u7aef\u3002</p> <p>\u6458\u81ea OI Wiki\uff0c\u8bc1\u660e\u8fd9\u4e2a\u94fe\u63a5\u91cc\u6709\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\u65e0\u8bba\u600e\u4e48\u67d3\u8272\u8ddd\u79bb\u6700\u8fdc\u7684\u4e24\u540c\u8272\u70b9\u5176\u4e2d\u4e00\u4e2a\u5fc5\u5b9a\u662f\u76f4\u5f84\u7aef\u70b9\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u6c42\u51fa\u4e86\u76f4\u5f84\u4e3a $AB$\u3002</p> <p>\u9996\u5148\u8003\u8651\u65e0\u8bba\u600e\u4e48\u67d3\u8272\u4ef7\u503c\u90fd\u7b49\u4e8e\u76f4\u5f84\u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u60c5\u51b5\u5fc5\u7136\u5b58\u5728\u4e00\u4e2a\u7ed3\u70b9 $C$\uff0c\u4f7f\u5f97 $AB=AC=BC$\uff0c\u6613\u8bc1\u8fd9\u662f\u4e2a\u5145\u5206\u5fc5\u8981\u6761\u4ef6\uff0c\u56e0\u4e3a\u65e0\u8bba\u600e\u4e48\u6d82\u8272 $ABC$ \u4e09\u70b9\u81f3\u5c11\u6709\u4e24\u4e2a\u540c\u8272\u3002</p> <p>\u6392\u9664\u8fd9\u79cd\u60c5\u51b5\u540e\u8fd8\u53ef\u80fd\u51fa\u73b0 $AB=AC \\ne BC$ \u7684\u60c5\u51b5\uff0c\u4f46\u8fd9\u65e0\u6240\u8c13\uff0c\u540e\u9762\u4f1a\u53d1\u73b0\u5b83\u4e0d\u5f71\u54cd\u7ed3\u679c\u3002</p> <p>\u9996\u5148\u8003\u8651\u76f4\u5f84\u4e24\u7aef\u70b9\u540c\u8272\u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u60c5\u51b5\u603b\u7684\u8d21\u732e\u5c31\u662f $2^{n-2}\\times length\\;of\\;diameter\\times 2$\uff0c\u540e\u9762\u8981\u4e58\u4e8c\u7684\u539f\u56e0\u662f\u6bcf\u79cd\u60c5\u51b5\u5168\u90e8\u53cd\u8272\u4e5f\u662f\u4e00\u79cd\u60c5\u51b5\uff0c\u8fd9\u5f88\u597d\u7b97\uff0c\u800c\u4e14\u53ef\u4ee5\u6392\u9664\u4e00\u79cd\u5728\u901a\u5e38\u60c5\u51b5\u4e0b\u5f88\u96be\u5904\u7406\u7684\u60c5\u51b5\u3002</p> <p>\u7136\u540e\u6392\u9664\u8fd9\u4e24\u4e2a\u70b9\u540e\uff0c\u5bb9\u6613\u53d1\u73b0\u5176\u5b83\u70b9\u8ddd\u79bb\u4e24\u76f4\u5f84\u6709\u4e24\u4e2a\u8ddd\u79bb\uff08\u8fd9\u4e0d\u4e00\u773c\u5c31\u770b\u51fa\u6765\u4e86\u5417\uff09\uff0c\u8bbe\u5176\u4e2d\u6bd4\u8f83\u5927\u7684\u4e3a $L_i$\uff0c\u53e6\u4e00\u4e2a\u4e3a $S_i$\uff0c\u6709\u4e00\u4e2a\u663e\u7136\u7684\u7ed3\u8bba\uff1a\u65e0\u8bba\u5982\u4f55\u6d82\u8272\uff0c\u8fd9\u68f5\u6811\u7684\u4ef7\u503c\u5fc5\u7136\u5927\u4e8e\u7b49\u4e8e $\\max{S_i}$\u3002\u56e0\u4e3a\u7531\u4e8e\u76f4\u5f84\u4e24\u7aef\u70b9\u5f02\u8272\uff0c\u65e0\u8bba\u5982\u4f55\u6d82\u8272\u53d6\u5230 $\\max{S_i}$ \u7684\u8fd9\u4e2a\u70b9\u4e0e\u540c\u8272\u7aef\u70b9\u7684\u8ddd\u79bb\u5fc5\u7136\u5927\u4e8e\u7b49\u4e8e $S_i$\uff0c\u5f97\u8bc1\u3002</p> <p>\u8003\u8651\u4f55\u65f6\u80fd\u4f7f\u4ef7\u503c\u7b49\u4e8e\u4e00\u4e2a\u70b9 $i$ \u7684 $L_i$\uff0c\u53d1\u73b0\u80fd\u53d6\u5230 $L_i$ \u5f53\u4e14\u4ec5\u5f53 $L_i \\ge \\max{S}$ \u4e14\u5bf9\u4e8e\u6240\u6709 $j$ \u4f7f\u5f97 $L_j&gt;L_i$\uff0c$j$ \u53d6\u5230\u6700\u5c0f\u503c\uff0c$L$ \u66f4\u5c0f\u7684\u968f\u4fbf\u53d6\u5373\u53ef\u3002\u53d1\u73b0\u8fd9\u662f\u53ef\u4ee5\u6784\u9020\u51fa\u6765\u7684\uff0c\u53ea\u8981\u6bcf\u4e2a\u70b9\u53d6\u4e0e\u67d0\u4e2a\u5408\u9002\u7684\u76f4\u5f84\u7aef\u70b9\u76f8\u540c\u7684\u989c\u8272\u5373\u53ef\u3002\u5bf9\u4e8e $L_i&lt;\\max{S}$ \u7684\u60c5\u51b5\uff0c\u6211\u4eec\u4e5f\u5047\u8bbe\u5b83\u4ea7\u751f\u4e86 $\\max(L_i,\\max{S})$ \u7684\u8d21\u732e\uff0c\u8fd9\u6837\u5b9e\u73b0\u8d77\u6765\u6bd4\u8f83\u65b9\u4fbf\u3002\u8fd9\u6837\u5c31\u80fd\u5217\u51fa\u5f0f\u5b50\uff1a</p> <p>$$\\max(L_i,\\max{S})\\times 2^{Number\\;of\\;nodes\\;with\\;L\\;less\\;than\\;L_i}\\times 2$$</p> <p>\u4f46\u4e0a\u9762\u7684\u5f0f\u5b50\u53ea\u8003\u8651\u4e86 $L_i$ \u4e24\u4e24\u4e0d\u540c\u7684\u60c5\u51b5\uff0c\u5bf9\u4e8e $L_i$ \u76f8\u540c\u7684\u6570\u4e2a\u7ed3\u70b9\uff0c\u6211\u4eec\u53d1\u73b0\u5047\u8bbe\u5c06\u5b83\u4eec\u968f\u610f\u6392\u5e8f\u7136\u540e\u628a\u6392\u5e8f\u540e $L$ \u6bd4 $i$ \u9760\u524d\u7684\u5168\u89c6\u4e3a\u6bd4\u5b83\u5c0f\u6765\u8ba1\u7b97\u4ecd\u7136\u662f\u4e0d\u91cd\u4e0d\u6f0f\u7684\uff0c\u6545\u6211\u4eec\u53ef\u4ee5\u628a\u6240\u6709\u7ed3\u70b9\u6309 $L_i$ \u5347\u5e8f\u6392\u5217\uff0c\u7136\u540e\u603b\u7684\u4ef7\u503c\u5c31\u662f\uff1a</p> <p>$$\\max(L_i,\\max{S})\\times 2^{i-1}\\times 2$$</p> <p>OK \u5230\u8fd9\u4e00\u6b65\u5c31\u57fa\u672c\u7ed3\u675f\u4e86\uff0c\u4f46\u60f3\u60f3\u6211\u4eec\u6f0f\u6389\u4e86\u4ec0\u4e48\uff1f\u6211\u4eec\u6ca1\u8003\u8651\u5168\u90fd\u53d6\u8f83\u5c0f\u503c\u7684\u60c5\u51b5\uff0c\u5bb9\u6613\u53d1\u73b0\u53ea\u80fd\u6784\u9020\u51fa\u4e24\u7ec4\u8fd9\u6837\u7684\u6d82\u8272\u65b9\u6848\uff0c\u4ef7\u503c\u4e3a $\\max{S}$\u3002</p> <p>\u7efc\u4e0a\uff0c\u5206\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u8003\u8651\u3002</p> <ul> <li>$AB=BC=AC,ans=2^{n+1} \\times length\\;of\\;diameter$</li> <li>$else,ans=2^{n-1}\\times length\\;of\\;diameter+\\left(\\sum\\limits_{i-1}^n \\max(L_i,\\max{S}) \\times 2^i\\right)+\\max{S}\\times 2$</li> </ul>"},{"location":"solution/20230626B_ABC/#code_2","title":"code","text":"<pre><code>//author: six-floor-slip-liu\n#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(i64 i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(i64 i=(s);i&gt;=(e);i--)\nusing namespace std;\nusing i64=long long;\n#define gc getchar()\ninline i64 read(){\ni64 x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst i64 N=1e6+5,inf=1e18,mod=1e9+7;\ni64 n,rt1,rt2,ans;\nvector&lt;i64&gt; e[N];\ni64 dpt1[N],dpt2[N];\nvoid dfs(i64 x,i64 fa){\ndpt1[x]=dpt1[fa]+1;\nfor(auto i:e[x]){\nif(i==fa) continue;\ndfs(i,x);\n}\n}\nvoid dfs2(i64 x,i64 fa){\ndpt2[x]=dpt2[fa]+1;\nfor(auto i:e[x]){\nif(i==fa) continue;\ndfs2(i,x);\n}\n}\ni64 ksm(i64 a,i64 b){\ni64 c=1;\nwhile(b){\nif(b&amp;1) (c*=a)%=mod;\n(a*=a)%=mod;\nb&gt;&gt;=1;\n}\nreturn c;\n}\ni64 mn=0;\nstruct Node{\ni64 mn,mx;\n}nd[N];\nbool cmp(Node a,Node b){\nif(a.mx!=b.mx) return a.mx&lt;b.mx;\nreturn a.mn&gt;b.mn;\n}\nsigned main(){\n//freopen(\"tree.in\",\"r\",stdin);\n//freopen(\"tree.out\",\"w\",stdout);\nn=read();\nforup(i,1,n-1){\ni64 u=read(),v=read();\ne[u].push_back(v);e[v].push_back(u);\n}\ndpt1[0]=dpt2[0]=-1;\ndfs(1,0);rt1=1;\nforup(i,1,n) if(dpt1[i]&gt;dpt1[rt1]) rt1=i;\ndfs(rt1,0);rt2=rt1;\nforup(i,1,n) if(dpt1[i]&gt;dpt1[rt2]) rt2=i;\ndfs2(rt2,0);\nforup(i,1,n){\nif(dpt1[i]==dpt1[rt2]&amp;&amp;dpt2[i]==dpt2[rt1]){\nprintf(\"%lld\",ksm(2,n)*dpt1[rt2]%mod);\nreturn 0;\n}\nnd[i]=Node{min(dpt1[i],dpt2[i]),max(dpt1[i],dpt2[i])};\nmn=max(mn,nd[i].mn);\n}\n(ans+=mn*2%mod)%=mod;\nans+=ksm(2,n-2)*dpt1[rt2]%mod*2%mod;\nsort(nd+1,nd+n+1,cmp);\nforup(i,1,n-2){\n(ans+=ksm(2,i)*max(mn,nd[i].mx)%mod)%=mod;\n}\nprintf(\"%lld\\n\",ans);\n}\n</code></pre>"},{"location":"solution/20230626B_ABC/#t4","title":"T4 \u9898\u89e3\u6233\u8fd9\u91cc","text":""},{"location":"solution/20230626B_D/","title":"20230626B \u6562\u89c8\u6c42","text":""},{"location":"solution/20230626B_D/#_1","title":"\u95f2\u626f \u524d\u8a00","text":"<p>\u672c\u6765\u60f3\u76f4\u63a5\u653e\u5230\u4e00\u8d77\u7684\u7ed3\u679c\u53d1\u73b0\u592a\u957f\u4e86\u4e0d\u65b9\u4fbf\u9605\u8bfb\u5c31\u5355\u72ec\u5f00\u4e00\u4e2a\u6587\u7ae0\u7b97\u9011\u3002</p> <p>\u5168\u6587\u6233\u8fd9\u91cc</p> <p>\u7531\u4e8e\u8bb2\u9898\u7684\u4eba\uff08\u6307 @Caiest_Oier\uff09\u81ea\u5df1\u6ca1\u6709\u5199\u4ee3\u7801\u6709\u4e9b\u5b9e\u73b0\u7ec6\u8282\u4ed6\u6ca1\u641e\u6e05\u695a\uff0c\u8bb2\u5f97\u6709\u70b9\u590d\u6742\uff0c\u5bfc\u81f4\u88ab\u5751\u4e86\u3002\u6211\u9644\u7684\u4ee3\u7801\u91cc\u7684\u6ce8\u91ca\u7684\u5185\u5bb9\u5c31\u662f\u5177\u4f53\u600e\u4e48\u88ab\u5751\u7684\uff0c\u5927\u5bb6\u770b\u4e2a\u4e50\u5b50\u5c31\u884c\u4e86o(\u2565\ufe4f\u2565)o\u3002</p>"},{"location":"solution/20230626B_D/#_2","title":"\u6b63\u6587","text":"<p>\u9996\u5148\u770b\u5230\u8fd9\u79cd\u9898\u80af\u5b9a\u8003\u8651\u6811\u5f62 DP\uff0c\u7531\u4e8e\u64cd\u4f5c\u4e8c\u7684\u5b58\u5728\u53ea\u7528\u5b50\u6811\u5185\u7684\u4fe1\u606f\u662f\u65e0\u6cd5\u8868\u793a\u4e00\u4e2a\u72b6\u6001\u7684\uff0c\u6545 DP \u72b6\u6001\u7684\u5b9a\u4e49\u8981\u7ed3\u5408\u5b50\u6811\u5916\u7684\u4fe1\u606f\u3002</p> <p>\u5bb9\u6613\u60f3\u5230\u8bbe $dp_{i,j}$ \u8868\u793a $i$ \u7684\u7956\u5148\u7684\u64cd\u4f5c\u4e8c\u589e\u91cf\u603b\u548c\u5728\u6a21 $K$ \u610f\u4e49\u4e0b\u4e3a $j$\uff0c$i$ \u7684\u5b50\u6811\u5185\u8fd8\u9700\u8981\u81f3\u5c11\u591a\u5c11\u6b21\u64cd\u4f5c\u3002</p> <p>\u6ce8\uff1a\u672c\u6587\u9664 DP \u8f6c\u79fb\u4e2d\u7684\u52a0\u6cd5\u5916\u5176\u4f59\u52a0\u6cd5\u8ba1\u7b97\u5747\u5728\u6a21 $K$ \u610f\u4e49\u4e0b\u8fdb\u884c\u3002</p> <p>\u9996\u5148\u4e0d\u8003\u8651\u5bf9 $i$ \u8fdb\u884c\u64cd\u4f5c\u4e8c\uff0c\u6613\u5f97\u8f6c\u79fb\u65b9\u7a0b\uff1a</p> <p>$$dp_{i,j}=dp_{ls(i),j}+dp_{rs(i),j}+w(i,j)$$</p> <p>\u5176\u4e2d $ls(i),rs(i)$ \u5206\u522b\u8868\u793a\u7ed3\u70b9 $i$ \u7684\u5de6\u53f3\u5b50\u6811\uff0c\u4e0b\u540c\u3002</p> <p>\u8fd9\u65f6\u5019\u773c\u5c16\u7684\u8bfb\u8005\uff08\u8fd9\u4e0d\u662f\u4e00\u773c\u5c31\u770b\u51fa\u6765\u5417\uff09\u5c31\u4f1a\u53d1\u73b0\u6211\u4eec\u5728\u8f6c\u79fb\u65b9\u7a0b\u7684\u540e\u9762\u52a0\u4e86\u4e00\u4e2a $w(i,j)$\uff0c\u8fd9\u8868\u793a\u7ed3\u70b9 $i$ \u5728\u52a0\u4e86 $j$ \u540e\u662f\u5426\u8fd8\u9700\u8981\u8fdb\u884c\u4e00\u6b21\u64cd\u4f5c $1$ \u4f7f\u5176\u5408\u6cd5\u3002</p> <p>\u7136\u540e\u518d\u8003\u8651\u64cd\u4f5c\u4e8c\uff0c\u5bb9\u6613\u53d1\u73b0\u4e00\u6b21\u64cd\u4f5c\u4e8c\u53ef\u4ee5\u4f7f $dp_{i,j}$ \u53d8\u6210 $dp_{i,k}+1$\uff0c\u6613\u5f97\u8f6c\u79fb\u65b9\u7a0b\u3002</p> <p>$$ dp_{i,j}=\\begin{cases} \\min\\limits_{k=0}^{K-1}{dp_{i,k}}+1,&amp;dp_{i,j}\\ne \\min\\limits_{k=0}^{K-1}{dp_{i,k}}\\\\ dp_{i,j} &amp;dp_{i,j}=\\min\\limits_{k=0}^{K-1}{dp_{i,k}} \\end{cases} $$</p> <p>\u7136\u540e\u4f60\u76f4\u63a5 DP \u5c31\u80fd\u83b7\u5f97 $30pts$ \u7684\u9ad8\u5206\uff08\u672c\u9898\u8d5b\u65f6\u6700\u9ad8\u5206 $5pts$\uff0c\u4f60\u63a8\u51fa\u8fd9\u4e2a DP \u5f0f\u5b50\u5c31\u53ef\u4ee5\u8584\u7eb1\u5168\u573a $11$ \u4eba\uff09\uff0c\u590d\u6742\u5ea6 $O(nK)$\u3002</p> <p>\u8003\u8651\u5982\u4f55\u4f18\u5316\uff0c\u5bb9\u6613\u53d1\u73b0\u5bf9\u4e8e\u540c\u4e00\u4e2a $i$\uff0c$dp_{i,j}$ \u53ea\u6709\u4e24\u79cd\u53d6\u503c\uff0c\u4e00\u79cd\u662f $\\min_{k=0}^{K-1}{dp_{i,k}}$\uff0c\u53e6\u4e00\u79cd\u662f $\\min_{k=0}^{K-1}{dp_{i,k}}+1$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e2a\u7ed3\u70b9\u53ea\u5b58\u4e00\u4e2a\u6700\u5c0f\u503c\uff0c\u7136\u540e\u7528\u67d0\u79cd\u4e1c\u897f\u5b58\u4e0b\u80fd\u53d6\u5230\u6700\u5c0f\u503c\u7684\u533a\u95f4\uff0c\u8bbe\u8fd9\u4e2a\u6700\u5c0f\u503c\u4e3a $f_i$\uff0c\u8003\u8651\u5982\u4f55\u8f6c\u79fb\u3002</p> <p>\u53e6\u5916\u5bb9\u6613\u53d1\u73b0\uff0c\u5bf9\u4e8e\u540c\u4e00\u4e2a $i$\uff0c$w(i,j)$ \u80fd\u53d6\u5230\u6700\u5c0f\u503c\u7684\u533a\u95f4\u53ea\u53ef\u80fd\u6709\u4e00\u4e2a\u6216\u8005\u4e24\u4e2a\uff0c\u8fd9\u4e2a\u6027\u8d28\u540e\u9762\u6709\u7528\u3002</p> <p>\u8bbe $f_{ls(i)},f_{rs(i)},f_{i}$ \u80fd\u53d6\u5230\u6700\u5c0f\u503c\u7684\u533a\u95f4\u5206\u522b\u662f $S(l),S(r),S(i)$\uff0c\u53c8\u8bbe $w(i,j)=0$ \u7684\u533a\u95f4\u4e3a $W$\uff0c\u6613\u5f97\u8f6c\u79fb\u65b9\u7a0b\uff1a</p> <p>$$ \\begin{cases} f_{i}=f_{ls(i)}+f_{rs(i)}, &amp;S(i)=W\\cap S(l)\\cap S(r); &amp;W\\cap S(l)\\cap S(r) \\ne \\varnothing\\\\ f_{i}=f_{ls(i)}+f_{rs(i)}+2, &amp;S(i)=W\\cup S(l) \\cup S(r); &amp;W \\cap S(l)=\\varnothing,W\\cap S(r)=\\varnothing,S(l)\\cap S(r)=\\varnothing\\\\ f_{i}=f_{ls(i)}+f_{rs(i)}+1, &amp;S(i)=(W \\cap S(l))\\cup(W\\cap S(r))\\cup (S(l)\\cap S(r)), &amp; else \\end{cases} $$</p> <p>\u81ea\u5df1\u60f3\u529e\u6cd5\u770b\uff0c\u592a\u957f\u4e86\u6211\u4e5f\u6ca1\u529e\u6cd5\uff0c\u4f60\u53ef\u4ee5\u8bd5\u8bd5 ctrl+A\u3002</p> <p>\u5f88\u597d\u7406\u89e3\uff0c\u6700\u5c0f\u503c\u80af\u5b9a\u662f\u4e09\u4e2a\u96c6\u5408\u5c3d\u91cf\u591a\u53d6\u6700\u5c0f\u503c\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u81ea\u5df1\u753b\u56fe\u63a8\u4e00\u63a8\u5c31\u884c\u4e86\u3002</p> <p>\u5047\u5982\u4f60\u7528 <code>bitset</code> \u5b9e\u73b0\u7684\u8bdd\uff0c\u590d\u6742\u5ea6\u662f $O(\\frac{nK}{w})$\uff0c\u53ef\u4ee5\u5f97 $50pts$\u3002</p> <p>\u63a5\u4e0b\u6765\u9686\u91cd\u4ecb\u7ecd\u6b63\u89e3\uff1a<code>set</code> \u5b58\u4e8c\u5143\u7ec4\u6a21\u62df\u533a\u95f4\u7684\u4ea4\u548c\u5e76\u3002</p> <p>\u7136\u540e\u8fd9\u5341\u4e94\u4e2a\u5b57\u82b1\u4e86\u6211 6.5kb \u7684\u4ee3\u7801\u6765\u5b9e\u73b0\u3002</p> <p>\u9996\u5148\u66b4\u529b\u5408\u5e76\u662f $O(n^2)$ \u7684\uff0c\u4f46\u5408\u5e76\u96c6\u5408\u6211\u4eec\u8fd8\u6709\u4e00\u79cd\u4f18\u5316\u7684\u65b9\u6cd5\uff0c\u542f\u53d1\u5f0f\u5408\u5e76\uff0c\u4f46\u662f\u8fd9\u8981\u6c42\u6211\u4eec\u5355\u6b21\u5408\u5e76\u7684\u590d\u6742\u5ea6\u662f $O(\\min(|S_1|,|S_2|))$\uff0c\u7531\u4e8e\u6c42\u4ea4\u9700\u8981\u904d\u5386\u4e24\u4e2a\u96c6\u5408\u8fd9\u663e\u7136\u662f\u505a\u4e0d\u5230\u7684\uff0c\u4f46\u662f\u7531\u4e8e\u6700\u521d\u6240\u6709\u96c6\u5408\u5185\u6700\u591a\u6709\u603b\u5171 $2n$ \u4e2a\u4e8c\u5143\u7ec4\uff0c\u800c\u4e00\u4e2a\u4e8c\u5143\u7ec4\u88ab\u5220\u6389\u4e86\u5c31\u518d\u4e5f\u4e0d\u4f1a\u56de\u6765\u4e86\uff0c\u5bf9\u5220\u9664\u8fdb\u884c\u52bf\u80fd\u5206\u6790\uff0c\u590d\u6742\u5ea6\u662f $O(n)$\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u4fee\u6539\u7684\u590d\u6742\u5ea6\uff0c\u6545\u53ef\u4ee5\u505a\u5230 $O(\\min(|S_1|,|S_2|))$\u3002</p> <p>\u5173\u4e8e\u5982\u4f55\u5b9e\u73b0\uff0c\u6211\u4eec\u5206\u522b\u8bb2\uff0c\u4ee5\u4e0b\u9ed8\u8ba4 $|S(l)|\\le|S(r)|$\u3002</p>"},{"location":"solution/20230626B_D/#siwcap-slcap-sr","title":"$S(i)=W\\cap S(l)\\cap S(r)$","text":"<p>\u9996\u5148\u5bb9\u6613\u53d1\u73b0 $W$ \u4e2d\u7684\u5143\u7d20\u975e\u5e38\u5c11\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5728\u904d\u5386 $S(l)$ \u7684\u65f6\u5019\u76f4\u63a5\u548c $W$ \u53d6\u4ea4\uff0c\u4ee3\u7801\u7247\u6bb5\u5982\u4e0b\uff08\u53d8\u91cf\u540d\u548c\u53d9\u8ff0\u4e0d\u7edf\u4e00\u4f46\u662f\u61d2\u5f97\u6539\u4e86\uff09\uff1a</p> <pre><code>bool _ad0(set&lt;pii&gt; &amp;a,set&lt;pii&gt; &amp;b,set&lt;pii&gt; &amp;c){\nset&lt;pii&gt;::iterator it=a.begin();\nfor(set&lt;pii&gt;::iterator ii=b.begin();ii!=b.end();){\npii i=*ii;\nif(it==a.end()){break;}\nif(i.se&lt;it-&gt;fi){++ii;continue;}\nif(i.fi&gt;it-&gt;se){++it;continue;}\nint nl=max(i.fi,it-&gt;fi),nr=min(i.se,it-&gt;se);\nset&lt;pii&gt;::iterator jt=c.upper_bound(mkp(nl,inf));\nif(jt!=c.end()){\nif(jt-&gt;fi&lt;=nr){\nreturn true;\n}\n}\nif(jt!=c.begin()){\nif(prev(jt)-&gt;se&gt;=nl){\nreturn true;\n}\n}\nif(i.se&gt;it-&gt;se){\n++it;\n}else{\n++ii;\n}\n}\nreturn false;\n}\n</code></pre> <p>\u8fd9\u4e2a\u51fd\u6570\u662f\u7528\u6765\u5224\u65ad\u4e09\u4e2a\u96c6\u5408\u6709\u6ca1\u6709\u4ea4\u7684\u3002</p> <p>\u7136\u540e\u8003\u8651\u5982\u4f55\u5b9e\u73b0\u5408\u5e76\u64cd\u4f5c\uff0c\u601d\u8def\u5f88\u7b80\u5355\uff0c\u9996\u5148\u50cf\u4e0a\u9762\u8fd9\u4e2a\u51fd\u6570\u4e00\u6837\u7b97\u51fa <code>nl,nr</code>\uff0c\u7136\u540e\u5728 $S(r)$ \u4e2d\u4ece\u8fd9\u4e24\u4e2a\u4f4d\u7f6e\u5207\u5f00\uff0c\u628a\u6ca1\u6709\u88ab $S(l)$ \u4e2d\u7684\u533a\u95f4\u5b8c\u5168\u8986\u76d6\u7684\u5168\u90e8\u5220\u6389\u3002</p> <pre><code>void split(int k,set&lt;pii&gt; &amp;a){\nset&lt;pii&gt;::iterator it=a.upper_bound(mkp(k,inf));\nif(it==a.begin()) return;\n--it;\nif(it-&gt;fi&gt;k||it-&gt;se&lt;k) return;\npii ii=*it;\na.erase(it);\nif(ii.fi&lt;=k-1) a.insert(mkp(ii.fi,k-1));\nif(k&lt;=ii.se)   a.insert(mkp(k,ii.se));\n}\nvoid intersect3(set&lt;pii&gt; &amp;a,set&lt;pii&gt; &amp;b,set&lt;pii&gt; &amp;c){\nset&lt;pii&gt;::iterator it=a.begin(),pt;\nint nw=-1;\nfor(set&lt;pii&gt;::iterator ii=b.begin();ii!=b.end();){\npii i=*ii;\nif(it==a.end()){break;}\nif(i.se&lt;it-&gt;fi){++ii;continue;}\nif(i.fi&gt;it-&gt;se){++it;continue;}\nint nl=max(i.fi,it-&gt;fi),nr=min(i.se,it-&gt;se);\nset&lt;pii&gt;::iterator jt,kt;\njt=c.upper_bound(mkp(nl,inf));\nif(jt!=c.begin()){\nif(prev(jt)-&gt;fi&lt;nl&amp;&amp;prev(jt)-&gt;se&gt;=nl){\nsplit(nl,c);\n}\n}\nkt=c.upper_bound(mkp(nr,inf));\nif(kt!=c.begin()){\nif(prev(kt)-&gt;se&gt;nr){\nsplit(nr+1,c);\n}\n}\npt=c.upper_bound(mkp(nw,inf));\nfor(set&lt;pii&gt;::iterator qt=pt;qt!=c.end()&amp;&amp;qt-&gt;se&lt;nl;){\nqt++;\nc.erase(prev(qt));\n}\nnw=nr;\nif(i.se&gt;it-&gt;se){\n++it;\n}else{\n++ii;\n}\n}\npt=c.upper_bound(mkp(nw,inf));\nfor(set&lt;pii&gt;::iterator qt=pt;qt!=c.end();){\nqt++;\nc.erase(prev(qt));\n}\n}\n</code></pre> <p>\u8fd9\u4e2a <code>split</code> \u540e\u9762\u8fd8\u4f1a\u7528\u5230\u3002</p>"},{"location":"solution/20230626B_D/#siwcup-slcup-sr","title":"$S(i)=W\\cup S(l)\\cup S(r)$","text":"<p>\u8fd9\u4e2a\u975e\u5e38\u7b80\u5355\uff0c\u56e0\u4e3a\u4f60\u53d1\u73b0\u8981\u6c42\u5e76\u65f6\u6240\u6709\u533a\u95f4\u5fc5\u5b9a\u662f\u6ca1\u6709\u4ea4\u7684\uff0c\u6240\u4ee5\uff1a</p> <pre><code>bool _ad2(set&lt;pii&gt; &amp;a,set&lt;pii&gt; &amp;b,set&lt;pii&gt; &amp;c){\nfor(auto i:a){\nset&lt;pii&gt;::iterator it=b.lower_bound(mkp(i.fi,0));\nif(it!=b.end()&amp;&amp;it-&gt;fi&lt;=i.se) return false;\nif(it!=b.begin()&amp;&amp;prev(it)-&gt;se&gt;=i.fi) return false;\nit=c.lower_bound(mkp(i.fi,0));\nif(it!=c.end()&amp;&amp;it-&gt;fi&lt;=i.se) return false;\nif(it!=c.begin()&amp;&amp;prev(it)-&gt;se&gt;=i.fi) return false;\n}\nfor(auto i:b){\nset&lt;pii&gt;::iterator it=c.lower_bound(mkp(i.fi,0));\nif(it!=c.end()&amp;&amp;it-&gt;fi&lt;=i.se) return false;\nif(it!=c.begin()&amp;&amp;prev(it)-&gt;se&gt;=i.fi) return false;\n}\nreturn true; }\nvoid union2(set&lt;pii&gt; &amp;a,set&lt;pii&gt; &amp;c){\nfor(auto i:a){\nc.insert(i);\n}\n}\n</code></pre> <p>\u8fd9\u4e2a\u590d\u6742\u5ea6\u4e3a\u4ec0\u4e48\u5bf9\u5462\uff1f\u5bb9\u6613\u53d1\u73b0 $|W|$ \u53ea\u53ef\u80fd\u7b49\u4e8e $1$ \u6216 $2$\uff0c\u51e0\u4e4e\u53ef\u4ee5\u770b\u505a\u5e38\u6570\u3002</p>"},{"location":"solution/20230626B_D/#siw-cap-slcupwcap-srcup-slcap-sr","title":"$S(i)=(W \\cap S(l))\\cup(W\\cap S(r))\\cup (S(l)\\cap S(r))$","text":"<p>\u8fd9\u4e2a\u76f4\u63a5\u7b97\u4e0d\u80fd\u505a\u5230 $O(\\min(|S(l)|,|S(r)|))$\uff0c\u8003\u8651\u5316\u4e00\u4e0b\u5f0f\u5b50\u3002</p> <p>\u56e0\u4e3a \u4ea4\u5bf9\u5e76\u6709\u5206\u914d\u7387\uff0c\u6240\u4ee5\u539f\u5f0f $=[W\\cap (S(l)\\cup S(r)]\\cup(S(l)\\cap S(r))$\u3002</p> <p>\u8fd9\u5c31\u975e\u5e38\u597d\u505a\u4e86\uff0c\u5728 $W$ \u5185\u7684 $S(l),S(r)$ \u5e76\u8d77\u6765\uff0c\u5176\u4f59\u7684\u4ea4\u8d77\u6765\uff0c\u6ce8\u610f\u5230\u8fd9\u91cc\u7684\u5e76\u4e5f\u4fdd\u8bc1\u4e24\u4e24\u4e0d\u4ea4\uff0c\u4e0d\u7136\u5b83\u5c31\u662f\u524d\u9762\u7b2c\u4e00\u79cd\u60c5\u51b5\u4e86\u3002</p> <pre><code>void union3(set&lt;pii&gt; &amp;a,set&lt;pii&gt; &amp;b,set&lt;pii&gt; &amp;c){\n//(a&amp;b)|(b&amp;c)|(a&amp;c) = (b&amp;c)|(a&amp;(b|c))\nfor(auto i:a){\nsplit(i.fi,b);split(i.se+1,b);\nsplit(i.fi,c);split(i.se+1,c);\n}\nset&lt;pii&gt;::iterator it=a.begin(),pt=c.begin(),at=a.begin();\nint nw=-1;\nfor(auto i:b){\nif(it-&gt;se&lt;i.fi&amp;&amp;it!=prev(a.end())) ++it;\nint qwer,nnw;\nif(i.fi&gt;=it-&gt;fi&amp;&amp;i.se&lt;=it-&gt;se){\nset&lt;pii&gt;::iterator jt,kt,st;\nc.insert(i);\nqwer=i.fi;nnw=i.se;\n}else{\nint nl=i.fi,nr=i.se;\nset&lt;pii&gt;::iterator jt,kt;\njt=c.upper_bound(mkp(nl,inf));\nif(jt!=c.begin()){\nif(prev(jt)-&gt;fi&lt;nl&amp;&amp;prev(jt)-&gt;se&gt;=nl){\nsplit(nl,c);\n}\n}\nkt=c.upper_bound(mkp(nr,inf));\nif(kt!=c.begin()){\nif(prev(kt)-&gt;se&gt;nr){\nsplit(nr+1,c);\n}\n}\nqwer=nl;nnw=nr;\n}\npt=c.upper_bound(mkp(nw,inf));\nfor(set&lt;pii&gt;::iterator qt=pt;qt!=c.end()&amp;&amp;qt-&gt;se&lt;qwer;){\nif(at-&gt;se&lt;qt-&gt;fi&amp;&amp;at!=prev(a.end())) ++at;\nqt++;\nif(prev(qt)-&gt;se&lt;at-&gt;fi||prev(qt)-&gt;fi&gt;at-&gt;se) c.erase(prev(qt));\n}\nnw=nnw;\n}\npt=c.upper_bound(mkp(nw,inf));\nfor(set&lt;pii&gt;::iterator qt=pt;qt!=c.end();){\nif(at-&gt;se&lt;qt-&gt;fi&amp;&amp;at!=prev(a.end())) ++at;\nqt++;\nif(prev(qt)-&gt;se&lt;at-&gt;fi||prev(qt)-&gt;fi&gt;at-&gt;se) c.erase(prev(qt));\n}\n}\n</code></pre> <p>\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002</p>"},{"location":"solution/20230626B_D/#code","title":"code","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(int i=(s);i&lt;=(e);i++)\n#define fordown(i,s,e) for(int i=(s);i&gt;=(e);i--)\n//#define DEBUG\nusing namespace std;\nusing pii=pair&lt;int,int&gt;;\n#define fi first\n#define se second\n#define mkp make_pair\n#define gc getchar()\ninline int read(){\nint x=0,f=1;char c;\nwhile(!isdigit(c=gc)) if(c=='-') f=-1;\nwhile(isdigit(c)){x=(x&lt;&lt;3)+(x&lt;&lt;1)+(c^48);c=gc;}\nreturn x*f;\n}\n#undef gc\nconst int N=2e5+5,inf=0x3f3f3f3f;\nint n,a[N],b[N],son[N][2],m;\nint dp[N];\nset&lt;pii&gt; w[N];\nint rt[N];\nvoid split(int k,set&lt;pii&gt; &amp;a){\nset&lt;pii&gt;::iterator it=a.upper_bound(mkp(k,inf));\nif(it==a.begin()) return;\n--it;\nif(it-&gt;fi&gt;k||it-&gt;se&lt;k) return;\npii ii=*it;\na.erase(it);\nif(ii.fi&lt;=k-1) a.insert(mkp(ii.fi,k-1));\nif(k&lt;=ii.se)   a.insert(mkp(k,ii.se));\n}\nbool _ad0(set&lt;pii&gt; &amp;a,set&lt;pii&gt; &amp;b,set&lt;pii&gt; &amp;c){\nset&lt;pii&gt;::iterator it=a.begin();\nfor(set&lt;pii&gt;::iterator ii=b.begin();ii!=b.end();){\npii i=*ii;\nif(it==a.end()){break;}\nif(i.se&lt;it-&gt;fi){++ii;continue;}\nif(i.fi&gt;it-&gt;se){++it;continue;}\nint nl=max(i.fi,it-&gt;fi),nr=min(i.se,it-&gt;se);\nset&lt;pii&gt;::iterator jt=c.upper_bound(mkp(nl,inf));\nif(jt!=c.end()){\nif(jt-&gt;fi&lt;=nr){\nreturn true;\n}\n}\nif(jt!=c.begin()){\nif(prev(jt)-&gt;se&gt;=nl){\nreturn true;\n}\n}\nif(i.se&gt;it-&gt;se){\n++it;\n}else{\n++ii;\n}\n}\nreturn false;\n}\nvoid intersect3(set&lt;pii&gt; &amp;a,set&lt;pii&gt; &amp;b,set&lt;pii&gt; &amp;c){\nset&lt;pii&gt;::iterator it=a.begin(),pt;\nint nw=-1;\nfor(set&lt;pii&gt;::iterator ii=b.begin();ii!=b.end();){\npii i=*ii;\nif(it==a.end()){break;}\nif(i.se&lt;it-&gt;fi){++ii;continue;}\nif(i.fi&gt;it-&gt;se){++it;continue;}\nint nl=max(i.fi,it-&gt;fi),nr=min(i.se,it-&gt;se);\nset&lt;pii&gt;::iterator jt,kt;\njt=c.upper_bound(mkp(nl,inf));\nif(jt!=c.begin()){\nif(prev(jt)-&gt;fi&lt;nl&amp;&amp;prev(jt)-&gt;se&gt;=nl){\n//              int jr=prev(jt)-&gt;se;\n//              int jl=prev(jt)-&gt;fi;\n//              c.erase(prev(jt));\nsplit(nl,c);\n//              c.erase(c.lower_bound(mkp(jl,0)));\n}\n}\nkt=c.upper_bound(mkp(nr,inf));\nif(kt!=c.begin()){\nif(prev(kt)-&gt;se&gt;nr){\n//              int kl=prev(kt)-&gt;fi;\n//              c.erase(prev(kt));\nsplit(nr+1,c);\n//              c.erase(c.lower_bound(mkp(nr+1,0)));\n}\n}\npt=c.upper_bound(mkp(nw,inf));\nfor(set&lt;pii&gt;::iterator qt=pt;qt!=c.end()&amp;&amp;qt-&gt;se&lt;nl;){\nqt++;\nc.erase(prev(qt));\n}\nnw=nr;\nif(i.se&gt;it-&gt;se){\n++it;\n}else{\n++ii;\n}\n}\npt=c.upper_bound(mkp(nw,inf));\nfor(set&lt;pii&gt;::iterator qt=pt;qt!=c.end();){\nqt++;\nc.erase(prev(qt));\n}\n}\nbool _ad2(set&lt;pii&gt; &amp;a,set&lt;pii&gt; &amp;b,set&lt;pii&gt; &amp;c){\nfor(auto i:a){\nset&lt;pii&gt;::iterator it=b.lower_bound(mkp(i.fi,0));\nif(it!=b.end()&amp;&amp;it-&gt;fi&lt;=i.se) return false;\nif(it!=b.begin()&amp;&amp;prev(it)-&gt;se&gt;=i.fi) return false;\nit=c.lower_bound(mkp(i.fi,0));\nif(it!=c.end()&amp;&amp;it-&gt;fi&lt;=i.se) return false;\nif(it!=c.begin()&amp;&amp;prev(it)-&gt;se&gt;=i.fi) return false;\n}\nfor(auto i:b){\nset&lt;pii&gt;::iterator it=c.lower_bound(mkp(i.fi,0));\nif(it!=c.end()&amp;&amp;it-&gt;fi&lt;=i.se) return false;\nif(it!=c.begin()&amp;&amp;prev(it)-&gt;se&gt;=i.fi) return false;\n}\nreturn true; }\nvoid union2(set&lt;pii&gt; &amp;a,set&lt;pii&gt; &amp;c){\nfor(auto i:a){\nc.insert(i);\n//      set&lt;pii&gt;::iterator jt,kt,st;\n//      int nl=i.fi,nr=i.se;\n//      jt=c.upper_bound(mkp(i.fi,inf));\n//      if(jt!=c.begin()){\n//          if(prev(jt)-&gt;se&gt;=i.fi){\n//              nl=min(nl,prev(jt)-&gt;fi);\n//              st=prev(jt);\n//          }\n//      }\n//      kt=c.upper_bound(mkp(i.se,inf));\n//      if(kt!=c.begin()){\n//          if(prev(kt)-&gt;fi&lt;=i.se){\n//              nr=max(nr,prev(kt)-&gt;se);\n//          }\n//      }\n//      st=c.lower_bound(mkp(nl,0));\n//      for(set&lt;pii&gt;::iterator lt=st;lt!=c.end()&amp;&amp;lt-&gt;se&lt;=nr;){\n//          ++lt;\n//          c.erase(prev(lt));\n//      }\n//      c.insert(mkp(nl,nr));\n}\n}\nvoid union3(set&lt;pii&gt; &amp;a,set&lt;pii&gt; &amp;b,set&lt;pii&gt; &amp;c){\n//(a&amp;b)|(b&amp;c)|(a&amp;c) = (b&amp;c)|(a&amp;(b|c))\nfor(auto i:a){\nsplit(i.fi,b);split(i.se+1,b);\nsplit(i.fi,c);split(i.se+1,c);\n}\nset&lt;pii&gt;::iterator it=a.begin(),pt=c.begin(),at=a.begin();\nint nw=-1;\nfor(auto i:b){\nif(it-&gt;se&lt;i.fi&amp;&amp;it!=prev(a.end())) ++it;\nint qwer,nnw;\nif(i.fi&gt;=it-&gt;fi&amp;&amp;i.se&lt;=it-&gt;se){\nset&lt;pii&gt;::iterator jt,kt,st;\n//          int nl=i.fi,nr=i.se;\n//          jt=c.upper_bound(mkp(i.fi,inf));\n//          if(jt!=c.begin()){\n//              if(prev(jt)-&gt;se&gt;=i.fi){\n//                  nl=min(nl,prev(jt)-&gt;fi);\n//              }\n//          }\n//          kt=c.upper_bound(mkp(i.se,inf));\n//          if(kt!=c.begin()){\n//              if(prev(kt)-&gt;fi&lt;=i.se){\n//                  nr=max(nr,prev(kt)-&gt;se);\n//              }\n//          }\n//          st=c.lower_bound(mkp(nl,0));\n//          for(set&lt;pii&gt;::iterator lt=st;lt!=c.end()&amp;&amp;lt-&gt;se&lt;=nr;){\n//              ++lt;\n//              c.erase(prev(lt));\n//          }\n//          c.insert(mkp(nl,nr));\nc.insert(i);\nqwer=i.fi;nnw=i.se;\n}else{\nint nl=i.fi,nr=i.se;\nset&lt;pii&gt;::iterator jt,kt;\n//          jt=c.upper_bound(mkp(nl,inf));\n//          if(jt!=c.begin()){\n//              if(prev(jt)-&gt;fi&lt;=nl&amp;&amp;prev(jt)-&gt;se&gt;=nl){\n//                  int jr=min(nr,prev(jt)-&gt;se);\n//                  c.erase(prev(jt));\n//                  c.insert(mkp(nl,jr)).fi;\n//              }\n//          }\n//          kt=c.upper_bound(mkp(nr,inf));\n//          if(kt!=c.begin()){\n//              if(prev(kt)-&gt;fi&lt;=nr&amp;&amp;prev(kt)-&gt;se&gt;=nr){\n//                  int kl=max(prev(kt)-&gt;fi,nl);\n//                  c.erase(prev(kt));\n//                  c.insert(mkp(kl,nr)).fi;\n//              }\n//          }\njt=c.upper_bound(mkp(nl,inf));\nif(jt!=c.begin()){\nif(prev(jt)-&gt;fi&lt;nl&amp;&amp;prev(jt)-&gt;se&gt;=nl){\n//                  int jr=prev(jt)-&gt;se;\n//                  int jl=prev(jt)-&gt;fi;\n//          c.erase(prev(jt));\nsplit(nl,c);\n//                  c.erase(c.lower_bound(mkp(jl,0)));\n}\n}\nkt=c.upper_bound(mkp(nr,inf));\nif(kt!=c.begin()){\nif(prev(kt)-&gt;se&gt;nr){\n//                  int kl=prev(kt)-&gt;fi;\n//          c.erase(prev(kt));\nsplit(nr+1,c);\n//                  c.erase(c.lower_bound(mkp(nr+1,0)));\n}\n}\nqwer=nl;nnw=nr;\n}\npt=c.upper_bound(mkp(nw,inf));\nfor(set&lt;pii&gt;::iterator qt=pt;qt!=c.end()&amp;&amp;qt-&gt;se&lt;qwer;){\nif(at-&gt;se&lt;qt-&gt;fi&amp;&amp;at!=prev(a.end())) ++at;\nqt++;\nif(prev(qt)-&gt;se&lt;at-&gt;fi||prev(qt)-&gt;fi&gt;at-&gt;se) c.erase(prev(qt));\n}\nnw=nnw;\n}\npt=c.upper_bound(mkp(nw,inf));\nfor(set&lt;pii&gt;::iterator qt=pt;qt!=c.end();){\nif(at-&gt;se&lt;qt-&gt;fi&amp;&amp;at!=prev(a.end())) ++at;\nqt++;\nif(prev(qt)-&gt;se&lt;at-&gt;fi||prev(qt)-&gt;fi&gt;at-&gt;se) c.erase(prev(qt));\n}\n}\nvoid dfs(int x){\nif(x==0) return;\nif(son[x][0]) dfs(son[x][0]);\nif(son[x][1]) dfs(son[x][1]);\nif(son[x][0]==0&amp;&amp;son[x][1]==0) return;\nif(son[x][1]==0||son[x][0]==0){\nw[rt[0]].clear();\nw[rt[0]].insert(mkp(0,m-1));\n}\nint l=son[x][0],r=son[x][1];\ndp[x]=dp[l]+dp[r];\n#ifdef DEBUG\nprintf(\"======%d|%d|%d\\n\",x,l,r);\nprintf(\"%d||\",x);\nfor(auto i:w[rt[x]]) printf(\"%d %d|\",i.fi,i.se);\nprintf(\"\\n%d||\",l);\nfor(auto i:w[rt[l]]) printf(\"%d %d|\",i.fi,i.se);\nprintf(\"\\n%d||\",r);\nfor(auto i:w[rt[r]]) printf(\"%d %d|\",i.fi,i.se);\nputs(\"\");\n#endif \nif(w[rt[l]].size()&gt;w[rt[r]].size()){\nswap(rt[l],rt[r]);\n}\n//  if(w[rt[x]].size()&gt;w[rt[l]].size()){\n//      swap(rt[x],rt[l]);\n//  }\nif(_ad0(w[rt[x]],w[rt[l]],w[rt[r]])){\nintersect3(w[rt[x]],w[rt[l]],w[rt[r]]);\n#ifdef DEBUG\nputs(\"0\");\n#endif\n}else if(_ad2(w[rt[x]],w[rt[l]],w[rt[r]])){\ndp[x]+=2;\nunion2(w[rt[x]],w[rt[r]]);\nunion2(w[rt[l]],w[rt[r]]);\n#ifdef DEBUG\nputs(\"2\");\n#endif\n}else{\ndp[x]+=1;\nunion3(w[rt[x]],w[rt[l]],w[rt[r]]);\n#ifdef DEBUG\nputs(\"1\");\n#endif\n}\nswap(rt[x],rt[r]);\n#ifdef DEBUG\nfor(auto i:w[rt[x]]){\nprintf(\" %d %d|\\n\",i.fi,i.se);\n}\n#endif\n}\nsigned main(){\nn=read();m=read();\nforup(i,1,n){\na[i]=read();b[i]=read();son[i][0]=read();son[i][1]=read();\nrt[i]=i;\n}\nforup(i,1,n){\nif(a[i]&gt;b[i]){\nw[rt[i]].insert(mkp(0,m-a[i]-1));\nif(b[i]!=0) w[rt[i]].insert(mkp(m-b[i],m-1));\n}else{\nw[rt[i]].insert(mkp(m-b[i],m-a[i]-1));\n}\n#ifdef DEBUG\nprintf(\"%d||\",i);\nfor(auto j:w[rt[i]]){\nprintf(\"%d %d|\",j.fi,j.se);\n}\nputs(\"\");\n#endif\n}\ndfs(1);\nint ans=dp[1];\nif(w[rt[1]].begin()-&gt;fi&gt;0) ans++;\nprintf(\"%d\\n\",ans);\n}\n</code></pre> <p>\u4ece\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\u6211\u662f\u600e\u4e48\u88ab\u5751\u7684\u3002</p> <p>\u53e6\u5916\u8d34\u4e00\u4e0b\u8d5b\u65f6\u6700\u9ad8\u5206\u4ee3\u7801\u6765\u81ea @\u5143\u795e\u5927\u738b\u4e54\u5b89\u5a1c\u3002</p>"},{"location":"solution/20230626B_D/#_3","title":"%%%%%%%%%%%%%%%%%%%%%%%%%%%%%","text":"<pre><code>//  author:LGM_Joanna_\n#include &lt;bits/stdc++.h&gt;\n#define marry return\n#define int long long\n#define lowbit(x) (x&amp;-x)\ninline int read(){\nint x=0,f=1;\nchar ch=getchar();\nwhile(ch&lt;48||ch&gt;57)f=ch=='-'?-1:1,ch=getchar();\nwhile(ch&gt;=48&amp;&amp;ch&lt;=57)x=x*10+(ch^48),ch=getchar();\nreturn x*f;}\nusing namespace std;\nconst int inf=1e18;\nconst int F=0;\nconst int mod=114514;\nsigned main()\n{\nputs(\"2\");\n/*\n    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446    \u6446\u6446\u6446\u6446    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446    \u6446\u6446    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446              \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446  \u6446                \u6446\u6446\u6446\u6446\u6446\u6446\u6446    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446        \u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446  \u6446\u6446  \u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446  \u6446                  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446    \u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446    \u6446\u6446\u6446        \u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446  \u6446  \u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446    \u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446  \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446      \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446            \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446                \u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446  \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446  \u6446  \u6446\u6446  \u6446  \u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446  \u6446\u6446\u6446\u6446  \u6446\u6446  \u6446  \u6446\u6446\u6446\u6446\u6446        \u6446  \u6446  \u6446\u6446  \u6446  \u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446            \u6446\u6446  \u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446                \u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446  \u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446  \u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446            \u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446              \u6446\u6446  \u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446  \u6446\u6446  \u6446  \u6446\u6446\u6446\u6446\u6446      \u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446  \u6446\u6446  \u6446  \u6446\u6446\u6446\u6446\u6446  \u6446  \u6446\u6446                \u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446  \u6446\u6446\u6446  \u6446\u6446  \u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446  \u6446\u6446  \u6446  \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446  \u6446  \u6446\u6446\u6446\u6446  \u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446  \u6446\u6446\u6446    \u6446\u6446\u6446    \u6446\u6446\u6446\u6446\u6446\u6446    \u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446  \u6446\u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446  \u6446\u6446\u6446\u6446\u6446\u6446\u6446  \u6446\u6446                \u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    \u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\u6446\n    */  marry F;\n}\n</code></pre>"},{"location":"solution/20230630B_C/","title":"20230630B \u613f","text":""},{"location":"solution/20230630B_C/#_1","title":"\u95f2\u626f \u524d\u8a00","text":"<p>\u4e00\u7bc7\u9898\u89e3\u53ef\u80fd\u9700\u8981\u4e00\u5f20\u5934\u56fe\u3002</p> <p></p> <p>\u6240\u4ee5\u8fd9\u7bc7\u9898\u89e3\u8bb2\u7684\u662f @GM_Joanna_ \u7684\u505a\u6cd5\u3002</p> <p>stO  Orz</p> <p>\u53e6\u5916\u6211\u5b8c\u5168\u6ca1\u6709\u8d23\u602a/\u8bcb\u6bc1 @\u10e6\ua9bf\u0fd0 \u7684\u610f\u601d\uff0c\u672c\u7bc7\u9898\u89e3\u4ec5\u4e3a\u5206\u4eab\u505a\u6cd5\uff0c\u51fa\u9898\u4eba\u770b\u5230\u4e86\u8fd8\u8bf7\u6d77\u6db5\u3002</p> <p>\u4f20\u9001\u95e8</p>"},{"location":"solution/20230630B_C/#_2","title":"\u9898\u89e3","text":"<p>\u9996\u5148\u5bb9\u6613\u53d1\u73b0\u8fd9\u4e2a\u95ee\u9898\u5728\u56fe\u4e0a\u505a\u548c\u5728\u8fd9\u5f20\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u4e0a\u505a\u662f\u7b49\u4ef7\u7684\uff0c\u5177\u4f53\u6765\u8bf4\uff0c\u4e24\u4e2a\u70b9\u662f\u5426\u8fde\u901a\u53ea\u548c\u5b83\u4eec\u4e4b\u95f4\u6240\u6709\u8def\u5f84\u4e2d\u6700\u5927\u503c\u6700\u5c0f\u7684\u8def\u5f84\u6709\u5173\uff0c\u8fd9\u662f\u4e00\u4e2a\u74f6\u9888\u8def\u95ee\u9898\uff0c\u6211\u4eec\u8003\u8651\u7528 Kruskal \u7684\u601d\u60f3\u89e3\u51b3\u3002</p> <p>\u6709\u4e00\u4e2a\u8f6c\u5316\uff0c\u6211\u4eec\u53d1\u73b0\u539f\u9898\u91cc\u9762\u7684 $h$ \u662f\u6c34\u4f4d\u9ad8\u4e8e\u6216\u7b49\u4e8e\u8fd9\u4e2a\u503c\u5c31\u5fc5\u987b\u76f8\u540c\uff0c\u8fd9\u975e\u5e38\u4e0d\u597d\u5904\u7406\uff0c\u6211\u4eec\u8003\u8651\u8bbe $H=h-1$ \u8868\u793a\u6c34\u4f4d\u5c0f\u4e8e\u6216\u7b49\u4e8e\u8fd9\u4e2a\u503c\uff0c\u8fd9\u6761\u8fb9\u4e24\u4fa7\u5c31\u662f\u4e24\u4e2a\u72ec\u7acb\u7684\u95ee\u9898\u3002</p> <p>\u8003\u8651\u8dd1 Kruskal \u7684\u8fc7\u7a0b\uff0c\u5bb9\u6613\u53d1\u73b0\u5728\u4efb\u610f\u65f6\u523b\uff0c\u67d0\u4e2a\u96c6\u5408\u5185\u7684\u6c34\u4f4d\u5047\u5982\u9ad8\u4e8e\u5176\u4e2d\u6700\u5c0f\u751f\u6210\u6811\u4e0a\u8fb9\u6743\u6700\u5927\u7684\u8fb9\uff08\u5373 Kruskal \u8fc7\u7a0b\u4e2d\u5bf9\u8fd9\u4e2a\u96c6\u5408\u8fde\u7684\u6700\u540e\u4e00\u6761\u8fb9\uff09\uff0c\u90a3\u4e48\u8fd9\u6574\u4e2a\u96c6\u5408\u5185\u6c34\u4f4d\u5fc5\u5b9a\u76f8\u540c\u3002\u5bb9\u6613\u60f3\u5230\u6309\u8dd1 Kruskal \u7684\u8fc7\u7a0b\u4e3a DP \u7684\u201c\u9636\u6bb5\u201d\u505a DP\u3002</p> <p>\u8bbe $f_{i,j}$ \u8868\u793a Kruskal \u8fdb\u884c\u5230\u7b2c $i$ \u6b65\uff0c\u96c6\u5408 $j$ \u5185\u7684\u65b9\u6848\u6570\uff0c$stg_i$ \u8868\u793a\u96c6\u5408 $i$ \u7684\u6700\u5c0f\u751f\u6210\u6811\u4e0a\u8fb9\u6743\u6700\u5927\u7684\u8fb9\u3002\u8bbe\u8fd9\u4e00\u6b65\u5408\u5e76 $u,v$ \u4e24\u4e2a\u96c6\u5408\u4e3a $w$\uff08\u8fd9\u91cc\u4e0d\u8003\u8651 $u,v$ \u672c\u6765\u5c31\u5728\u4e00\u4e2a\u96c6\u5408\u7684\u60c5\u51b5\uff09\uff0c\u52a0\u7684\u8fd9\u6761\u8fb9\u8fb9\u6743\u4e3a $H$\uff0c\u6613\u5f97 \u80fd\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a</p> <p>$$ \\begin{cases} f_{i,j}=f_{i-1,j} &amp;j\\ne u,v \\\\ f_{i,w}=(f_{i-1,u}+H-stg_{u})\\times (f_{i-1,v}+H-stg_{v}) \\end{cases} $$</p> <p>\u5982\u4f55\u7406\u89e3\u5462\uff1f\u9996\u5148\u7b2c\u4e00\u79cd\u60c5\u51b5\u663e\u7136\uff0c\u56e0\u4e3a\u8fd9\u6761\u8fb9\u4e0d\u4f1a\u5bf9\u4ed6\u4eec\u6709\u5f71\u54cd\u3002</p> <p>\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u9996\u5148\u4e24\u8fb9\u6c34\u4f4d\u5728\u5c0f\u4e8e\u7b49\u4e8e $H$ \u7684\u65f6\u5019\u662f\u72ec\u7acb\u7684\u95ee\u9898\uff0c\u9002\u7528\u4e58\u6cd5\u539f\u7406\u3002\u4e24\u8fb9\u5206\u522b\u7684\u65b9\u6848\u6570\u5c31\u662f\u4e4b\u524d\u7684\u65b9\u6848\u6570\u52a0\u4e0a\u4e24\u4e2a\u96c6\u5408\u6c34\u4f4d\u6574\u4f53\u53d6 $stg_{u}+1\\sim H$ \u7684\u65b9\u6848\uff0c\u52a0\u8d77\u6765\u76f8\u4e58\u5373\u53ef\u3002</p> <p>\u7136\u540e\u663e\u7136 $stg_w=H$\uff0c\u56e0\u4e3a\u524d\u9762\u8fde\u7684\u6240\u6709\u8fb9\u8fb9\u6743\u90fd\u5c0f\u4e8e\u7b49\u4e8e $H$\u3002</p> <p>\u7136\u540e\u8003\u8651\u5982\u4f55\u7edf\u8ba1\u7b54\u6848\uff0c\u5728 DP \u7684\u5408\u5e76\u8fc7\u7a0b\u4e2d\uff0c\u5047\u5982\u7ed3\u70b9 $1$ \u4e0d\u5728 $u,v$ \u4e2d\uff0c\u90a3\u4e48\u8fd9\u91cc\u5c31\u4e0d\u7528\u7ba1\u5b83\uff0c\u7136\u540e\u5047\u5982 $1$ \u5728\u96c6\u5408 $u$ \u91cc\uff0c\u90a3\u4e48\u5b83\u80fd\u53d6\u5230\u7684\u6c34\u4f4d\u5c31\u662f\u4ece $stg_u$ \u5230 $H$ \u7684\u7b49\u5dee\u6570\u5217\uff0c\u7136\u540e\u6839\u636e\u4e58\u6cd5\u539f\u7406\u5728\u8fd9\u4e00\u6b65\u5c31\u4f1a\u6709 $(f_{i,v}+H-stg_v)$ \u79cd\u4e0d\u540c\u7684\u60c5\u51b5\u53d6\u5230\u7b49\u5dee\u6570\u5217\u91cc\u9762\u7684\u6bcf\u4e00\u4f4d\uff0c\u505a\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u6c42\u548c\u5373\u53ef\u3002</p> <p>\u53e6\u5916\u663e\u7136\u8fd9\u4e2a DP \u7684\u7b2c\u4e00\u7ef4\u53ef\u4ee5\u538b\u6389\u3002</p> <p>\u8003\u8651\u6700\u7ec8\u5982\u4f55\u7edf\u8ba1\u7b54\u6848\u3002\u9996\u5148\u6bcf\u4e2a\u96c6\u5408\u53ea\u7edf\u8ba1\u4e86\u6c34\u4f4d\u5728 $0 \\sim stg_i$ \u7684\u60c5\u51b5\uff0c$f_i$ \u518d\u52a0\u4e0a $d-stg_i$ \u5373\u53ef\uff0c\u5bf9\u7b54\u6848\u540c\u7406\u52a0\u4e0a\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u3002\u6ce8\u610f\u5230\u6700\u540e\u6574\u5f20\u56fe\u53ef\u80fd\u4e0d\u8fde\u901a\uff0c\u800c\u6bcf\u4e2a\u8fde\u901a\u5757\u7684\u60c5\u51b5\u662f\u72ec\u7acb\u7684\uff0c\u8fd8\u662f\u7528\u4e58\u6cd5\u539f\u7406\uff0c\u6545\u6700\u7ec8\u7b54\u6848\u4e3a $ans\\times \\prod_{1 \\notin i}f_i$\uff08\u8fd9\u91cc\u7684 $ans,f$ \u5747\u662f\u6700\u7ec8\u5904\u7406\u8fc7\u7684\uff09\u3002</p>"},{"location":"solution/20230630B_C/#code","title":"code","text":"<p>\u7b49\u4e0b\u518d\u52a0\uff0c\u73b0\u5728\u5728\u8f66\u4e0a\u7528\u6211\u5988\u7684 Mac \u5199\uff0c\u8d3c\u96be\u53d7\u3002</p>"},{"location":"solution/about/","title":"\u5173\u4e8e","text":"<p>\u8fd9\u91cc\u4f1a\u653e\u4e00\u4e9b\u6d1b\u8c37\u4e0a\u6ca1\u6709\u7684\u9898\u7684\u9898\u89e3\uff08\u5927\u90e8\u5206\u662f\u6821\u5185\u7684\u6a21\u62df\u8d5b\uff09\u3002AtCoder \u548c CodeForces \u4ee5\u53ca\u6d1b\u8c37\u4e3b\u9898\u5e93\u7684\u9898\u89e3\u53ef\u4ee5\u524d\u5f80\u6211\u7684\u6d1b\u8c37\u535a\u5ba2\u9605\u8bfb\u3002</p> <p>\u7136\u540e\u9898\u53f7\u662f \u65e5\u671f + \u7ec4\u522b + \u9898\u76ee\u540d\u5b57\uff0c\u5982\u679c\u540e\u9762\u6ca1\u8ddf\u9898\u76ee\u540d\u5b57\u8bf4\u660e\u8fd9\u7bc7\u91cc\u9762\u6709\u4e0d\u6b62\u4e00\u9053\u9898\u3002</p>"}]}